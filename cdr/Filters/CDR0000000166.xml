<CdrDoc Type='Filter' Id='CDR0000000166'>
<CdrDocCtl>
<DocValStatus readonly="yes">U</DocValStatus>
<DocActiveStatus readonly="yes">A</DocActiveStatus>
<DocTitle readonly="yes">InScopeProtocol HP QC Report</DocTitle>
<ReadyForReview readonly="yes">N</ReadyForReview>
</CdrDocCtl>
<CdrDocXml><![CDATA[<?xml      version = "1.0"?>
<!--
================================================================
$Id: CDR0000000166.xml,v 1.51 2005-06-10 21:36:47 venglisc Exp $

Create the InScope Protocol Professional QC Report
Written by Cheryl Burg - 4/29/2002
Modified  7/5/2002 to include Inline Markup
Modified  7/22/2002 to include sort for Diagnosis,InterventionName
Modified 5/1/2003 to run with new denormalization filter

$Log: not supported by cvs2svn $
================================================================ -->
<xsl:transform               xmlns:xsl = "http://www.w3.org/1999/XSL/Transform"
                               version = "1.0"
                             xmlns:cdr = "cips.nci.nih.gov/cdr">

 <xsl:output                    method = "html"
                                indent = "no"/>

 <xsl:include  href = "cdr:name:Module: Attribute Sets"/>
 <xsl:include  href = "cdr:name:Module: InScopeProtocol HP Identification"/>
 <xsl:include  href = "cdr:name:Module: InScopeProtocol HP Abstract"/>
 <xsl:include  href = "cdr:name:Module: InScopeProtocol HP Details"/>
 <xsl:include  href = "cdr:name:Module: InScopeProtocol Related Links"/>
 <xsl:include  href = "cdr:name:Module: InScopeProtocol HP Record Information"/>
 <xsl:include  href = "cdr:name:Module: InLine Markup Formatter"/> 
 <xsl:include  href = "cdr:name:Module: Table Formatter"/>
 <xsl:include  href = "cdr:name:Module: STYLE Default"/>  

 <xsl:variable                    name = "docID"
                                select = "document('cdrutil:/docid')"/>
 <xsl:variable                    name = "whoAmI"
                                select = "'ProtHPQc'"/>

 <!--
 =========================================================================
 Main Template
 ========================================================================= -->
 <xsl:template                   match = "/">
  <HTML>
   <HEAD>
    <xsl:variable                 name = "cdrdocs" 
                                select = "document('cdrx:/*/CdrCtl')"/>
    <TITLE>
     <xsl:value-of              select = "concat('CDR', 
                                           number(
                                           substring-after($docID, 'CDR')))"/>
     <xsl:text>: </xsl:text>
     <xsl:value-of              select = "substring-before(
                                           concat($cdrdocs/CdrDocCtl/
                                                  DocTitle, ';'), ';')"/> 
    </TITLE>
    <STYLE type='text/css'>
     <xsl:call-template           name = "defaultStyle"/>  
     <!-- Display the HP report in double-spacing format -->
     p               {line-height: 200%}
     ul              {line-height: 200%}
     ol              {line-height: 200%}

     ul.term         {margin-left: 16 ; padding-left: 0;}
    </STYLE>
   </HEAD>
   <BASEFONT                      FACE = 'Arial, Helvetica, sans-serif' />
    <xsl:apply-templates        select = "InScopeProtocol |
                                          ScientificProtocolInfo"/>
  </HTML>
 </xsl:template>
                    
   
 <!-- 
 ==========================================================================
 Generate the HTML for the Full QC Report
 ========================================================================== -->
 <xsl:template                   match = "InScopeProtocol |
                                          ScientificProtocolInfo">
  <BODY>
   <!-- 
   ====================================================================
   Display Report heading and subheading
   ==================================================================== -->
   <b>
    <font size='4'>
     <center>Health Professional<br />QC Report</center>
    </font>

    <font size='3'>
     <center>
      <xsl:value-of             select = "document('cdrutil:/date/%25B %25#d, %25Y %25#I:%25M%25p')"/>
     </center>
    </font>
   </b>
   <p/>

   <b>
    <font size='4'>
     <xsl:value-of              select = "concat('CDR', 
                                           number(
                                           substring-after($docID, 'CDR')))"/>

    </font>
   </b>
   <br />

   <xsl:apply-templates/>
 
  </BODY>
 </xsl:template>


 <!--
 ===============================================================
 Display Protocol Professional Title
 ================================================================ -->
 <xsl:template                   match = "ProtocolTitle">
  <br />
   <xsl:if                        test = "@Type='Professional'">

    <b>
     <font size='4'>Professional Title</font>
    </b>
    <br />
    <p>
     <xsl:apply-templates/>
    </p>
   </xsl:if>
  </xsl:template>


 <!-- 
 ==============================================================
 Display a note 
 ============================================================== -->
 <xsl:template                   match = "Note">
   <xsl:apply-templates         select = "."
                                mode   = "RS"/>
 </xsl:template> 


 <!-- 
 ================================================================
 Display a GlossaryTermRef-Health Professional
 ================================================================ -->
 <xsl:template                   match = "GlossaryTermRef | LOERef">
  <xsl:apply-templates          select = "."
                                  mode = "HPE"/>
 </xsl:template>


 <!-- 
 ====================================================================
 Do not display EnteredBy or EntryDate
 ==================================================================== -->
 <xsl:template                   match = "Patient/EnteredBy | 
                                          Patient/EntryDate | 
                                          TermPronunciation | GlossaryTerm |
                                          ProtocolAbstract/Patient |
                                          FundingInfo | ProtocolSources | 
                                          ProtocolApproval |
                                          ProtocolSponsors |
                                          ProtocolAdminInfo"/>

</xsl:transform>]]>
</CdrDocXml>
</CdrDoc>