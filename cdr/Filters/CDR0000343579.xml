<CdrDoc Type='Filter' Id='CDR0000343579'>
<CdrDocCtl>
<DocValStatus readonly="yes">U</DocValStatus>
<DocActiveStatus readonly="yes">A</DocActiveStatus>
<DocTitle readonly="yes">Module: InScopeProtocol Administrative Details </DocTitle>
<ReadyForReview readonly="yes">N</ReadyForReview>
</CdrDocCtl>
<CdrDocXml><![CDATA[<?xml version="1.0"?>
<!--Filter written by C.Burg - 3/13/2002 -->

<!-- ================================================================
           Filter to generate a Protocol Administrative QC Report
     ================================================================ -->
  
  <xsl:transform       xmlns:xsl="http://www.w3.org/1999/XSL/Transform"
                         version="1.0"
                       xmlns:cdr="cips.nci.nih.gov/cdr">
   <xsl:output method="html"/>

 

<!-- ===============================================================
                  Display the Protocol Sponsors
     ================================================================ -->
      <xsl:template   match = "ProtocolSponsors">
      <b><font size='4'>Protocol Sponsors</font></b>
       <table width='90%'  cellpadding='0' cellspacing='0'>
        <xsl:for-each   select  = "SponsorName">
        <tr>
        <th align='left' width='40%' valign='top'>
        <xsl:if      test = "not(preceding-sibling::SponsorName)">
        <b><font size='3'>Name
        </font>
        </b>
        </xsl:if>
        </th>
        <td width='60%'>
        <xsl:value-of             select="."/>
        </td>
        </tr>
        </xsl:for-each>
        </table>
        <b><font size='3'>Comment</font></b>
         <br />
        <xsl:value-of              select="Comment"/>
        <xsl:if                    test  = "Comment">
         <br />
        </xsl:if>
        </xsl:template>

 


   <!-- =============================================================
               Display Protocol Special Category
       ============================================================ -->

              <xsl:template   match = "ProtocolSpecialCategory">
              <br />
              <xsl:if test="not(preceding-sibling::ProtocolSpecialCategory)">
              <b>
              <font size='4'>
              <xsl:text>Protocol Special Category</xsl:text>
              </font>
              </b>
              </xsl:if>
               <table width='90%'  cellpadding='0' cellspacing='0'> 
              <tr>
              <th align='left' width='40%' valign='top'>   
              <u>
              <b><font size='3'>Special Category
              </font>
              </b>
              </u>
              </th>
              <td width='60%'>
              <xsl:value-of      select="SpecialCategory"/>
                                                      
              </td>
              </tr>
              </table>
              <b><font size='3'>Comment
              </font></b><br />
              <xsl:value-of      select="Comment"/>
                                            
               <br />
               <br />
              </xsl:template>
  
 
      

<!-- ============================================================
              Display the funding information
     ============================================================ -->
      <xsl:template    match = "FundingInfo">
       <hr />
       <br />
      <b><font size='4'>Funding Information</font></b>
      <xsl:for-each            select="NIHGrantContract">
       <table width='90%'  cellpadding='0' cellspacing='0'>
       <tr>
       <th align='left' width='40%' valign='top'>
       <u>
       <b><font size='3'>NIH Grant Contract Type
       </font>
      </b>
      </u>
      </th>
      <td>
     <xsl:value-of             select="NIHGrantContractType"/>
       </td>
       </tr>
       <tr>
      <th align='left' width='40%' valign='top'>
      <b><font size='3'>Grant Contract Number
         </font>
      </b>
      </th>
      <td width='60%'>
     <xsl:value-of            select="GrantContractNo"/><br />
      </td>
      </tr>
      </table>
       <b><font size='3'>Comment
         </font>
      </b>
      <br />
      <xsl:apply-templates select="Comment"/>
      </xsl:for-each>
      <br />
         
      <u><b><font size='3'>Other Grant Contract Information</font></b></u>
      <br />
      <xsl:for-each   select="OtherGrantContractInfo"> 
     <table width='90%'  cellpadding='0' cellspacing='0'>
      <tr>
      <th align='left' width='40%' valign='top'>
      <b>
      <font size='3'>Grant Contract Number
      </font>
      </b> 
      </th>

     <td width='60%'>
     <xsl:value-of                select="GrantContractNo"/>
                                          
     </td>
     </tr>
     </table>
    <b><font size='3'>Comment</font></b>
     <br />
     <xsl:value-of                select="Comment"/>
     <br />                                      
     </xsl:for-each> 
     </xsl:template>
   

<!-- ================================================================
                   Display the Protocol Source
     ================================================================= -->

         <xsl:template    match = "ProtocolSource">
           <br />
           <b><font size='4'>Protocol Source</font></b>
           <table width='90%'  cellpadding='0' cellspacing='0'>
           <tr>
           <th align='left' width='40%' valign='top'>
           <b><font size='3'>Source
           </font>
           </b>
           </th>
           <td width='60%'>
           <xsl:value-of                  select="SourceName"/><br />
           </td>
          </tr>
           <tr>
           <th align='left' width='40%' valign='top'>
           <b><font size='3'>Date Received
           </font>
           </b>
           </th>
           <td width='60%'>
          <xsl:value-of                select="DateReceived"/>
          </td>
          </tr>
         </table>
         <br />
      </xsl:template>

<!-- ====================================================================
                Display the Protocol Approval Information
     ===================================================================== -->
   
      <xsl:template     match = "ProtocolApproval">
        <b><font size='4'>Protocol Approval</font></b>
        <table width='90%'  cellpadding='0' cellspacing='0'>
         <tr>
         <th align='left' width='40%' valign='top'>
         <b><font size='3'>Review ApprovalType
         </font>
         </b>
         </th>
         <td width='40%'>
         <xsl:value-of            select="ReviewApprovalType"/><br />
         </td>
         </tr>
         <tr>
          <th align='left' width='40%' valign='top'>
          <b><font size='3'>Reimbursement Approval Type
          </font>
          </b>
          </th>
          <td width='60%'>
          <xsl:value-of            select="ReimbursementApprovalType"/>
         </td>
         </tr>
         </table>
         <b>
        <font size='3'>Comment
        </font>
        </b>
        <br />
        <xsl:value-of              select="Comment"/>
        <br />
     </xsl:template>

<!-- ====================================================================
                  Display the Protocol Status Information
     ==================================================================== -->
     
   <xsl:template     match = "CurrentProtocolStatus">
      <br />
      <b><font size='4'>Current Protocol Status</font></b>
      <table width='90%'  cellpadding='0' cellspacing='0'>
      <tr>
      <th align='left' width='40%' valign='top'>
      <b><font size='3'>Status
      </font>
      </b>
      </th>
      <td width='60%'>
      <xsl:value-of                select="."/>
      </td>
      </tr>
      </table>
      <br />
      <br />
      </xsl:template>

<!-- ====================================================================
              Display the Lead Organization Information
     ==================================================================== -->
   <xsl:template                    match = "ProtocolLeadOrg">
    <hr />
    <b>
   <font size='4'>Lead Organization
   </font>
   </b>
   <br />
   <br />
   <table width='90%'  cellpadding='0' cellspacing='0'>
   <tr>
   <th align='left' width='40%' valign='top'>
   <b><font size='3'>Organization Name</font></b>
   </th>
   <td width='60%'>
   <xsl:value-of                    select="LeadOrganizationID/
                                            Organization/
                                            OrganizationNameInformation/
                                            OfficialName/Name"/>
   </td>
   </tr>
   </table>
   <table width='90%'  cellpadding='0' cellspacing='0'>
   <tr>
   <th align='left' width='40%' valign='top'>
   <b><font size='3'>Organization Role</font></b>
   </th>
   <td width='60%'>
   <xsl:value-of             select="LeadOrgRole"/>
   </td>
   </tr>
   </table>
   <table width='90%' cellpadding='0' cellspacing='0'>
   <tr>
   <th align='left' width='40%' valign='top'>
   <b><font size='3'>Protocol ID</font></b>
   </th>
   <td width='60%'>      
   <xsl:value-of               select="LeadOrgProtocolID"/>
   </td>
   </tr>
   </table>
   <table width='90%'  cellpadding='0' cellspacing='0'>
    <tr>
    <th align='left' width='40%' valign='top'>
    <b><font size='3'>Current Protocol Status</font></b>
    </th>
    <td>
    </td>
    </tr>
    </table>
    <table width='90%' cellpadding='0' cellspacing='0'>
    <tr>
    <th align='left' width='4%' valign='top'>
    </th>
    <th align='left' width='36%' valign='top'>
    <b><font size='3'>Status
    </font>
    </b>
    </th>
   <td width='60%'>
    <xsl:value-of                     select="LeadOrgProtocolStatuses/
                                        CurrentOrgStatus/StatusName"/>
    </td>
    </tr>
    </table>
    <table width='90%'  cellpadding='0' cellspacing='0'>     
    <tr>
    <th width='4%' align='left' valign='top'>
    </th>
    <th align='left' width='36%' valign='top'>
    <b><font size='3'>Date</font></b>
    </th>
    <td width='60%'>
    <xsl:value-of                  select="LeadOrgProtocolStatuses/
                                          CurrentOrgStatus/StatusDate"/>
     </td>
     </tr>
     </table>
     <table width='90%'  cellpadding='0' cellspacing='0'>
     <tr>
     <th width='4%' align='left' valign='top'>
     </th>
     <th align='left' width='36%' valign='top'>
     <b><font size='3'>User</font></b>
     </th>
     
     <td width='60%'>
     <xsl:value-of               select="LeadOrgProtocolStatuses/
                                         CurrentOrgStatus/EnteredBy"/>
     </td>
     </tr>
     </table>
     <table width='90%'  cellpadding='0' cellspacing='0'>
     <tr>
     <th width='4%' align='left' valign='top'>
     </th>
     <th align='left' width='36%'>
     <b><font size='3'>Entry Date</font></b>
     </th>
     <td width='60%'>
     <xsl:value-of               select="LeadOrgProtocolStatuses/
                                         CurrentOrgStatus/EntryDate"/>
    </td>
    </tr>
    </table>
    <br />
    <table width='90%'  cellpadding='0' cellspacing='0'>
    <tr>
    <th align='left' width='40%' valign='top'>
    <xsl:if                  test="LeadOrgProtocolStatuses/
                                   PreviousOrgStatus">
    <b><font size='3'>Previous Protocol Status</font></b>
    </xsl:if>
    </th>
    <td>
    <xsl:text> </xsl:text>
    </td>
    </tr>
    </table>
    <xsl:if                    test="LeadOrgProtocolStatuses/
                                     PreviousOrgStatus">
   <xsl:for-each               select= "LeadOrgProtocolStatuses/
                                        PreviousOrgStatus">
      <table width='90%' cellpadding='0' cellspacing='0'>
      <tr>
       <th align='left' width='4%' valign='top'>
       </th>
       <th align='left' width='36%' valign='top'>
       <b><font size='3'>Status
       </font>
       </b>
       </th>
      <td width='60%'>
       <xsl:value-of                     select="StatusName"/>
        </td>
        </tr>
       </table>
       <table width='90%'  cellpadding='0' cellspacing='0'>
       <tr>
       <th align='left' width='4%' valign='top'>
       </th>
       <th align='left' width='36%' valign='top'>
       <b><font size='3'>Date</font></b>
       </th>
       <td width='60%'>
       <xsl:value-of               select="StatusDate"/>
       </td>
       </tr>
       </table>
       <table width='90%'  cellpadding='0' cellspacing='0'>
       <tr>
       <th align='left' width='4%' valign='top'>
       </th>
       <th align='left' width='36%' valign='top'>
       <b><font size='3'>User</font></b>
       </th>
       <td width='60%'>
      <xsl:value-of               select="EnteredBy"/>
       </td>
       </tr>
       </table>
       <table width='90%' cellpadding='0' cellspacing='0'>
       <tr>
        <th align='left' width='4%' valign='top'>
       </th>
       <th align='left' width='36%' valign='top'>
       <b><font size='3'>Entry Date</font></b>
       </th>
       
      <td width='60%'>
      <xsl:value-of               select="EntryDate"/>
       </td>
       </tr>
       </table>
       <br />
      </xsl:for-each>
       
       
      </xsl:if>
      

<!-- ==================================================================
               Display Lead Organization Information
     ================================================================= -->

     <br />
     <u>
     <b><font size='3'>Lead Organization Personnel
        </font>
     </b>
     </u>
     <br />
     <br />
     <xsl:for-each                     select="LeadOrgPersonnel/Person">
     <xsl:variable name="orgref"       select="Person/@cdr:ref"/>
     <xsl:variable name="OrgFrag"      select="substring-after 
                                               ($orgref,'#')"/>
        
        <table width='90%'  cellpadding='0' cellspacing='0'>
         <tr>
         <th align='left' width='40%' valign='top'>
         <u>
        <b><font size='3'>Person
         </font>
        </b>
        </u>
        </th>
        <td width='60%'>
         <xsl:value-of             select="Person/
                                           PersonNameInformation/SurName"/>,
          <xsl:value-of            select="Person/PersonNameInformation/
                                           GivenName"/>&#xa0;
         <xsl:variable name="personref"
                                   select="Person/@cdr:ref"/>
         <xsl:variable name="FragPersonRef" 
                                   select="substring-after($personref,'#')"/>
        <xsl:text>[</xsl:text>
        <xsl:value-of              select="$FragPersonRef"/>
         <xsl:text>]</xsl:text>
         </td>
         </tr>
         </table>
         <xsl:for-each             select="../PersonRole">
         <table width='90%'  cellpadding='0' cellspacing='0'>
         <tr>
         <th align ='left' width='40%'  valign='top'>
         <xsl:if test="not(preceding-sibling::PersonRole)">
         <xsl:text>Role</xsl:text>
        </xsl:if>
        </th>
       <td width='60%'>            
       <xsl:value-of               select="."/>
       </td>
       </tr>
       </table>
       </xsl:for-each>
       <table width='90%'  cellpadding='0' cellspacing='0'>
      <tr>
      <th align='left' width='40%'  valign='top'>
      <xsl:text>Organization Name</xsl:text>
      </th>
           
     <td>
    <xsl:value-of                    select="Person/PersonLocations/
                                             OtherPracticeLocation
                                             [@cdr:id=$OrgFrag]/
                                             OrganizationLocation/
                                             Organization/
                                             OrganizationNameInformation/
                                             OfficialName/Name"/>
     </td>
     </tr>
     </table>
     <table width='90%'  cellpadding='0' cellspacing='0'>
     <tr>
     <th align='left' width='40%'  valign='top'>
      <xsl:text>Contact</xsl:text>
      </th>
      </tr>
     </table>
      <xsl:if               test=    "../ProtocolSpecificContact">
       <xsl:for-each        select = "../ProtocolSpecificContact/
                                          PostalAddress">  
      <xsl:for-each         select = "Street">     
     <table width='90%'  cellpadding='0' cellspacing='0'>
     <tr> 
     <th width='4%' align='left'>
     </th>
     <th align='left' width='36%'>
     <xsl:if test="not(preceding-sibling::Street)">
     <xsl:text>Street</xsl:text>
     </xsl:if>
     </th>
       
     <td width='60%'>
      <xsl:value-of            select="."/>
       </td>
        </tr>
       </table> 
       </xsl:for-each> 
       </xsl:for-each>
       
       <xsl:for-each           select="../ProtocolSpecificContact/
                                      PostalAddress">
                                        
      
      <table width='90%'  cellpadding='0' cellspacing='0'>
       <tr>
       <th width='4%' align='left'  valign='top'>
       </th>
       <th align='left' width='36%'  valign='top'>
       <xsl:text>City</xsl:text>
       </th>
      <td width='60%'>
      <xsl:value-of               select="City"/>
       </td>
       </tr>
       </table>
       <xsl:if                   test = "CitySuffix">
       <table width='90%'  cellpadding='0' cellspacing='0'>                     
       <tr>
       <th width='4%' align='left'  valign='top'>
       </th>
       <th align='left' width='36%'>
       <xsl:text>&#xa0;&#xa0;&#xa0;City Suffix</xsl:text>
       </th>
      <td width='60%'>
      <xsl:value-of        select="CitySuffix"/>
      </td>
      </tr>
      </table>
      </xsl:if>
 
 
    <table width='90%'  cellpadding='0' cellspacing='0'>                       
    <tr>
    <th width='4%' align='left'  valign='top'>
    </th>
   <th align='left' width='36%'  valign='top'>
   <xsl:text>State/Political Unit</xsl:text>
   </th>
   <td width='60%'>
   <xsl:value-of        select="PoliticalSubUnit_State/
                                PoliticalSubUnitFullName"/>
   </td>
   </tr>
   </table>
 
   <table width='90%'  cellpadding='0' cellspacing='0'> 
   <tr>   
   <th width='4%' align='left'  valign='top'>
    </th>
   <th align='left' width='36%'  valign='top'>
   <xsl:text>Country</xsl:text>
   </th>
   <td width='60%'>
   <xsl:value-of        select="Country/
                                CountryFullName"/>
  
  </td>
  </tr>
  </table>
   <table width='90%'  cellpadding='0' cellspacing='0'> 
   <tr>  
   <th width='4%' align='left'  valign='top'>
   </th>
   <th align='left' width='36%'  valign='top'>
   <xsl:text>Zip/Postal Code</xsl:text>
   </th>
   <td width='60%'>
   <xsl:value-of        select="PostalCode_ZIP"/>
        
  </td>
  </tr>
  </table>
  </xsl:for-each>
  </xsl:if>
   
   
     
    <xsl:if                test="Person/PersonLocations/
                                    OtherPracticeLocation 
                                    [@cdr:id=$OrgFrag]">
                                      
  
      
      <xsl:for-each           select="Person/PersonLocations/
                                       OtherPracticeLocation  
                                       [@cdr:id=$OrgFrag]/
                                       SpecificPostalAddress"> 
     <xsl:if                test = "not(../../../../../
                                    ProtocolSpecificContact)">
     <xsl:for-each            select = "Street">  
     <table width='90%'  cellpadding='0' cellspacing='0'>
     <tr> 
     <th width='4%' align='left'>
     </th>
     <th align='left' width='36%'>
     <xsl:if test="not(preceding-sibling::Street)">
     <xsl:text>Street</xsl:text>
     </xsl:if>
     </th>
       
     <td width='60%'>
      <xsl:value-of            select="."/>
       </td>
        </tr>
       </table> 
       </xsl:for-each> 
       </xsl:if>
      </xsl:for-each>
      
      <xsl:for-each           select="Person/PersonLocations/
                                       OtherPracticeLocation  
                                       [@cdr:id=$OrgFrag]/
                                       SpecificPostalAddress">
     <xsl:if                test = "not(../../../../../
                                    ProtocolSpecificContact)">
     
      
      <table width='90%'  cellpadding='0' cellspacing='0'>
       <tr>
       <th width='4%' align='left'  valign='top'>
       </th>
       <th align='left' width='36%'  valign='top'>
       <xsl:text>City</xsl:text>
       </th>
      <td width='60%'>
      <xsl:value-of               select="City"/>
       </td>
       </tr>
       </table>
       <xsl:if                   test = "CitySuffix">
       <table width='90%'  cellpadding='0' cellspacing='0'>                     
       <tr>
       <th width='4%' align='left'  valign='top'>
       </th>
       <th align='left' width='36%'>
       <xsl:text>&#xa0;&#xa0;&#xa0;City Suffix</xsl:text>
       </th>
      <td width='60%'>
      <xsl:value-of        select="CitySuffix"/>
      </td>
      </tr>
      </table>
      </xsl:if>
 
 
    <table width='90%'  cellpadding='0' cellspacing='0'>                       
    <tr>
    <th width='4%' align='left'  valign='top'>
    </th>
   <th align='left' width='36%'  valign='top'>
   <xsl:text>State/Political Unit</xsl:text>
   </th>
   <td width='60%'>
   <xsl:value-of        select="PoliticalSubUnit_State/
                                PoliticalSubUnitFullName"/>
   </td>
   </tr>
   </table>
 
   <table width='90%'  cellpadding='0' cellspacing='0'> 
   <tr>   
   <th width='4%' align='left'  valign='top'>
    </th>
   <th align='left' width='36%'  valign='top'>
   <xsl:text>Country</xsl:text>
   </th>
   <td width='60%'>
   <xsl:value-of        select="Country/
                                CountryFullName"/>
  
  </td>
  </tr>
  </table>
   <table width='90%'  cellpadding='0' cellspacing='0'> 
   <tr>  
   <th width='4%' align='left'  valign='top'>
   </th>
   <th align='left' width='36%'  valign='top'>
   <xsl:text>Zip/Postal Code</xsl:text>
   </th>
   <td width='60%'>
   <xsl:value-of        select="PostalCode_ZIP"/>
        
  </td>
  </tr>
  </table>
  </xsl:if>
   <table width='90%'  cellpadding='0' cellspacing='0'> 
   <tr>     
    <th width='4%' align='left'  valign='top'>
    </th>
    <th align='left' width='36%'  valign='top'>
   
    <xsl:choose>
    <xsl:when     test="../SpecificPhone
                       | ../../../../../ProtocolSpecificContact/Phone">
    <xsl:text>Phone</xsl:text>
   </xsl:when>
   <xsl:when      test="../OrganizationLocation/Organization/
                        OrganizationLocations/
                        OrganizationLocation/Location/Phone">
   <b>
   <i>
   <xsl:text>Phone</xsl:text>
   </i>
   </b>
   </xsl:when>

   <xsl:otherwise>
    <b>
   <xsl:text>Phone</xsl:text>
   </b>
   </xsl:otherwise>
   </xsl:choose>
   </th>
   <td width='60%'>
   <xsl:choose>
   <xsl:when            test ="not(../../../../../ProtocolSpecificContact/
                               Phone)">
   <xsl:choose>
   <xsl:when              test ="../SpecificPhone">
   <xsl:value-of        select="../SpecificPhone"/>
   <xsl:if test="../SpecificPhone/@Public">
   <b>
   <xsl:text>(Public=</xsl:text>
   <xsl:value-of select="../SpecificPhone/@Public"/>
   <xsl:text>)</xsl:text>
   </b>
   </xsl:if>
   </xsl:when>
   <xsl:otherwise>
   
    <xsl:if               test="../OrganizationLocation/
                             Organization/OrganizationLocations/
                             OrganizationLocation/Location/Phone">
    <i>
   <xsl:value-of    select="../OrganizationLocation/
                             Organization/OrganizationLocations/
                             OrganizationLocation/Location/Phone"/>
                                                            
    </i>
    <xsl:if        test="../OrganizationLocation/Organization/
                         OrganizationLocations/
                         OrganizationLocation/Location/Phone/@Public">
    <b>               
    <xsl:text> (Public=</xsl:text>
    <xsl:value-of   select="../OrganizationLocation/Organization/
                            OrganizationLocations/
                            OrganizationLocation/Location/Phone/@Public"/>
    <xsl:text>)</xsl:text>
    </b>
    </xsl:if>
    </xsl:if>
    </xsl:otherwise>
    </xsl:choose>
    
   </xsl:when>
    <xsl:when            test ="../../../../../ProtocolSpecificContact/
                               Phone">
   <xsl:value-of        select="../../../../../ProtocolSpecificContact/
                               Phone"/>
   
   <xsl:if              test="../../../../../ProtocolSpecificContact/
                              Phone/@Public">
  
   <b>
   <xsl:text>(Public=</xsl:text>
   <xsl:value-of select="../../../../../ProtocolSpecificContact/Phone/@Public"/>
   <xsl:text>)</xsl:text>
   </b>
   </xsl:if>
   </xsl:when>
    <!--  <xsl:when         test="../OrganizationLocation/
                             Organization/OrganizationLocations/
                             OrganizationLocation/Location/Phone">
   <i>
   <xsl:value-of    select="../OrganizationLocation/
                             Organization/OrganizationLocations/
                             OrganizationLocation/Location/Phone"/>
                                                            
    </i>
    <xsl:if        test="../OrganizationLocation/Organization/
                         OrganizationLocations/
                         OrganizationLocation/Location/Phone/@Public">
    <b>               
    <xsl:text> (Public=</xsl:text>
    <xsl:value-of   select="../OrganizationLocation/Organization/
                            OrganizationLocations/
                            OrganizationLocation/Location/Phone/@Public"/>
    <xsl:text>)</xsl:text>
    </b>
    </xsl:if>
    </xsl:when>-->
    </xsl:choose>
     </td>
    </tr>
    </table>
    <table width='90%'  cellpadding='0' cellspacing='0'> 
    <tr> 
    <th width='4%' align='left'  valign='top'>
    </th>
    <th align='left' width='36%'  valign='top'>
  
    <xsl:choose>
    <xsl:when          test="../../../../../ProtocolSpecificContact/
                             TollFreePhone | ../SpecificTollFreePhone">
    <b>
    <xsl:text>Toll Free Phone</xsl:text>
    </b>
    </xsl:when>
    <xsl:when          test ="../OrganizationLocation/Organization/
                              OrganizationLocations/
                              OrganizationLocation/Location/TollFreePhone">
    <i>
    <b>
    <xsl:text>Toll Free Phone</xsl:text>
    </b>
    </i>
    </xsl:when>
    <xsl:otherwise>
     <b>
    <xsl:text>Toll Free Phone</xsl:text>
    </b>
    </xsl:otherwise>
    </xsl:choose>
    </th>
   <td width='60%'>
   <xsl:choose>
   <xsl:when            test = "not(../../../../../ProtocolSpecificContact/
                               TollFreePhone)">
   <xsl:choose>
   <xsl:when            test  ="../SpecificTollFreePhone">
   <xsl:value-of        select="../SpecificTollFreePhone"/>
   </xsl:when>
   <xsl:when            test = "../OrganizationLocation/Organization/
                                OrganizationLocations/
                                OrganizationLocation/Location/TollFreePhone">
   <i>
  <xsl:value-of         select="../OrganizationLocation/Organization/
                                OrganizationLocations/
                                OrganizationLocation/Location/TollFreePhone"/>
   </i>
  </xsl:when>
  </xsl:choose>
  </xsl:when>
   
   <xsl:when            test="../../../../../ProtocolSpecificContact/
                               TollFreePhone">
   
   <xsl:value-of        select = "../../../../../ProtocolSpecificContact/
                               TollFreePhone"/>
   </xsl:when>
   </xsl:choose>
   </td>
   </tr>
   </table>
  
   <table width='90%'  cellpadding='0' cellspacing='0'> 
   <tr>
  <th width='4%' align='left'  valign='top'>
   </th>
  <th align='left' width='36%'  valign='top'>
   <xsl:choose>
   <xsl:when       test="../SpecificFax | 
                         ../../../../../ProtocolSpecificContact/Fax">
    <b>
    <xsl:text>Fax</xsl:text>
    </b>
    </xsl:when>
    <xsl:when       test="../OrganizationLocation/Organization/
                          OrganizationLocations/
                         OrganizationLocation/Location/Fax">
    <i>
    <b>
    <xsl:text>Fax</xsl:text>
    </b>
    </i>
    </xsl:when>
   
   <xsl:otherwise>
   <xsl:text>Fax</xsl:text>
   </xsl:otherwise>
   </xsl:choose> 
   </th>
   <td width='60%'>
   <xsl:choose>
   <xsl:when            test = "not(
                                ../../../../../ProtocolSpecificContact/Fax)">
   <xsl:choose>
   <xsl:when              test="../SpecificFax">
 
   <xsl:value-of       select="../SpecificFax"/>
   </xsl:when>
   <xsl:otherwise>
   <xsl:if             test="../OrganizationLocation/Organization/
                               OrganizationLocations/
                               OrganizationLocation/Location/Fax">
    <i>
   <xsl:value-of        select="../OrganizationLocation/Organization/
                               OrganizationLocations/
                               OrganizationLocation/Location/Fax"/>

                        
   </i>
   </xsl:if>
   </xsl:otherwise>
   </xsl:choose>
   </xsl:when>
   <xsl:when           test="../../../../../ProtocolSpecificContact/Fax">
   <xsl:value-of       select = "../../../../../ProtocolSpecificContact/
                               Fax"/>
                             
   </xsl:when>
   <!--<xsl:when           test="../OrganizationLocation/Organization/
                               OrganizationLocations/
                               OrganizationLocation/Location/Fax>

   <i>
   <xsl:value-of        select="../OrganizationLocation/Organization/
                               OrganizationLocations/
                               OrganizationLocation/Location/Fax"/>

                        
   </i>
   </xsl:when>-->
   </xsl:choose>
   </td>
   </tr>
   </table>
   <table width='90%'  cellpadding='0' cellspacing='0'> 
   <tr>  
    <th width= '4%' align='left' valign='top'>
    </th>
   <th align= 'left' width='36%'  valign='top'>
   <xsl:text>Email</xsl:text>
   </th>
   <td width='60%'>
   <xsl:choose>
   <xsl:when            test = "../../../../../ProtocolSpecificContact/
                               Email">
   <xsl:element name="a">
   <xsl:attribute name="href">

    <xsl:value-of        select="concat('mailto:',
                                 ../../../../../ProtocolSpecificContact/
                                 Email)"/>
   </xsl:attribute>
   
   <xsl:value-of        select="../../../../../ProtocolSpecificContact/
                                 Email"/>
   </xsl:element>
   <xsl:if              test= "../../../../../ProtocolSpecificContact/
                               Email/@Public">
    <b>
   <xsl:text>&#xa0;&#xa0;(Public=</xsl:text>
   <xsl:value-of       select="../../../../../ProtocolSpecificContact/
                               Email/@Public"/>
   <xsl:text>)</xsl:text>
   </b>
   </xsl:if>
   </xsl:when>
   <xsl:otherwise>
   <xsl:element name="a">
   <xsl:attribute name="href">
   <xsl:value-of        select="concat('mailto:',../SpecificEmail)"/>
   </xsl:attribute>
   <xsl:value-of        select="../SpecificEmail"/>
   </xsl:element>
   <xsl:if              test="../SpecificEmail/@Public">
    <b>
   <xsl:text>&#xa0;&#xa0;(Public=</xsl:text>
   <xsl:value-of        select="../SpecificEmail/@Public"/>
   <xsl:text>)</xsl:text>
   </b>
   </xsl:if>
  </xsl:otherwise>
   </xsl:choose>
   </td>
   </tr>
   </table> 
   <table width='90%' cellpadding='0' cellspacing='0'> 
    <tr>  
    <th width='4%' align='left'  valign='top'>
    </th>
   <th align='left' width='36%'  valign='top' >
   <b><font size='3'>Web Site</font></b>
   </th>
   <td width='60%'>
   <xsl:choose>
   <xsl:when           test ="not(../../../../../
                              ProtocolSpecificContact/WebSite)">
                                 
  
   <xsl:element name="a">
   <xsl:attribute name="href">
   <xsl:choose>
   <xsl:when            test="contains(../SpecificWebSite/@cdr:xref,'http')">
   <xsl:value-of        select="../SpecificWebSite/@cdr:xref"/>
   </xsl:when>
   <xsl:otherwise>
   <xsl:value-of        select="concat('http://',../SpecificWebSite/
                                @cdr:xref)"/>
   
  </xsl:otherwise>
   </xsl:choose>
   </xsl:attribute>
   <xsl:attribute  name="target">
   <xsl:text>new</xsl:text>
   </xsl:attribute>
   <xsl:value-of       select="../SpecificWebsite/@cdr:xref"/>
   </xsl:element>
    <br />
   <xsl:value-of       select="../SpecificWebsite"/>
   </xsl:when>
    <xsl:when           test ="../../../../../ProtocolSpecificContact/
                                 WebSite">
  
   <xsl:element name="a">
   <xsl:attribute name="href">
   <xsl:choose>
   <xsl:when            test="contains(../../../../../ProtocolSpecificContact/
                              WebSite/@cdr:xref,'http')">
                             
   <xsl:value-of        select="../../../../../ProtocolSpecificContact/
                                WebSite/@cdr:xref"/>
   </xsl:when>
   <xsl:otherwise>
   <xsl:value-of        select="concat('http://',../../../../../
                                ProtocolSpecificContact/WebSite/
                                @cdr:xref)"/>
   
  </xsl:otherwise>
   </xsl:choose>
   </xsl:attribute>
   <xsl:attribute  name="target">
   <xsl:text>new</xsl:text>
   </xsl:attribute>
     
   <xsl:value-of       select="../../../../../
                               ProtocolSpecificContact/WebSite/@cdr:xref"/>
   </xsl:element>
    <br />
   <xsl:value-of       select="../../../../../ProtocolSpecificContact/
                              WebSite"/>
   </xsl:when>

    
   <xsl:otherwise>
   <xsl:if             test="../OrganizationLocation/Organization/
                         OrganizationLocations/OrganizationLocation/Location/
                         WebSite">
   <xsl:element name="a">
   <xsl:attribute name="href">
   <xsl:choose>
   <xsl:when          test="contains(../OrganizationLocation/Organization/
                         OrganizationLocations/OrganizationLocation/Location/
                         WebSite/@cdr:xref,'http')">
   <xsl:value-of     select="../OrganizationLocation/Organization/
                           OrganizationLocations/
                           OrganizationLocation/Location/WebSite/@cdr:xref"/>
    </xsl:when>  
     
    <xsl:otherwise>
   <xsl:value-of     select="concat('http://',../OrganizationLocation/
                            Organization/
                            OrganizationLocations/
                            OrganizationLocation/Location/WebSite/
                            @cdr:xref)"/>
    </xsl:otherwise>
    </xsl:choose>
    </xsl:attribute>
    <xsl:attribute  name="target">
    <xsl:text>new</xsl:text>
    </xsl:attribute>
   
    <i>
    <xsl:value-of     select="../OrganizationLocation/Organization/
                              OrganizationLocations/
                              OrganizationLocation/Location/WebSite/
                              @cdr:xref"/>
    </i>
   </xsl:element>
   
   
   <br />
   <i>
   <xsl:value-of     select="../OrganizationLocation/Organization/
                              OrganizationLocations/
                              OrganizationLocation/Location/WebSite"/>
   </i> 
   
   </xsl:if>
   </xsl:otherwise>
   </xsl:choose>
   </td>
   </tr>
   </table>
   <br />
   <br />
  </xsl:for-each>
 </xsl:if>

    
  <xsl:if             test="not(Person/PersonLocations/
                            OtherPracticeLocation[@cdr:id=$OrgFrag]/
                            SpecificPostalAddress)">
                         
                            
                         
   <table width='90%' cellpadding='0' cellspacing='0'>                       
   <xsl:for-each       select="Person/PersonLocations/
                              OtherPracticeLocation[@cdr:id=$OrgFrag]     
                              /OrganizationLocation/
                              Organization/OrganizationLocations/
                              OrganizationLocation/Location/
                              PostalAddress/Street">
    <xsl:if            test = "not(../../../../../../../../../../../ProtocolSpecificContact/PostalAddress)">
     <xsl:variable name="OrgRef"  select="../../../../../@cdr:ref"/>
    <xsl:variable   name="OrgID"  select="substring-after($OrgRef,'#')"/>
    <xsl:if        test = "$OrgFrag =../../@cdr:id or $OrgID = ../../@cdr:id">
  

   <tr>
    <th width='4%' align='left'  valign='top'>
    </th>
    <th align ='left' width='36%'  valign='top'>
      <xsl:if test="not(preceding-sibling::Street)">
      <i>
      <xsl:text>Street</xsl:text>
      </i>
      </xsl:if>
      </th>
     <td width='60%'>
  <i>
 <xsl:value-of        select="."/>
  </i>
  </td>
  </tr>
  </xsl:if>
  </xsl:if> 
  </xsl:for-each>
  </table>
  <xsl:if            test= "../ProtocolSpecificContact/PostalAddress">
 <!-- <table  width='90%' cellpadding='0' cellspacing='0'>
  <xsl:for-each      select="../ProtocolSpecificContact/PostalAddress/
                             Street">
    <tr>
    <th width='4%' align='left'  valign='top'>
    </th>
    <th align ='left' width='36%'  valign='top'>
      <xsl:if test="not(preceding-sibling::Street)">
      <xsl:text>Street</xsl:text>
      </xsl:if>
      </th>
     <td width='60%'>
    <xsl:value-of        select="."/>
   </td>
   </tr>
   </xsl:for-each>
   </table>-->
   <xsl:for-each        select ="../ProtocolSpecificContact/PostalAddress">
  <!-- <table width='90%'  cellpadding='0' cellspacing='0'>   
   <tr>
    <th width='4%' align='left'  valign='top'>
    </th>
    <th align='left' width='36%'  valign='top'>
   <xsl:text>City</xsl:text>
   </th>
   <td width='60%'>
   <xsl:value-of        select="City"/>
  </td>
  </tr>
  </table>
 
 
   <xsl:if            test="CitySuffix">
   <table width='90%'  cellpadding='0' cellspacing='0'>                       
   <tr>
    <th width='4%' align='left'  valign='top'>
    </th>
   <th align='left' width='36%'  valign='top'>
   <xsl:text>City Suffix</xsl:text>
   </th>
   <td width='60%'>
   <xsl:value-of        select="CitySuffix"/>
  </td>
  </tr>
  </table>
  </xsl:if>
 
 
  <table width='90%'  cellpadding='0' cellspacing='0'>                       
    <tr>
    <th width='4%' align='left'  valign='top'>
    </th>
   <th align='left' width='36%'  valign='top'>
   <xsl:text>State/Political Unit</xsl:text>
   </th>
   <td width='60%'>
    <xsl:value-of        select="PoliticalSubUnit_State/
                                PoliticalSubUnitFullName"/>
    </td>
  </tr>
  </table>
 
   <table width='90%'  cellpadding='0' cellspacing='0'> 
   <tr>  
    <th width='4%' align='left'  valign='top'>
    </th>
    <th align='left' width='36%'  valign='top'>
   <xsl:text>Country</xsl:text>
   </th>
   <td width='60%'>
   <xsl:value-of        select="Country/
                                CountryFullName"/>
  </td>
  </tr>
  </table>
   <table width='90%'  cellpadding='0' cellspacing='0'> 
   <tr> 
    <th width='4%' align='left'  valign='top'>
    </th>
   <th align='left' width='36%'  valign='top'>
   <xsl:text>Zip/Postal Code</xsl:text>
   </th>
   <td width='60%'>
    <xsl:value-of        select="PostalCode_ZIP"/>
      
  </td>
  </tr>
  </table> stopped here -->
  
   <table width='90%'  cellpadding='0' cellspacing='0'> 
   <tr>   
    <th width='4%' align='left'  valign='top'>
    </th>
    <th align='left' width='36%'  valign='top'>
    <xsl:choose>
    <xsl:when   test="../Phone | ../../Person/Person/PersonLocations/
                     OtherPracticeLocation[@cdr:id=$OrgFrag]/
                     Phone">
   <b>
   <xsl:text>Phone</xsl:text>
   </b>
   </xsl:when>
   <xsl:otherwise>
   <i>
   <b>
   <xsl:text>Phone</xsl:text>
   </b>
   </i>
   </xsl:otherwise>
   </xsl:choose>
   </th>
   <td width='60%'>
   <xsl:choose>
   <xsl:when      test="../Phone"> 
   <xsl:value-of  select="../Phone"/>
   <xsl:if test="../Phone/@Public">
              
    <b>
    <xsl:text>  (Public=</xsl:text>
    <xsl:value-of select="../Phone/@Public"/>
    <xsl:text>)</xsl:text>
    </b>
    </xsl:if>
    </xsl:when>
     <xsl:when         test="../../Person/Person/PersonLocations/
                             OtherPracticeLocation[@cdr:id=$OrgFrag]/
                             SpecificPhone">
     <xsl:value-of     select="../../Person/Person/PersonLocations/
                              OtherPracticeLocation[@cdr:id=$OrgFrag]/
                              SpecificPhone"/>
     <xsl:if           test="../../Person/Person/PersonLocations/
                             OtherPracticeLocation[@cdr:id=$OrgFrag]/
                             SpecificPhone/@Public">
    <b>
    <xsl:text>  (Public=</xsl:text>
    <xsl:value-of     select="../../Person/Person/PersonLocations/
                             OtherPracticeLocation[@cdr:id=$OrgFrag]/
                             SpecificPhone/@Public"/>
    <xsl:text>)</xsl:text>
    </b>
    </xsl:if>
    </xsl:when>
     <xsl:otherwise>
      <i>
     <xsl:value-of    select="../../Person/Person/PersonLocations/
                             OtherPracticeLocation[@cdr:id=$OrgFrag]/     
                             OrganizationLocation/
                             Organization/OrganizationLocations/
                             OrganizationLocation/Location/Phone"/>
    </i>
      <xsl:if           test="../../Person/Person/PersonLocations/
                             OtherPracticeLocation[@cdr:id=$OrgFrag]/     
                             OrganizationLocation/
                             Organization/OrganizationLocations/
                             OrganizationLocation/Location/Phone/@Public">
    <b>
    <xsl:text>  (Public=</xsl:text>
    <xsl:value-of     select="../../Person/Person/PersonLocations/
                             OtherPracticeLocation[@cdr:id=$OrgFrag]/     
                             OrganizationLocation/
                             Organization/OrganizationLocations/
                             OrganizationLocation/Location/Phone"/>
    <xsl:text>)</xsl:text>
    </b>
    </xsl:if>
    </xsl:otherwise>
    </xsl:choose>
    </td>
    </tr>
    </table>
    <table width='90%'  cellpadding='0' cellspacing='0'> 
   <tr>   
    <th width='4%' align='left'  valign='top'>
    </th>
    <th align='left' width='36%'  valign='top'>
    <xsl:choose>
    <xsl:when   test="../Fax | ../../Person/Person/PersonLocations/
                          OtherPracticeLocation[@cdr:id=$OrgFrag]/
                          SpecificFax">
   <b>
   <xsl:text>Fax</xsl:text>
   </b>
   </xsl:when>
   <xsl:otherwise>
   <i>
   <b>
   <xsl:text>Fax</xsl:text>
   </b>
   </i>
   </xsl:otherwise>
   </xsl:choose>
   </th>
    <td width='60%'>
    <xsl:choose>
    <xsl:when        test="../Fax">
    <xsl:value-of   select="../Fax"/>
    </xsl:when>
    <xsl:when        test="../../Person/Person/PersonLocations/
                          OtherPracticeLocation[@cdr:id=$OrgFrag]/
                          SpecificFax">
   <xsl:value-of     select="../../Person/Person/PersonLocations/
                          OtherPracticeLocation[@cdr:id=$OrgFrag]/
                          SpecificFax"/>
   </xsl:when>
   <xsl:otherwise>
    <i>
    <xsl:value-of    select="../../Person/Person/PersonLocations/
                             OtherPracticeLocation[@cdr:id=$OrgFrag]/     
                             OrganizationLocation/
                             Organization/OrganizationLocations/
                             OrganizationLocation/Location/Fax"/>
  </i>
  </xsl:otherwise>
  </xsl:choose>
  </td>
  </tr>
  </table>
    <table width='90%'  cellpadding='0' cellspacing='0'> 
    <tr>   
    <th width='4%' align='left'  valign='top'>
    </th>
    <th align='left' width='36%'  valign='top'>
    <xsl:choose>
    <xsl:when   test="../TollFreePhone | ../../Person/Person/PersonLocations/
                          OtherPracticeLocation[@cdr:id=$OrgFrag]/
                          SpecificTollFreePhone">
    <b>
    <xsl:text>Toll Free Phone</xsl:text>
    </b>
    </xsl:when>
    <xsl:otherwise>
    <b>
    <i>
    <xsl:text>Toll Free Phone</xsl:text>
    </i>
    </b>
    </xsl:otherwise>
    </xsl:choose>
    </th>
    <td width='60%'>
    <xsl:choose>
    <xsl:when         test="../TollFreePhone"> 
   <xsl:value-of      select="../TollFreePhone"/>
   </xsl:when>
   <xsl:when          test="../../Person/Person/PersonLocations/
                          OtherPracticeLocation[@cdr:id=$OrgFrag]/
                          SpecificTollFreePhone">
   <xsl:value-of      select="../../Person/Person/PersonLocations/
                          OtherPracticeLocation[@cdr:id=$OrgFrag]/
                          SpecificTollFreePhone"/>
   </xsl:when>
   <xsl:otherwise>
   <xsl:value-of     select="../../Person/Person/PersonLocations/
                             OtherPracticeLocation[@cdr:id=$OrgFrag]/     
                             OrganizationLocation/
                             Organization/OrganizationLocations/
                             OrganizationLocation/Location/
                             TollFreePhone"/>
  </xsl:otherwise>
  </xsl:choose>
  </td>
  </tr>
  </table>
   <xsl:if       test ="../Email">  
                        
    <table width='90%'  cellpadding='0' cellspacing='0'> 
   <tr>   
    <th width='4%' align='left'  valign='top'>
    </th>
    <th align='left' width='36%'  valign='top'>
   <xsl:text>Email</xsl:text>
   </th>
    <td width='60%'>
   <xsl:element name="a">
   <xsl:attribute name="href">
   
   <xsl:value-of  select="concat('mailto:',../Email)"/>
   </xsl:attribute>
   <xsl:value-of  select="../Email"/>
    </xsl:element>
    <xsl:if test="../Email/@Public">
       
    <b>
    <xsl:text>  (Public=</xsl:text>
    <xsl:value-of select="../Email/@Public"/>
    <xsl:text>)</xsl:text>
    </b>
    </xsl:if>
    </td>
    </tr>
    </table>
    </xsl:if>

   <!-- i am here -->
    <xsl:if     test="../../Person/Person/PersonLocations/
                          OtherPracticeLocation[@cdr:id=$OrgFrag]/
                          SpecificEmail and not(../Email)">
    <table width='90%' cellpadding='0' cellspacing='0'>
     <tr>   
    <th width='4%' align='left'  valign='top'>
    </th>
    <th align='left' width='36%'  valign='top'>
   <xsl:text>Email</xsl:text>
   </th>
    <td width='60%'>
    <xsl:element name="a">
   <xsl:attribute name="href">
   
   <xsl:value-of  select="concat('mailto:',../../Person/Person/PersonLocations/
                          OtherPracticeLocation[@cdr:id=$OrgFrag]/
                          SpecificEmail)"/>
   </xsl:attribute>
   <xsl:value-of  select="../../Person/Person/PersonLocations/
                          OtherPracticeLocation[@cdr:id=$OrgFrag]/
                          SpecificEmail"/>
    </xsl:element> 
    <xsl:if        test="../../Person/Person/PersonLocations/
                          OtherPracticeLocation[@cdr:id=$OrgFrag]/
                          SpecificEmail/@Public">       
    <b>
    <xsl:text>  (Public=</xsl:text>
    <xsl:value-of select="../../Person/Person/PersonLocations/
                          OtherPracticeLocation[@cdr:id=$OrgFrag]/
                          SpecificEmail/@Public"/>
    <xsl:text>)</xsl:text>
    </b>
    </xsl:if>
    </td>
    </tr>
    </table>

   </xsl:if>
   
   <table width='90%'  cellpadding='0' cellspacing='0'> 
   <tr>   
    <th width='4%' align='left' valign='top'>
   </th>
   <th  width='36%' align='left' valign='top'>
   <xsl:choose>
   <xsl:when         test="../WebSite | ../../Person/Person/PersonLocations/
                          OtherPracticeLocation[@cdr:id=$OrgFrag]/
                          SpecificWebSite">
   <b>
   <xsl:text>Web Site</xsl:text>
   </b>
   </xsl:when>
   <xsl:otherwise>
    <b>
    <i>
    <xsl:text>Web Site</xsl:text>
    </i>
    </b>
    </xsl:otherwise>
    </xsl:choose>
   </th>
   <td width='60%'>
    <xsl:choose>
    <xsl:when       test ="../WebSite">
    <xsl:element name="a">
    <xsl:attribute name="href">
     <xsl:choose>
     <xsl:when      test="contains(../WebSite/
                          @cdr:xref,'http')">
                          
    <xsl:value-of   select="../WebSite/@cdr:xref"/>
    </xsl:when>
    <xsl:otherwise>
    <xsl:value-of   select="concat('http://',../WebSite/@cdr:ref)"/>
      
    </xsl:otherwise>
    </xsl:choose>
    </xsl:attribute>
    <xsl:attribute  name="target">
    <xsl:text>new</xsl:text>
    </xsl:attribute>
   
    <xsl:value-of   select="../WebSite/@cdr:xref"/>
    </xsl:element>
    <br />
    <xsl:value-of   select ="../WebSite"/>
    
    </xsl:when>
    <xsl:when       test ="../../Person/Person/PersonLocations/
                          OtherPracticeLocation[@cdr:id=$OrgFrag]/
                          SpecificWebSite">
    <xsl:element name="a">
    <xsl:attribute name="href">
     <xsl:choose>
     <xsl:when      test="contains(../../Person/Person/PersonLocations/
                          OtherPracticeLocation[@cdr:id=$OrgFrag]/
                          SpecificWebSite/@cdr:xref,'http')">
                          
                          
    <xsl:value-of   select="../../Person/Person/PersonLocations/
                            OtherPracticeLocation[@cdr:id=$OrgFrag]/
                            SpecificWebSite/@cdr:xref"/>
    </xsl:when>
    <xsl:otherwise>
    <xsl:value-of   select="concat('http://',../../Person/
                           Person/PersonLocations/
                           OtherPracticeLocation[@cdr:id=$OrgFrag]/
                           SpecificWebSite/@cdr:ref)"/>
                            
    </xsl:otherwise>
    </xsl:choose>
    </xsl:attribute>
    <xsl:attribute  name="target">
    <xsl:text>new</xsl:text>
    </xsl:attribute>
   
    <xsl:value-of   select="../../Person/Person/PersonLocations/
                           OtherPracticeLocation[@cdr:id=$OrgFrag]/
                           SpecificWebSite/@cdr:xref"/>
    </xsl:element>
    <br />
    <xsl:value-of   select ="../../Person/Person/PersonLocations/
                          OtherPracticeLocation[@cdr:id=$OrgFrag]/
                          SpecificWebSite"/>
    
    </xsl:when>
    <xsl:otherwise>
    <xsl:element name="a">
    <xsl:attribute name="href">
     <xsl:choose>
     <xsl:when      test="contains(../../Person/Person/PersonLocations/
                          OtherPracticeLocation[@cdr:id=$OrgFrag]/     
                          OrganizationLocation/
                          Organization/OrganizationLocations/
                          OrganizationLocation/Location/
                          WebSite/@cdr:xref,'http')">
                         
                          
    <xsl:value-of   select="../../Person/Person/PersonLocations/
                             OtherPracticeLocation[@cdr:id=$OrgFrag]/     
                             OrganizationLocation/
                             Organization/OrganizationLocations/
                             OrganizationLocation/Location/
                             WebSite/@cdr:xref"/>
    </xsl:when>
    <xsl:otherwise>
    <xsl:value-of   select="concat('http://',../../Person/
                            Person/PersonLocations/
                             OtherPracticeLocation[@cdr:id=$OrgFrag]/     
                             OrganizationLocation/
                             Organization/OrganizationLocations/
                             OrganizationLocation/Location/
                             WebSite/@cdr:xref)"/>
                            
    </xsl:otherwise>
    </xsl:choose>
    </xsl:attribute>
    <xsl:attribute  name="target">
    <xsl:text>new</xsl:text>
    </xsl:attribute>
   
    <xsl:value-of   select="../../Person/Person/PersonLocations/
                             OtherPracticeLocation[@cdr:id=$OrgFrag]/     
                             OrganizationLocation/
                             Organization/OrganizationLocations/
                             OrganizationLocation/Location/
                             WebSite/@cdr:xref"/>
    </xsl:element>
    <br />
    <xsl:value-of   select= "../../Person/Person/PersonLocations/
                             OtherPracticeLocation[@cdr:id=$OrgFrag]/     
                             OrganizationLocation/
                             Organization/OrganizationLocations/
                             OrganizationLocation/Location/
                             WebSite"/>
    
    </xsl:otherwise>
    </xsl:choose>
    </td>
    </tr>
    </table>
   </xsl:for-each>
   </xsl:if>
   
     
   
 
                     
   <xsl:for-each       select="Person/PersonLocations/
                              OtherPracticeLocation[@cdr:id=$OrgFrag]     
                              /OrganizationLocation/
                              Organization/OrganizationLocations/
                              OrganizationLocation/Location/
                              PostalAddress">
   <xsl:if            test = "not(../../../../../../../../../../
                             ProtocolSpecificContact/PostalAddress)">
                                
   <xsl:variable name="OrgRef"  select="../../../../@cdr:ref"/>
   <xsl:variable   name="OrgID"  select="substring-after($OrgRef,'#')"/>
   <xsl:if        test = "$OrgFrag =../@cdr:id or $OrgID = ../@cdr:id">
                 

   <table width='90%'  cellpadding='0' cellspacing='0'>   
   <tr>
    <th width='4%' align='left'  valign='top'>
    </th>
   <th align='left' width='36%'  valign='top'>
   <i><xsl:text>City</xsl:text></i>
   </th>
   <td width='60%'>
  <i>
 <xsl:value-of        select="City"/>
  </i>
  </td>
  </tr>
  </table>
 
 
   <xsl:if            test="CitySuffix">
   <table width='90%'  cellpadding='0' cellspacing='0'>                       
   <tr>
    <th width='4%' align='left'  valign='top'>
    </th>
   <th align='left' width='36%'  valign='top'>
   <i><xsl:text>City Suffix</xsl:text></i>
   </th>
   <td width='60%'>
   <i>
  <xsl:value-of        select="CitySuffix"/>
  </i>
  </td>
  </tr>
  </table>
  </xsl:if>
 
 
  <table width='90%'  cellpadding='0' cellspacing='0'>                       
    <tr>
    <th width='4%' align='left'  valign='top'>
    </th>
   <th align='left' width='36%'  valign='top'>
   <i><xsl:text>State/Political Unit</xsl:text></i>
   </th>
   <td width='60%'>
   <i>
   <xsl:value-of        select="PoliticalSubUnit_State/
                                PoliticalSubUnitFullName"/>
  </i>
  </td>
  </tr>
  </table>
 
   <table width='90%'  cellpadding='0' cellspacing='0'> 
   <tr>  
    <th width='4%' align='left'  valign='top'>
    </th>
    <th align='left' width='36%'  valign='top'>
   <i><xsl:text>Country</xsl:text></i>
   </th>
   <td width='60%'>
   <i>
   <xsl:value-of        select="Country/
                                CountryFullName"/>
   </i>
   </td>
  </tr>
  </table>
   <table width='90%'  cellpadding='0' cellspacing='0'> 
   <tr> 
    <th width='4%' align='left'  valign='top'>
    </th>
   <th align='left' width='36%'  valign='top'>
    <i>
   <xsl:text>Zip/Postal Code</xsl:text>
   </i>
   </th>
   <td width='60%'>
    <i>
   <xsl:value-of        select="PostalCode_ZIP"/>
    </i>    
  </td>
  </tr>
  </table>
  
  </xsl:if> 
    
  <xsl:if              test="not(../../../../../../../../../../ProtocolSpecificContact/Phone)">
   <table width='90%'  cellpadding='0' cellspacing='0'> 
   <tr>   
    <th width='4%' align='left'  valign='top'>
    </th>
    <th align='left' width='36%'  valign='top'>
    <xsl:choose>
    <xsl:when       test ="../../../../../../SpecificPhone |
                           ../../../../../../../../../../
                           ProtocolSpecificContact/Phone">
    <xsl:text>Phone</xsl:text>
    </xsl:when>
    <xsl:otherwise>
    <i>
    <xsl:text>Phone</xsl:text>
    </i>
    </xsl:otherwise>
    </xsl:choose>

   </th>
    <td width='60%'>
    <xsl:value-of  select="../../../../../../SpecificPhone"/>
    <xsl:if test="../../../../../../SpecificPhone/@Public">
    <b>
    <xsl:text>(Public=</xsl:text>
    <xsl:value-of select="../../../../../../SpecificPhone/@Public"/>
    <xsl:text>)</xsl:text>
    </b>
    </xsl:if>
    <xsl:if  test="not(../../../../../../SpecificPhone)">
    <i>
    <xsl:value-of  select="../Phone"/>
    </i>
    </xsl:if>
    </td>
    </tr>
    </table>
    </xsl:if>
   <!-- adding new phone logic -->
   <xsl:if              test="../../../../../../../../../../ProtocolSpecificContact/Phone">
   <table width='90%'  cellpadding='0' cellspacing='0'> 
   <tr>   
    <th width='4%' align='left'  valign='top'>
    </th>
    <th align='left' width='36%'  valign='top'>
   <xsl:text>Phone</xsl:text>
   </th>
    <td width='60%'>
   <xsl:value-of  select="../../../../../../../../
                          ../../ProtocolSpecificContact/Phone"/>
     
   <xsl:if test="../../../../../../../../../../ProtocolSpecificContact/
               Phone/@Public">
    <b>
    <xsl:text>  (Public=</xsl:text>
    <xsl:value-of select="../../../../../../../../../../ProtocolSpecificContact/Phone/@Public"/>
    <xsl:text>)</xsl:text>
    </b>
    </xsl:if>
   </td>
    </tr>
    </table>
    </xsl:if>
  
  
  
     <xsl:if            test = "not(../../../../../../../../../../../ProtocolSpecificContact/TollFreePhone)">
     
    <table width='90%'  cellpadding='0' cellspacing='0'> 
   <tr> 
   <th width='4%' align='left'  valign='top'>
   </th>
   <th align='left' width='36%'  valign='top'>
    <xsl:text>Toll Free Phone</xsl:text>
    <xsl:choose>
    <xsl:when         test="../../../../../../SpecificTollFreePhone |
                            ../../../../../../../../../../
                            ProtocolSpecificContact/TollFreePhone">
                            
   <xsl:text>Toll Free Phone</xsl:text>
   </xsl:when>
   <xsl:otherwise>
   <!-- i am here -->
   <xsl:if          test="../TollFreePhone">
    <i>
    <xsl:text>Toll Free Phone</xsl:text>
    </i>
    </xsl:if>
    </xsl:otherwise>
    </xsl:choose>
    </th>
   <td width='60%'>
   <xsl:value-of  select="../../../../../../SpecificTollFreePhone"/>
   <xsl:if  test="not(../../../../../../SpecificTollFreePhone)">
   <i><xsl:value-of  select="../TollFreePhone"/>
   </i>
   </xsl:if>
   </td>
   </tr>
   </table>
   </xsl:if>
    <xsl:if              test="../../../../../../../../../../
                               ProtocolSpecificContact/TollFreePhone">
   <table width='90%'  cellpadding='0' cellspacing='0'> 
   <tr>   
    <th width='4%' align='left'  valign='top'>
    </th>
    <th align='left' width='36%'  valign='top'>
    <xsl:text>Toll Free Phone</xsl:text>
    </th>
    <td width='60%'>
   <xsl:value-of  select="../../../../../../../../../../ProtocolSpecificContact/TollFreePhone"/>
    </td>
    </tr>
    </table>
    </xsl:if> 
   
    <xsl:if            test = "not(../../../../../../../../../../
                               ProtocolSpecificContact/Fax)">
     
   <table width='90%'  cellpadding='0' cellspacing='0'> 
   <tr>  
    <th width='4%' align='left'  valign='top'>
    </th>
    <th align='left' width='36%'  valign='top'>
    <xsl:choose>
    <xsl:when       test="../../../../../../SpecificFax |
                          ../../../../../../../../../../
                          ProtocolSpecificContact/Fax">
                          
   <xsl:text>Fax</xsl:text>
   </xsl:when>
   <xsl:otherwise>
    <i>
    <xsl:text>Fax</xsl:text>
    </i>
   </xsl:otherwise>
   </xsl:choose>
   </th>
   <td width='60%'>
    <xsl:value-of  select="../../../../../../SpecificFax"/>
    <xsl:if  test="not(../../../../../../SpecificFax)">
    <i>
   <xsl:value-of  select="../Fax"/>
   </i>
    </xsl:if>
   </td>
   </tr>
   </table>
   </xsl:if>
     <xsl:if            test = "../../../../../../../../../../
                               ProtocolSpecificContact/Fax">
     
   <table width='90%'  cellpadding='0' cellspacing='0'> 
   <tr>  
    <th width='4%' align='left'  valign='top'>
    </th>
    <th align='left' width='36%'  valign='top'>
   <xsl:text>Fax</xsl:text>
   </th>
   <td width='60%'>
   <xsl:value-of       select="../../../../../../../../../../
                               ProtocolSpecificContact/Fax"/>
   </td>
   </tr>
   </table>
   </xsl:if>
    
    <xsl:if            test = "not(../../../../../../../../../../..
                               /ProtocolSpecificContact/Email)">
     
   <table width='90%'  cellpadding='0' cellspacing='0'> 
   <tr>  
    <th width='4%' align='left'  valign='top'>
    </th>
   <th align='left' width='36%' valign='top'>
   <xsl:text>Email</xsl:text>
   </th>
   <td width='60%'>
   <xsl:element name="a">
   <xsl:attribute name="href">
   <xsl:value-of  select="concat('mailto:',../../../../../../SpecificEmail)"/>
   </xsl:attribute>
   <xsl:value-of  select="../../../../../../SpecificEmail"/>
   </xsl:element> 
   <xsl:if test="../../../../../../SpecificEmail/@Public">
   <b>
   <xsl:text>&#xa0;&#xa0;(Public=</xsl:text>
   <xsl:value-of select="../../../../../../SpecificEmail/@Public"/>
   <xsl:text>)</xsl:text>
   </b>
   </xsl:if>
   </td>
   </tr>
   </table>
   </xsl:if>
   <xsl:if            test = "../../../../../../../../../../
                                ProtocolSpecificContact/Email">
     
   <table width='90%'  cellpadding='0' cellspacing='0'> 
   <tr>  
    <th width='4%' align='left' valign='top'>
    </th>
   <th align='left' width='36%' valign='top'>
   <xsl:text>Email</xsl:text>
   </th>
   <td width='60%'>
   <xsl:element name="a">
   <xsl:attribute name="href">
   <xsl:value-of  select="concat('mailto:',../../../../../../../../../..
                          ProtocolSpecificContact/Email)"/>
   </xsl:attribute>
   <xsl:value-of     select="../../../../../../../../../../
                            ProtocolSpecificContact/Email"/>
   </xsl:element> 
   <xsl:if test="../../../../../../../../../../
                 ProtocolSpecificContact/Email/@Public">
   <b>
   <xsl:text>&#xa0;&#xa0;(Public=</xsl:text>
   <xsl:value-of   select="../../../../../../../../../../
                           ProtocolSpecificContact/Email/@Public"/>
   <xsl:text>)</xsl:text>
   </b>
   </xsl:if>
   </td>
   </tr>
   </table>
   </xsl:if>
    
      
   <table width='90%'  cellpadding='0' cellspacing='0'> 
   <tr>   
    <th width='4%' align='left' valign='top'>
   </th>
   <th  width='36%' align='left' valign='top'>
   <xsl:choose>
   <xsl:when     test ="../../../../../../SpecificWebSite">
   <b>
   <xsl:text>Web Site</xsl:text>
   </b>
   </xsl:when>
   <xsl:when    test="../WebSite">
   <i>
   <b>
   <xsl:text>Web Site</xsl:text>
   </b>
   </i>
   </xsl:when>
   <xsl:otherwise>
   <b>
   <xsl:text>Web Site</xsl:text>
   </b>
   </xsl:otherwise>
   </xsl:choose>
   </th>
   <td width='60%'>
    <xsl:if        test ="../../../../../../../../../../
                         ProtocolSpecificContact/WebSite ">
    <xsl:element name="a">
    <xsl:attribute name="href">
     <xsl:choose>
     <xsl:when      test="contains(../../../../../../../../../../
                          ProtocolSpecificContact/WebSite/
                          @cdr:xref,'http')">
                          
    <xsl:value-of   select="../../../../../../../../../../
                               ProtocolSpecificContact/WebSite/@cdr:xref"/>
    </xsl:when>
    <xsl:otherwise>
    <xsl:value-of   select="concat('http://',../../../../../../../../../../
                                    ProtocolSpecificContact/WebSite/@cdr:ref)"/>
                            
    </xsl:otherwise>
    </xsl:choose>
    </xsl:attribute>
    <xsl:attribute  name="target">
    <xsl:text>new</xsl:text>
   </xsl:attribute>
   
    <xsl:value-of   select="../../../../../../../../../../
                            ProtocolSpecificContact/WebSite"/>
    </xsl:element>
   <br /> 
      
   
   <xsl:value-of  select="../../../../../../../../../../
                               ProtocolSpecificContact/WebSite"/>
   </xsl:if>
    
     
   
    <xsl:if        test = "../../../../../../SpecificWebSite/@cdr:xref">
    <xsl:element name="a">
    <xsl:attribute name="href">
     <xsl:choose>
     <xsl:when      test="contains(../../../../../../SpecificWebSite/@cdr:xref,
                          'http')">
    <xsl:value-of   select="../../../../../../SpecificWebSite/@cdr:xref"/>
    </xsl:when>
    <xsl:otherwise>
    <xsl:value-of   select="concat('http://',../../../../../../SpecificWebSite/
                    @cdr:xref)"/>
    </xsl:otherwise>
    </xsl:choose>
    </xsl:attribute>
    <xsl:attribute  name="target">
    <xsl:text>new</xsl:text>
    </xsl:attribute>
   
    <xsl:value-of   select="../../../../../../SpecificWebSite/@cdr:xref"/>
    </xsl:element>
   <br /> 
      
   
   <xsl:value-of  select="../../../../../../SpecificWebSite"/>
   </xsl:if>
    
    <xsl:if        test="not(../../../../../../SpecificWebSite)">
    <xsl:if        test ="../WebSite/@cdr:xref">
    <xsl:element name="a">
    <xsl:attribute name="href">
     <xsl:choose>
     <xsl:when      test="contains(../WebSite/@cdr:xref,
                          'http')">
    <xsl:value-of   select="../WebSite/@cdr:xref"/>
    </xsl:when>
    <xsl:otherwise>
    <xsl:value-of   select="concat('http://',../WebSite/
                    @cdr:xref)"/>
    </xsl:otherwise>
    </xsl:choose>
    </xsl:attribute>
    <xsl:attribute  name="target">
    <xsl:text>new</xsl:text>
    </xsl:attribute>
   
    <i>
    <xsl:value-of   select="../WebSite/@cdr:xref"/>
    </i>
    </xsl:element>
    <br />
    <i>
    <xsl:value-of  select="../WebSite"/>
    </i>
   </xsl:if>
   </xsl:if>
   </td>
   </tr>
   </table>
  </xsl:if> 
  <br />
   <br />
  </xsl:for-each>
  </xsl:if>
  </xsl:for-each>
 
<!-- ================================================================
      Display Orgs Name, Status, and Contact Information
     ================================================================= -->
  <xsl:for-each           select="ProtocolSites">
    <u>
    <b>
    <font size='3'>Participating Organizations (for Lead Organization)        
    </font>
    </b>
    </u>
    <br />
   <ol bottom-margin='0'>
   <xsl:for-each      select="OrgSiteID | PrivatePracticeSiteID">
   <li>
   <table width='90%' cellpadding='0' cellspacing='0'>
    <tr>
   <th align='left' width='40%' valign='top'>
   <b><font size='3'>Organization Name</font></b>
     </th>
     <td width='60%'>      
     <xsl:value-of     select="Organization/
                                OrganizationNameInformation/
                                OfficialName/Name"/>
      <xsl:if           test = "PrivatePracticePerson">
      <xsl:value-of     select ="'Private Practice'"/>
      </xsl:if>
      </td>
      </tr>
     </table>
      <table width='90%' cellpadding='0' cellspacing='0'>
      <tr>
      <th align='left' width='40%' valign='top'>
       <b>
      <font size='3'>Organization Protocol Status
       </font>
       </b>
       </th>
      <td width='60%'>
      <xsl:value-of         select="OrgSiteStatus | PrivatePracticeSiteStatus"/>
      </td>
      </tr>
     </table>
     
       <xsl:for-each         select="OrgSiteContact | PrivatePracticePerson">
        <xsl:if              test= "SpecificPerson | Person">
       <xsl:for-each         select="SpecificPerson/Person | Person">
       <xsl:variable name="PerFrag"  select="substring-after(@cdr:ref,'#')"/>
       
       <table width='90%' cellpadding='0' cellspacing='0'>

          <tr>
         <th align='left' width='40%' valign='top'>
         <b><font size='3'>Contact
         </font>
         </b>
         </th>
        <td width='60%'>
         <xsl:value-of       select="PersonNameInformation/SurName"/>,
         <xsl:value-of       select="PersonNameInformation/GivenName"/>
         <xsl:text>&#xa0;[</xsl:text>
         <xsl:value-of  select="$PerFrag"/>
         <xsl:text>]</xsl:text>
         </td>
         </tr> 
         <tr>
         <th align='left' width='40%' valign='top'>
         <b><font size='3'>Role
         </font>
         </b>
         </th>
         <td width='60%'>
       <xsl:value-of            select="../Role |../../Role"/>
       </td>
       </tr>
        <tr>
         <th align='left' width='40%' valign='top'>
         <b><font size='3'>Organization Location
         </font>
         </b>
         </th>
         <td width='60%'>
       <xsl:value-of          select="PersonLocations/
                                      OtherPracticeLocation[$PerFrag=@cdr:id]/
                                      OrganizationLocation/Organization/
                                      OrganizationNameInformation/
                                      OfficialName/Name"/>         
       </td>
       </tr>
       <xsl:if               test= "not(PersonLocations/
                                    OtherPracticeLocation[$PerFrag=@cdr:id]/
                                    SpecificPostalAddress)"> 
     <xsl:if                 test= "not(PersonLocations/
                                    PrivatePractice/
                                    PrivatePracticeLocation[$PerFrag=@cdr:id])">
                                                                                                       
                                         
                                     
     <xsl:for-each         select="PersonLocations/
                                   OtherPracticeLocation[$PerFrag=@cdr:id]/
                                   OrganizationLocation/Organization/
                                   OrganizationLocations/
                                   OrganizationLocation/
                                   Location/
                                   PostalAddress/Street">
    <xsl:variable name="contact" select="../../../../../../../../CIPSContact"/>
     <xsl:if             test ="$contact = ../../@cdr:id">
                                
                                                                           
        
        <tr>
                                 
        <th align='left' width='40%'  valign='top'>
        <xsl:if test="not(preceding-sibling::Street)">
         <i>
         <b><font size='3'>Street
         </font>
         </b>
         </i>
         </xsl:if>
         </th>
         <td width='60%'>
         <i>
         <xsl:value-of       select = "."/>
         </i>
       </td>
       </tr>
       </xsl:if>
      </xsl:for-each>
     
    
    
      
      <xsl:for-each           select="PersonLocations/
                                      OtherPracticeLocation[$PerFrag=@cdr:id]/
                                      OrganizationLocation/Organization/
                                      OrganizationLocations/
                                      OrganizationLocation/
                                      Location/
                                      PostalAddress">
                                      
   <xsl:variable    name ="contact" 
                    select
                    ="../../../../../../../CIPSContact"/>                  
   <xsl:if          test = "../@cdr:id = $contact">                       
                                    
   <tr>
   <th align='left' width='40%'>
   <i>
   <xsl:text>City</xsl:text>
   </i>
   </th>
   <td width='60%'>
  <i>
  <xsl:value-of        select="City"/>
  </i>
  </td>
  </tr>
 
 
 
   <xsl:if            test="CitySuffix">
   <tr>
   <th align='left' width='40%'  valign='top'>
   <i>
   <xsl:text>City Suffix</xsl:text>
   </i>
   </th>
   <td width='60%'>
   <i>
  <xsl:value-of        select="CitySuffix"/>
  </i>
  </td>
  </tr>
  </xsl:if>
  
 
 
                         
    <tr>
   <th align='left' width='40%'  valign='top'>
   <i>
   <xsl:text>State/Political Unit</xsl:text>
   </i>
   </th>
   <td width='60%'>
   <i>
   <xsl:value-of        select="PoliticalSubUnit_State/
                                PoliticalSubUnitFullName"/>
  </i>
  </td>
  </tr>
  
 
   <tr>                      
   <th align='left' width='40%'  valign='top'>
   <i>
   <xsl:text>Country</xsl:text>
   </i>
   </th>
   <td width='60%'>
   <i>
   <xsl:value-of        select="Country/
                                CountryFullName"/>
   </i>
  </td>
  </tr>
   <tr>                      
   <th align='left' width='40%'  valign='top'>
   <i>
   <xsl:text>Zip/Postal Code</xsl:text>
   </i>
   </th>
   <td width='60%'>
    <i>
   <xsl:value-of        select="PostalCode_ZIP"/>
    </i>    
  </td>
  </tr>
  </xsl:if>
  </xsl:for-each>
 </xsl:if>
 </xsl:if>
 
 
  <xsl:if                 test ="PersonLocations/
                                OtherPracticeLocation[$PerFrag=@cdr:id]/
                                SpecificPostalAddress">
 <xsl:for-each           select="PersonLocations/
                                 OtherPracticeLocation[$PerFrag=@cdr:id]/
                                 SpecificPostalAddress/Street">
                                      
        
        <tr>
        <th align='left' width='40%'  valign='top'>
        <xsl:if test="not(preceding-sibling::Street)">
         <b><font size='3'>Street
         </font>
         </b>
         </xsl:if>
         </th>
         <td width='60%'>
         <xsl:value-of       select = "."/>
         </td>
         </tr>
         </xsl:for-each>
         <xsl:for-each        select ="PersonLocations/
                                      OtherPracticeLocation[$PerFrag=@cdr:id]/
                                      SpecificPostalAddress">
      <tr>
      <th align='left' width='40%'  valign='top'>
     <b><font size='3'>City</font>
     </b>
     </th>
     <td width='60%'>
    <xsl:value-of        select="City"/>
    </td>
    </tr>
 
 
 
   <xsl:if            test="CitySuffix">
   <tr>
   <th align='left' width='40%'  valign='top'>
   <b>
   <font size='3'>City Suffix</font>
   </b>
   </th>
   <td width='60%'>
   <xsl:value-of        select="CitySuffix"/>
   </td>
   </tr>
   </xsl:if>
                          
    <tr>
   <th align='left' width='40%'  valign='top'>
   <b>
   <font size='3'>State/Political Unit</font>
   </b>
   </th>
   <td width='60%'>
   
   <xsl:value-of        select="PoliticalSubUnit_State/
                                PoliticalSubUnitFullName"/>
  
  </td>
  </tr>
 
 
   <tr>                      
   <th align='left' width='40%'  valign='top'>
   <b>
   <font size='3'>Country</font>
   </b>
   </th>
   <td width='60%'>
   
   <xsl:value-of        select="Country/
                                CountryFullName"/>
   
   </td>
  </tr>
 
   <tr>                      
   <th align='left' width='40%'>
   <b>
   <font size='3'>Zip/Postal Code</font>
   </b>
   </th>
   <td width='60%'>
    
   <xsl:value-of        select="PostalCode_ZIP"/>
    
  </td>
  </tr>
  
  </xsl:for-each>
  </xsl:if>
  </table>
  <xsl:if             test = "PersonLocations/PrivatePractice/
                             PrivatePracticeLocation[$PerFrag=@cdr:id]">

  <table width='90%' cellpadding='0' cellspacing='0'>

  <xsl:for-each       select = "PersonLocations/PrivatePractice/
                                PrivatePracticeLocation[$PerFrag=@cdr:id]/
                                PostalAddress/Street">
        <tr>
        <th align='left' width='40%'  valign='top'>
        <xsl:if test="not(preceding-sibling::Street)">
         <b><font size='3'>Street
         </font>
         </b>
         </xsl:if>
         </th>
         <td width='60%'>
         <xsl:value-of       select = "."/>
         </td>
         </tr>
        </xsl:for-each>
        </table>

         <table width='90%' cellpadding='0' cellspacing='0'>       
         <xsl:for-each        select="PersonLocations/PrivatePractice/
                                      PrivatePracticeLocation[$PerFrag=@cdr:id]/
                                      PostalAddress">
                                      
      <tr>
      <th align='left' width='40%'  valign='top'>
      <b>
      <font size='3'>City</font>
      </b>
     </th>
     <td width='60%'>
    <xsl:value-of        select="City"/>
    </td>
    </tr>
 
 
 
   <xsl:if            test="CitySuffix">
   <tr>
   <th align='left' width='40%'  valign='top'>
   <b>
    <font size='3'>City Suffix</font>
    </b>
   </th>
   <td width='60%'>
   <xsl:value-of        select="CitySuffix"/>
   </td>
   </tr>
   </xsl:if>
  
 
 
                         
   <tr>
   <th align='left' width='40%'  valign='top'>
   <b>
   <font size='3'>State/Political Unit</font>
   </b>
   </th>
   <td width='60%'>
   
   <xsl:value-of        select="PoliticalSubUnit_State/
                                PoliticalSubUnitFullName"/>
  
  </td>
  </tr>
  
 
   <tr>                      
   <th align='left' width='40%'  valign='top'>
   <b>
   <font size='3'>Country</font>
   </b>
   </th>
   <td width='60%'>
   <xsl:value-of        select="Country/
                                CountryFullName"/>
   
  </td>
  </tr>
   <tr>                      
   <th align='left' width='40%'  valign='top'>
   <b>
   <font size='3'>Zip/Postal Code</font>
   </b>
   </th>
   <td width='60%'>
   <xsl:value-of        select="PostalCode_ZIP"/>
   </td>
   </tr>
   </xsl:for-each>
   </table>
   </xsl:if>
  
  <xsl:if             test = "PersonLocations/
                             Home[$PerFrag=@cdr:id]">

  <table width='90%' cellpadding='0' cellspacing='0'>

  <xsl:for-each       select = "PersonLocations/
                                Home[$PerFrag=@cdr:id]/
                                PostalAddress/Street">
       <tr>
        <th align='left' width='40%'  valign='top'>
        <xsl:if test="not(preceding-sibling::Street)">
         <b><font size='3'>Street
         </font>
         </b>
         </xsl:if>
         </th>
         <td width='60%'>
         <xsl:value-of       select = "."/>
         </td>
         </tr>
        </xsl:for-each>
        </table>

         <table width='90%' cellpadding='0' cellspacing='0'>       
         <xsl:for-each         select="PersonLocations/
                                       Home[$PerFrag=@cdr:id]/
                                       PostalAddress">
                                      
      <tr>
      <th align='left' width='40%'  valign='top'>
      <b>
      <font size='3'>City</font>
      </b>
     </th>
     <td width='60%'>
    <xsl:value-of        select="City"/>
    </td>
    </tr>
 
 
 
   <xsl:if            test="CitySuffix">
   <tr>
   <th align='left' width='40%'  valign='top'>
   <b>
    <font size='3'>City Suffix</font>
    </b>
   </th>
   <td width='60%'>
   <xsl:value-of        select="CitySuffix"/>
   </td>
   </tr>
   </xsl:if>
  
 
 
                         
   <tr>
   <th align='left' width='40%'  valign='top'>
   <b>
   <font size='3'>State/Political Unit</font>
   </b>
   </th>
   <td width='60%'>
   
   <xsl:value-of        select="PoliticalSubUnit_State/
                                PoliticalSubUnitFullName"/>
  
  </td>
  </tr>
  
 
   <tr>                      
   <th align='left' width='40%'  valign='top'>
   <b>
   <font size='3'>Country</font>
   </b>
   </th>
   <td width='60%'>
   
   <xsl:value-of        select="Country/
                                CountryFullName"/>
   
   
  </td>
  </tr>
   <tr>                      
   <th align='left' width='40%'  valign='top'>
   <b>
   <font size='3'>Zip/Postal Code</font>
   </b>
   </th>
   <td width='60%'>
   <xsl:value-of        select="PostalCode_ZIP"/>
  </td>
  </tr>
  </xsl:for-each>
  </table>
  </xsl:if>

   <table width='90%' cellpadding='0' cellspacing='0'>    
       <tr>
       <th align='left' width='40%' valign='top'>
       <xsl:choose>
       <xsl:when      test="PersonLocations/OtherPracticeLocation[$PerFrag=
                            @cdr:id]/
                            SpecificPhone |
                            PersonLocations/PrivatePractice/
                            PrivatePracticeLocation[$PerFrag=@cdr:id]/
                            Phone | PersonLocations/
                            Home[$PerFrag=@cdr:id]/Phone"> 
       <b><font size='3'>Phone
       </font>
       </b>
       </xsl:when>
     
       <xsl:when     test="PersonLocations/
                          OtherPracticeLocation[$PerFrag=@cdr:id]/
                          OrganizationLocation/Organization/
                          OrganizationLocations/
                          OrganizationLocation/Location/Phone and
                          not(PersonLocations/
                          OtherPracticeLocation[$PerFrag=@cdr:id]/
                           SpecificPhone)">
       <b>
       <i>
       <font size='3'>
       <xsl:text>Phone</xsl:text>
       </font>
       </i>
       </b>
       </xsl:when>
       <xsl:otherwise>
        <b>
        <font size='3'>
        <xsl:text>Phone</xsl:text>
        </font>
        </b>
       </xsl:otherwise>
       </xsl:choose>
       </th>
       <td width='60%'>
       <xsl:value-of         select="../SpecificPhone |
                                    PersonLocations/PrivatePractice/
                                    PrivatePracticeLocation[$PerFrag=@cdr:id]/
                                    Phone | PersonLocations/
                                    Home[$PerFrag=@cdr:id]/Phone"/>
                                                                       
        <xsl:if                test="SpecificPhone/@Public |
                                     PersonLocations/PrivatePractice/
                                     PrivatePracticeLocation[$PerFrag=@cdr:id]/
                                     Phone/@Public | PersonLocations/
                                     Home[$PerFrag=@cdr:id]/
                                     Phone/@Public">  
       <b>     
       <xsl:text>&#xa0;&#xa0;(Public=</xsl:text>
      <xsl:value-of           select= "../SpecificPhone/@Public |
                                      PersonLocations/PrivatePractice/
                                      PrivatePracticeLocation[$PerFrag=@cdr:id]/
                                      Phone/@Public | PersonLocations/
                                      Home[$PerFrag=@cdr:id]/Phone/@Public"/>

       <xsl:text>)</xsl:text>
      </b>
       </xsl:if>
       <xsl:if                  test="not(../SpecificPhone)">
       <xsl:value-of            select="PersonLocations/OtherPracticeLocation
                                        [$PerFrag=@cdr:id]/SpecificPhone"/>
       <xsl:if                  test="PersonLocations/
                                      OtherPracticeLocation[$PerFrag=@cdr:id]/
                                      SpecificPhone/@Public">
       <b>
       <xsl:text>(Public=</xsl:text>
       <xsl:value-of            select="PersonLocations/
                                        OtherPracticeLocation[$PerFrag=@cdr:id]/
                                        SpecificPhone/@Public"/>
       <xsl:text>)</xsl:text>
       </b>
       </xsl:if>
      </xsl:if>
                                    
       <xsl:if                test = "not(PersonLocations/
                                     OtherPracticeLocation[$PerFrag=@cdr:id]/
                                     SpecificPhone | ../SpecificPhone)">
       <i>
        <xsl:value-of         select = "PersonLocations/
                                        OtherPracticeLocation[$PerFrag=@cdr:id]/
                                        OrganizationLocation/Organization/
                                        OrganizationLocations/
                                        OrganizationLocation/Location/Phone"/>
       </i>
       </xsl:if>
       </td>
    <!--   <br />-->
       </tr>
       <tr>
        <th align='left' width='40%' valign='top'>
        <xsl:choose>
        <xsl:when            test="PersonLocations/
                                   OtherPracticeLocation[$PerFrag=@cdr:id]/
                                   SpecificTollFreePhone |
                                   PersonLocations/PrivatePractice/
                                   PrivatePracticeLocation[$PerFrag=@cdr:id]/
                                   TollFreePhone">
         <b><font size='3'>Toll Free Phone
        </font>
        </b>
        </xsl:when>
        <xsl:when                test="PersonLocations/
                                        OtherPracticeLocation[$PerFrag=@cdr:id]/
                                        OrganizationLocation/Organization/
                                        OrganizationLocations/
                                        OrganizationLocation/Location/
                                        TollFreePhone">
        <i>
        <b><font size='3'>Toll Free Phone
        </font>
        </b>
        </i>
        </xsl:when>
        <xsl:otherwise>
        <b><font size='3'>Toll Free Phone
        </font>
        </b>
        </xsl:otherwise>
        </xsl:choose>
        </th>
        <td width='60%'>
        <xsl:value-of            select="PersonLocations/
                                        OtherPracticeLocation[$PerFrag=@cdr:id]/
                                         SpecificTollFreePhone |
                                         PersonLocations/PrivatePractice/
                                    PrivatePracticeLocation[$PerFrag=@cdr:id]/
                                         TollFreePhone"/>
       <xsl:if                  test="not(PersonLocations/
                                    OtherPracticeLocation[$PerFrag=@cdr:id]/
                                     SpecificTollFreePhone)">
      <i><xsl:value-of           select="PersonLocations/
                                        OtherPracticeLocation[$PerFrag=@cdr:id]/
                                        OrganizationLocation/Organization/
                                        OrganizationLocations/
                                        OrganizationLocation/Location/
                                        TollFreePhone"/>  
                                    
       </i>
       </xsl:if>
       </td>
       </tr>
       <tr>
       <th align='left' width='40%' valign='top'>
        <xsl:choose>
        <xsl:when        test="PersonLocations/
                               OtherPracticeLocation[$PerFrag=@cdr:id]/
                               SpecificFax 
                               | PersonLocations/PrivatePractice/
                               PrivatePracticeLocation[$PerFrag=@cdr:id]/
                               Fax | PersonLocations/
                               Home[$PerFrag=@cdr:id]/Fax">
        <b><font size='3'>Fax
        </font>
        </b>
        </xsl:when>
        <xsl:when        test="PersonLocations/
                               OtherPracticeLocation[$PerFrag=@cdr:id]/
                               OrganizationLocation/Organization/
                               OrganizationLocations/
                               OrganizationLocation/Location/Fax">
         <i>
        <b><font size='3'>Fax
        </font>
        </b>
        </i>
        </xsl:when>
        <xsl:otherwise>
        <b><font size='3'>Fax
        </font>
        </b>
        </xsl:otherwise>
        </xsl:choose>
        </th>
        <td width='60%'>
        <xsl:value-of           select ="PersonLocations/
                                      OtherPracticeLocation[$PerFrag=@cdr:id]/
                                      SpecificFax 
                                        | PersonLocations/PrivatePractice/
                                     PrivatePracticeLocation[$PerFrag=@cdr:id]/
                                     Fax | PersonLocations/
                                     Home[$PerFrag=@cdr:id]/Fax"/>

                                                                                                                      
       <xsl:if                  test="not(PersonLocations/
                                        OtherPracticeLocation[$PerFrag=@cdr:id]/
                                        SpecificFax)">
       <i>
      <xsl:value-of              select="PersonLocations/
                                        OtherPracticeLocation[$PerFrag=@cdr:id]/
                                        OrganizationLocation/Organization/
                                        OrganizationLocations/
                                        OrganizationLocation/Location/Fax"/>
      </i>
      
      </xsl:if>
       </td>
       </tr>
      
       <tr>
        <th align='left' width='40%' valign='top'>
        <b><font size='3'>Email
        </font>
        </b>
        </th>
        <td width='60%'>
        <xsl:element name="a">
        <xsl:attribute name="href">
        <xsl:value-of          select="concat('mailto:',PersonLocations/
                                       OtherPracticeLocation[$PerFrag=@cdr:id]/
                                       SpecificEmail |
                                       PersonLocations/PrivatePractice/
                                    PrivatePracticeLocation[$PerFrag=@cdr:id]/
                                    Email | PersonLocations/
                                    Home[$PerFrag=@cdr:id]/Email)"/>
      </xsl:attribute>
        <xsl:value-of        select="PersonLocations/
                                     OtherPracticeLocation[$PerFrag=@cdr:id]/
                                     SpecificEmail |
                                     PersonLocations/PrivatePractice/
                                     PrivatePracticeLocation[$PerFrag=@cdr:id]/
                                     Email | PersonLocations/
                                     Home[$PerFrag=@cdr:id]/Email"/>
      </xsl:element>
     
        
          <xsl:if                test="PersonLocations/
                                      OtherPracticeLocation[$PerFrag=@cdr:id]/
                                      SpecificEmail/@Public |
                                      PersonLocations/PrivatePractice/
                                      PrivatePracticeLocation[$PerFrag=@cdr:id]/
                                      Email/@Public | PersonLocations/
                                      Home[$PerFrag=@cdr:id]/Email/@Public">
           <b>
          <xsl:text>&#xa0;&#xa0;(Public=</xsl:text>
          <xsl:value-of       select="PersonLocations/OtherPracticeLocation/
                                      SpecificEmail/@Public |
                                      PersonLocations/PrivatePractice/
                                      PrivatePracticeLocation[$PerFrag=@cdr:id]/
                                      Email/@Public | PersonLocations/
                                      Home[$PerFrag=@cdr:id]/Email/Public"/>

          <xsl:text>)</xsl:text>
          </b>
          </xsl:if>
          </td>
          </tr>
        
          <tr>
          <th align='left' width='40%' valign='top'>
          <xsl:choose>
          <xsl:when          test= "PersonLocations/
                                    OtherPracticeLocation[$PerFrag=@cdr:id]/
                                    SpecificWebSite |
                                    PersonLocations/PrivatePractice/
                                    PrivatePracticeLocation[$PerFrag=@cdr:id]/
                                    WebSite | PersonLocations/
                                    Home[$PerFrag=@cdr:id]/WebSite">
          <b><font size='3'>Web Site
          </font>
          </b>
          </xsl:when>
          <xsl:when               test="PersonLocations/
                                        OtherPracticeLocation[$PerFrag=@cdr:id]/
                                        OrganizationLocation/Organization/
                                        OrganizationLocations/
                                        OrganizationLocation/Location/
                                        WebSite">
          <i>
          <b><font size='3'>Web Site
          </font>
          </b>
          </i>
          </xsl:when>
          <xsl:otherwise>
          <b><font size='3'>Web Site
          </font>
          </b>
          </xsl:otherwise>
          </xsl:choose>
          </th>
         <td width='60%'>
          <xsl:if          test =  "PersonLocations/
                                    OtherPracticeLocation[$PerFrag=@cdr:id]/
                                    SpecificWebSite/@cdr:xref |
                                    PersonLocations/PrivatePractice/
                                    PrivatePracticeLocation[$PerFrag=@cdr:id]/
                                    WebSite/@cdr:xref | PersonLocations/
                                    Home[$PerFrag=@cdr:id]/WebSite/@cdr:xref">
        
        <xsl:element  name="a">
        <xsl:attribute name="href">
        <xsl:choose>
        <xsl:when           test ="contains(PersonLocations/
                                    OtherPracticeLocation[$PerFrag=@cdr:id]/
                                    SpecificWebSite/@cdr:xref,'http')">
                                    
        <xsl:value-of       select ="PersonLocations/
                                    OtherPracticeLocation[$PerFrag=@cdr:id]/
                                    SpecificWebSite/@cdr:xref"/>
        </xsl:when>
        <xsl:otherwise>
        <xsl:value-of      select ="concat('http://',PersonLocations/
                                    OtherPracticeLocation[$PerFrag=@cdr:id]/
                                    SpecificWebSite/@cdr:xref)"/>
        
        </xsl:otherwise>
        </xsl:choose>

        <xsl:choose>                                     
        <xsl:when           test ="contains(PersonLocations/PrivatePractice/
                                   PrivatePracticeLocation[$PerFrag=@cdr:id]/
                                   WebSite/@cdr:xref,'http')">
                                    
        <xsl:value-of       select ="PersonLocations/PrivatePractice/
                                    PrivatePracticeLocation[$PerFrag=@cdr:id]/
                                    WebSite/@cdr:xref"/>
        </xsl:when>
         
        <xsl:otherwise>
        <xsl:value-of      select ="concat('http://',PersonLocations/
                                    PrivatePractice/
                                    OtherPracticeLocation[$PerFrag=@cdr:id]/
                                    WebSite/@cdr:xref)"/>
        
        </xsl:otherwise>
        </xsl:choose>
        <xsl:choose>
        <xsl:when           test ="contains(PersonLocations/
                                    Home[$PerFrag=@cdr:id]/
                                    WebSite/@cdr:xref,'http')">
                                    
        <xsl:value-of       select ="PersonLocations/
                                     Home[$PerFrag=@cdr:id]/
                                     WebSite/@cdr:xref"/>
        </xsl:when>
        <xsl:otherwise>
        <xsl:value-of      select ="concat('http://',PersonLocations/
                                    Home[$PerFrag=@cdr:id]/
                                    WebSite/@cdr:xref)"/>
        
        </xsl:otherwise>
        </xsl:choose>
       
                               
        <xsl:value-of       select="PersonLocations/
                                    OtherPracticeLocation[$PerFrag=@cdr:id]/
                                    SpecificWebSite/@cdr:xref |
                                    PersonLocations/PrivatePractice/
                                    PrivatePracticeLocation[$PerFrag=@cdr:id]/
                                    WebSite/@cdr:xref | PersonLocations/
                                    Home[$PerFrag=@cdr:id]/WebSite/@cdr:xref"/>
      </xsl:attribute>
       <xsl:attribute  name="target">
       <xsl:text>new</xsl:text>
       </xsl:attribute>
   
      
       <xsl:value-of       select="PersonLocations/
                                   OtherPracticeLocation[$PerFrag=@cdr:id]/
                                   SpecificWebSite/@cdr:xref |
                                   PersonLocations/PrivatePractice/
                                   PrivatePracticeLocation[$PerFrag=@cdr:id]/
                                   WebSite/@cdr:xref | PersonLocations/
                                   Home[$PerFrag=@cdr:id]/WebSite/@cdr:xref"/>
     
     </xsl:element> 
     <br />
     </xsl:if>
     
                                       
        
        <xsl:value-of        select="PersonLocations/
                                    OtherPracticeLocation[$PerFrag=@cdr:id]/
                                    SpecificWebSite |
                                    PersonLocations/PrivatePractice/
                                    PrivatePracticeLocation[$PerFrag=@cdr:id]/
                                    WebSite | PersonLocations/
                                    Home[$PerFrag=@cdr:id]/WebSite"/>

                                       
                
        <xsl:if                 test="not(PersonLocations/
                                      OtherPracticeLocation[$PerFrag=@cdr:id]/
                                      SpecificWebSite)">
        <xsl:if                 test= "PersonLocations/
                                        OtherPracticeLocation[$PerFrag=@cdr:id]/
                                        OrganizationLocation/Organization/
                                        OrganizationLocations/
                                        OrganizationLocation/Location/
                                        WebSite/@cdr:xref">
     <!-- <xsl:if                 test =   "PersonLocations/
                                        OtherPracticeLocation[$PerFrag=@cdr:id]/
                                        OrganizationLocation/Organization/
                                        OrganizationLocations/
                                        OrganizationLocation/Location/
                                        WebSite/@cdr:xref">-->
      <xsl:element name="a">
      <xsl:attribute name="href">
      <xsl:choose>
      <xsl:when                 test = "contains(PersonLocations/
                                        OtherPracticeLocation[$PerFrag=@cdr:id]/
                                        OrganizationLocation/Organization/
                                        OrganizationLocations/
                                        OrganizationLocation/Location/
                                        WebSite/@cdr:xref,'http')"> 
      
        <xsl:value-of           select="PersonLocations/
                                        OtherPracticeLocation[$PerFrag=@cdr:id]/
                                        OrganizationLocation/Organization/
                                        OrganizationLocations/
                                        OrganizationLocation/Location/
                                        WebSite/@cdr:xref"/> 
   
      </xsl:when>
     <xsl:otherwise>
         <xsl:value-of             select="concat('http://',PersonLocations/
                                        OtherPracticeLocation[$PerFrag=@cdr:id]/
                                        OrganizationLocation/Organization/
                                        OrganizationLocations/
                                        OrganizationLocation/Location/
                                        WebSite/@cdr:xref)"/>
   
      </xsl:otherwise>
      </xsl:choose>
      </xsl:attribute>
      <xsl:attribute  name="target">
      <xsl:text>new</xsl:text>
      </xsl:attribute>
   
      <i>
      <xsl:value-of                     select="PersonLocations/
                                        OtherPracticeLocation[$PerFrag=@cdr:id]/
                                        OrganizationLocation/Organization/
                                        OrganizationLocations/
                                        OrganizationLocation/Location/
                                        WebSite/@cdr:xref"/>
     
      </i>
    </xsl:element>
    <br /> 
    <i> 
    <xsl:value-of                       select="PersonLocations/
                                        OtherPracticeLocation[$PerFrag=@cdr:id]/
                                        OrganizationLocation/Organization/
                                        OrganizationLocations/
                                        OrganizationLocation/Location/
                                        WebSite"/>
    </i>
    
     
   </xsl:if>   
             
   </xsl:if>
    
 
   </td>
   </tr>
   </table>
    <br /> <!-- added this one -->
   </xsl:for-each>
       <br />
   </xsl:if> 
       
      <xsl:if test="GenericPerson">
      <table width='90%'  cellpadding='0' cellspacing='0'>
      <tr>
      <th align='left' width='40%'>
    
        <b><font size='3'>Generic Title
        </font>
        </b>
        </th>
        <td width='60%'>
       <xsl:value-of        select="GenericPerson/PersonTitle"/>
       </td>
       </tr>
        <tr>
        <th align='left' width='40%'>
     
        <b><font size='3'>GenericContact
        </font>
        </b>
        </th>
       <td width='60%'>
       <xsl:value-of        select="GenericPerson/
                                    GenericPersonContact/ContactName"/>
        </td>
        </tr>
         
    
        <xsl:for-each            select="GenericPerson/GenericPersonContact/
                                        ContactDetail/PostalAddress/Street">
          <tr>                  
         <th align='left' width='40%' valign='top'>
         <xsl:if test="not(preceding-sibling::Street)">
         <b>
         <xsl:text>Street</xsl:text>
         </b>
         </xsl:if>
        </th>
        <td width='60%'>
       <xsl:value-of            select="."/>
       </td>
       </tr>
       </xsl:for-each>
      <!-- </td>
       </tr>-->
         <tr>
        <th align='left' width='40%'  valign='top'>
        <b><font size='3'>City
        </font>
        </b>
        </th>
        <td width='60%'>              
       <xsl:value-of              select="GenericPerson/GenericPersonContact/
                                          ContactDetail/PostalAddress/City"/>
       </td>
        </tr>
        <tr>
        <th align='left' width='40%'  valign='top'>
        <b><font size='3'>PoliticalSubUnit
        </font>
        </b>
        </th>
       <td width='60%'>             
       <xsl:value-of           select="GenericPerson/GenericPersonContact/
                                         ContactDetail/PostalAddress/
                                         PoliticalSubUnit_State/
                                         PoliticalSubUnitFullName"/>
        </td>
        </tr>
        <tr>
        <th align='left' width='40%'  valign='top'>
        <b><font size='3'>Country
        </font>
        </b>
        </th>
        <td width='60%'>              
        <xsl:value-of            select="GenericPerson/GenericPersonContact/
                                         ContactDetail/PostalAddress/
                                         Country/CountryFullName"/>
      
         </td>
         </tr>
         <tr>
        <th align='left' width='40%'  valign='top'>
        <b>
        <font size='3'>ZIP/PostalCode
        </font>
        </b>
        </th>
       <td width='60%'>
       <xsl:value-of                    select="GenericPerson/
                                                GenericPersonContact/
                                                ContactDetail/
                                                PostalAddress/
                                                PostalCode_ZIP"/>
       </td>
       </tr>
        <tr>
        <th align='left' width='40%'  valign='top'>
        <b><font size='3'>Phone
        </font>
        </b>
        </th>
        <td width='60%'>             
                       
         <xsl:value-of                  select="GenericPerson/
                                                GenericPersonContact/
                                                ContactDetail/Phone"/>&#xa0;
         <xsl:if                        test="GenericPerson/
                                              GenericPersonContact/
                                              ContactDetail/Phone/@Public">
           <b>
          <xsl:text>(Public=</xsl:text>
          <xsl:value-of                 select="GenericPerson/
                                                GenericPersonContact/
                                                ContactDetail/Phone/@Public"/>
          <xsl:text>)</xsl:text>
         </b>
          </xsl:if>
             
         <br />
          </td>
          </tr>
          <tr>
          <th align='left' width='40%'  valign='top'>
          <b><font size='3'>Toll Free Phone
          </font>
          </b>
         </th>
         <td width='60%'>              
        <xsl:value-of                 select="GenericPerson/
                                              GenericPersonContact/
                                              ContactDetail/
                                              TollFreePhone"/>

    
         </td>
         </tr>
         <tr>
        <th align='left' width='40%'>
        <xsl:choose>
        <xsl:when                  test="GenericPerson/
                                         GenericPersonContact/
                                         ContactDetail/Fax">
        <b><font size='3'>Fax
        </font>
        </b>
        </xsl:when>
        <xsl:otherwise>
        <i>
        <b><font size='3'>Fax
        </font>
        </b>
        </i>
       </xsl:otherwise>
       </xsl:choose>   
       </th>
      <td width='60%'>             
      <xsl:value-of                     select="GenericPerson/
                                                GenericPersonContact/
                                                ContactDetail/Fax"/>

     <xsl:if                           test = "not(GenericPerson/
                                                GenericPersonContact/
                                                ContactDetail/Fax)">
      <i>
      <xsl:value-of                    select = "../Organization/
                                              OrganizationLocations/
                                              OrganizationLocation/Location/
                                               Fax"/>

                                    
       </i>
       </xsl:if>
        </td>
       </tr>
      
        <tr>
        <th align='left' width='40%' valign='top'>
        <b><font size='3'>Email
        </font>
        </b>
        </th>
        <td width='60%'> 
         <xsl:element name="a">
         <xsl:attribute name="href">                        
          <xsl:value-of                   select="concat('mailto:',
                                                  GenericPerson/
                                                  GenericPersonContact/
                                                  ContactDetail/
                                                  Email)"/>
          </xsl:attribute>
           <xsl:value-of                   select="GenericPerson/
                                                  GenericPersonContact/
                                                  ContactDetail/
                                                  Email"/>
          </xsl:element>
          <xsl:text>&#xa0;</xsl:text>
          
            
          <xsl:if                         test="GenericPerson/Email/@Public">
          <b>
          <xsl:text>&#xa0;&#xa0;(Public=</xsl:text>
          <xsl:value-of                   select="GenericPerson/
                                                 GenericPersonContact/
                                                 ContactDetail/Email/@Public"/>
          
          <xsl:text>)</xsl:text>
          </b>
          </xsl:if>
          </td>
          </tr>
         <tr>
        <th align='left' width='40%' valign='top'>
        <xsl:choose>
        <xsl:when        test="GenericPerson/GenericPersonContact/
                                ContactDetail/WebSite">
                                  
        <b><font size='3'>Web Site
        </font>
        </b>
        </xsl:when>
        <xsl:otherwise>
        <i>
        <b><font size='3'>Web Site
        </font>
        </b>
        </i>
        </xsl:otherwise>
        </xsl:choose>
        </th>
        <td width='60%'>
        <xsl:if           test="GenericPerson/GenericPersonContact/
                                ContactDetail/WebSite">
                       
        <xsl:element name="a">
        <xsl:attribute name="href">
       <xsl:choose>
        <xsl:when                        test=    "contains(GenericPerson/
                                                   GenericPersonContact/
                                                   ContactDetail/WebSite,'http')
                                                   ">
         <xsl:value-of                     select="GenericPerson/
                                                   GenericPersonContact/
                                                   ContactDetail/WebSite/
                                                   @cdr:xref"/>
        </xsl:when>
        <xsl:otherwise>
        <xsl:value-of                      select="concat('http://',
                                                   GenericPerson/
                                                   GenericPersonContact/
                                                   ContactDetail/WebSite/
                                                   @cdr:xref)"/>
       </xsl:otherwise>
       </xsl:choose>
       </xsl:attribute>
       <xsl:attribute  name="target">
       <xsl:text>new</xsl:text>
       </xsl:attribute>
   
        <xsl:value-of                     select="GenericPerson/
                                                   GenericPersonContact/
                                                   ContactDetail/WebSite/
                                                   @cdr:xref"/>
                                                   
       </xsl:element>
       <br />
        <xsl:value-of                     select="GenericPerson/
                                                   GenericPersonContact/
                                                   ContactDetail/WebSite"/>
                                                   
                                                   
        <br />
       </xsl:if>
                                                   
       <xsl:if                           test = "not(GenericPerson/
                                                GenericPersonContact/
                                                ContactDetail/WebSite)">
     <xsl:if                             test = "../Organization/
                                              OrganizationLocations/
                                              OrganizationLocation/Location/
                                              WebSite/@cdr:xref">
      
    <xsl:element name= "a">
    <xsl:attribute name= "href">
    <xsl:choose>
      <xsl:when                        test= "contains(../Organization/
                                              OrganizationLocations/
                                              OrganizationLocation/Location/
                                               WebSite/@cdr:xref,'http')">
     
      <xsl:value-of                    select = "../Organization/
                                              OrganizationLocations/
                                              OrganizationLocation/Location/
                                              WebSite/@cdr:xref"/>
     
      
     
      </xsl:when>
     <xsl:otherwise>
       
     <xsl:value-of                    select = "concat('http://',
                                                 OrganizationLocations/
                                                 OrganizationLocation/
                                                 Location/
                                                 WebSite/@cdr:xref)"/>
        
      
      </xsl:otherwise>
      </xsl:choose>
      </xsl:attribute>
       <xsl:attribute  name="target">
       <xsl:text>new</xsl:text>
       </xsl:attribute>
   
       <i>
       <xsl:value-of                    select = "../Organization/
                                               OrganizationLocations/
                                               OrganizationLocation/Location/
                                               WebSite/@cdr:xref"/>
       </i>
      
      </xsl:element>
      <br />
       <i>
       <xsl:value-of                    select = "../Organization/
                                               OrganizationLocations/
                                               OrganizationLocation/Location/
                                               WebSite"/>
      </i>
      
      
       </xsl:if>
       </xsl:if>
       </td>
       </tr>
       </table>
       <br />  
       </xsl:if>
       </xsl:for-each>
       </li>
       </xsl:for-each>
       </ol>
       </xsl:for-each>
       </xsl:template>
         
    <!-- =================================================================
                        Protocol Processing Details
      ================================================================ -->
             <xsl:template      match ="ProtocolProcessingDetails">
              <b>
              <font size='4'>Protocol Processing Details
              </font>
              </b>
              <br />
             <table width='90%'  cellpadding='0' cellspacing='0'>
             <tr>
             <th align='left' width='40%'  valign='top'>
             <b><font size='3'>Processing Status 
             </font>
             </b>
             </th>
             <td width='60%'>
             <xsl:value-of     select="ProcessingStatus"/>
             </td>
             </tr>
             <tr>
            <th align='left' width='40%'  valign='top'>
            <b>
            <font size='3'>Processing Date
            </font>
            </b>
            </th>
            <td width='60%'>
            <xsl:value-of      select="ProcessingDate"/>
            </td>
            </tr>
            </table>
            <b><font size='3'>Comment</font></b><br />
           <xsl:apply-templates       select="Comment"/><br />
           </xsl:template>

         
 <!-- 
 ================================================================
 Display a Note
 ================================================================ -->
 <xsl:template                  match = "Note">
  <xsl:apply-templates         select = "." 
                                 mode = "RS"/>
 
 </xsl:template>  

    <!-- ==============================================================
                     Display Dated Action
       ============================================================== -->

         <xsl:template             match = "ProtocolAdminInfo/DatedAction">
          <b>
        <font size='4'><xsl:text>Dated Action</xsl:text></font>
          </b>
          <br />
         <table width ='90%'  cellpadding='0' cellspacing='0'>
         <tr>
         <th align='left' width='40%' valign='top'>
         <b>
        <font size='3'><xsl:text>Action Description</xsl:text></font>
         </b>
         </th>
         <td width='60%'>
         <xsl:value-of             select = "ActionDescription"/>
         </td>
         </tr>
         </table>
         <table width ='90%' cellpadding='0' cellspacing='0'>
         <tr>
         <th align='left' width='40%' valign='top'>
        <b>
        <font size='3'><xsl:text>Action Date</xsl:text></font>
        </b>
        </th>
        <td>
        <xsl:value-of             select ="ActionDate"/>
        </td>
        </tr>
        </table>
        <b>
         <font size='3'><xsl:text>Comment</xsl:text></font>
        </b>   
        <br />
        <xsl:value-of             select ="Comment"/>  
        <xsl:if                   test = "Comment">                         
        <br />
        <br />
        </xsl:if>
        </xsl:template>

 
  <!-- ===============================================================
              Display Protocol-Related Links
     ================================================================ -->
  
       <xsl:template            match="ProtocolRelatedLinks">
          <b><font size='4'>Related Protocols
          </font>
           </b>
           <br />
          
          <xsl:for-each              select="RelatedProtocols/InScopeProtocol">
          <xsl:value-of              select="ProtocolIDs/PrimaryID/IDString"/>;
          <xsl:if                    test ="ProtocolIDs/OtherID/IDString">
          <xsl:value-of              select="ProtocolIDs/OtherID/IDString"/>;
          </xsl:if>
          <xsl:value-of              select="ProtocolTitle
                                             [@Type='Professional']"/>
          <br />
          <br />                       
          </xsl:for-each>
           <br />
           <b><font size='4'>Related Websites
           </font>
           </b>
           <br />
         <xsl:for-each              select ="RelatedWebsites">
          <table width='90%' cellpadding ='0' cellspacing ='0'>
          <tr>
         <th align = 'left' width ='40%'  valign='top'>
          <b><font size='3'>URL
          </font>
          </b>
          </th>
        <td width='60%'>
         <xsl:element name="a">
         <xsl:attribute name="href">
         <xsl:choose>
         <xsl:when                  test   = "contains(RelatedWebsites/
                                              @cdr:xref,'http')">
         <xsl:value-of              select = "RelatedWebsites/
                                              @cdr:xref"/>
         </xsl:when>
         <xsl:otherwise>
          <xsl:value-of              select = "concat('http://',RelatedWebsites/
                                              @cdr:xref)"/>
         </xsl:otherwise>
         </xsl:choose>
        </xsl:attribute>
         <xsl:value-of              select = "RelatedWebsites/
                                              @cdr:xref"/>
        </xsl:element>
        </td>
        </tr>
        <tr>
        <th align='left' width='40%'  valign='top'>
         <b><font size='3'>Name
         </font>
         </b>
         </th>
         <td width='60%'>
        <xsl:value-of              select = "RelatedWebsites"/>
                                              
        </td>
        </tr>
        </table>
        </xsl:for-each>
        <xsl:for-each              select="Comment">
        <b><font size='3'>Comment
         </font>
         </b>
         <br />
        <xsl:value-of              select="."/>
        <br />
       </xsl:for-each>
     </xsl:template>

       
                         
  
                                           





</xsl:transform>]]>
</CdrDocXml>
</CdrDoc>