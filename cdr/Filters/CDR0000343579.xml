<CdrDoc Type='Filter' Id='CDR0000343579'>
<CdrDocCtl>
<DocValStatus readonly="yes">U</DocValStatus>
<DocActiveStatus readonly="yes">A</DocActiveStatus>
<DocTitle readonly="yes">Module: InScopeProtocol Administrative Details </DocTitle>
<ReadyForReview readonly="yes">N</ReadyForReview>
</CdrDocCtl>
<CdrDocXml><![CDATA[<?xml      version = "1.0"?>
<!--Filter written by C.Burg - 3/13/2002 -->
<!-- ================================================================
           Filter to generate a Protocol Administrative QC Report
     ================================================================ -->
<xsl:transform               xmlns:xsl = "http://www.w3.org/1999/XSL/Transform"
                               version = "1.0"
                             xmlns:cdr = "cips.nci.nih.gov/cdr">

 <xsl:output                    method = "html"/>

 <!-- 
 ===============================================================
 Display the Protocol Sponsors
 =============================================================== -->
 <xsl:template                   match = "ProtocolSponsors">
  <b>
   <font size='4'>Protocol Sponsors</font>
  </b>

  <table        xsl:use-attribute-sets = "table">
   <xsl:for-each                select = "SponsorName">
    <tr>
     <td        xsl:use-attribute-sets = "cell1of2">
      <xsl:if                     test = "not(preceding-sibling::SponsorName)">
       <b>Name</b>
      </xsl:if>
     </td>
     <td        xsl:use-attribute-sets = "cell2of2">
      <xsl:value-of             select = "."/>
     </td>
    </tr>
   </xsl:for-each>
  </table>
  <b>Comment</b>
  <br />
  <xsl:value-of                 select = "Comment"/>
  <xsl:if                         test = "Comment">
   <br />
  </xsl:if>
 </xsl:template>


 <!-- 
 =============================================================
 Display Protocol Special Category
 ============================================================= -->
 <xsl:template                   match = "ProtocolSpecialCategory">
  <br />
  <xsl:if                         test = "not(
                                   preceding-sibling::ProtocolSpecialCategory)">
   <b>
    <font size='4'>Protocol Special Category</font>
   </b>
  </xsl:if>
  <table        xsl:use-attribute-sets = "table"> 
   <tr>
    <td         xsl:use-attribute-sets = "cell1of2">
     <u>
      <b>Special Category</b>
     </u>
    </td>
    <td         xsl:use-attribute-sets = "cell2of2">
     <xsl:value-of              select = "SpecialCategory"/>
    </td>
   </tr>
  </table>
  <b>Comment</b>
  <br />
  <xsl:value-of                 select = "Comment"/>
  <br />
  <br />
 </xsl:template>
  

 <!-- 
 ============================================================
 Display the funding information
 ============================================================ -->
 <xsl:template                   match = "FundingInfo">
  <hr />
  <br />
  <b>
   <font size='4'>Funding Information</font>
  </b>
  <xsl:for-each                 select = "NIHGrantContract">
   <table       xsl:use-attribute-sets = "table">
    <tr>
     <td        xsl:use-attribute-sets = "cell1of2">
      <u>
       <b>NIH Grant Contract Type</b>
      </u>
     </td>
     <td        xsl:use-attribute-sets = "cell2of2">
      <xsl:value-of             select = "NIHGrantContractType"/>
     </td>
    </tr>
    <tr>
     <td        xsl:use-attribute-sets = "cell1of2">
      <b>Grant Contract Number</b>
     </td>
     <td        xsl:use-attribute-sets = "cell2of2">
      <xsl:value-of             select = "GrantContractNo"/><br />
     </td>
    </tr>
   </table>

   <b>Comment</b>
   <br />
   <xsl:apply-templates         select = "Comment"/>
  </xsl:for-each>
  <br />
         
  <u>
   <b>Other Grant Contract Information</b>
  </u>
  <br />
  <xsl:for-each                 select = "OtherGrantContractInfo"> 
   <table       xsl:use-attribute-sets = "table">
    <tr>
     <td        xsl:use-attribute-sets = "cell1of2">
      <b>Grant Contract Number</b> 
     </td>
     <td        xsl:use-attribute-sets = "cell2of2">
      <xsl:value-of             select = "GrantContractNo"/>
     </td>
    </tr>
   </table>

   <b>Comment</b>
   <br />
   <xsl:value-of                select = "Comment"/>
   <br />                                      
  </xsl:for-each> 
 </xsl:template>
   

 <!-- 
 ============================================================
 Display the FDA IND information
 ============================================================ -->
 <xsl:template                   match = "FDAINDInfo">
  <br />
  <u>
   <b>FDA IND Info</b>
  </u>
  <table        xsl:use-attribute-sets = "table">
   <tr>
    <td         xsl:use-attribute-sets = "cell1of2">
     <b>IND Grantor</b>
    </td>
    <td         xsl:use-attribute-sets = "cell2of2">
     <xsl:value-of              select = "INDGrantor"/>
    </td>
   </tr>
   <tr>
    <td         xsl:use-attribute-sets = "cell1of2">
     <b>IND Number</b>
    </td>
    <td         xsl:use-attribute-sets = "cell2of2">
     <xsl:value-of              select = "INDNumber"/>
    </td>
   </tr>
   <xsl:if                        test = "INDSerialNumber">
    <tr>
     <td        xsl:use-attribute-sets = "cell1of2">
      <b>IND Serial Number</b>
     </td>
     <td        xsl:use-attribute-sets = "cell2of2">
      <xsl:value-of             select = "INDSerialNumber"/>
     </td>
    </tr>
   </xsl:if>
  </table>
 </xsl:template>
   

 <!-- 
 ================================================================
 Display the Protocol Source
 ================================================================ -->
 <xsl:template                   match = "ProtocolSource">
  <br />
   <b>
    <font size='4'>Protocol Source</font>
   </b>
   <table       xsl:use-attribute-sets = "table">
    <tr>
     <td        xsl:use-attribute-sets = "cell1of2">
      <b>Source</b>
     </td>
     <td        xsl:use-attribute-sets = "cell2of2">
      <xsl:value-of             select = "SourceName"/><br />
     </td>
    </tr>
    <tr>
     <td        xsl:use-attribute-sets = "cell1of2">
      <b>Date Received</b>
     </td>
     <td        xsl:use-attribute-sets = "cell2of2">
      <xsl:value-of             select = "DateReceived"/>
     </td>
    </tr>
   </table>
   <br />
  </xsl:template>


 <!-- 
 ====================================================================
 Display the Protocol Approval Information
 ==================================================================== -->
 <xsl:template                   match = "ProtocolApproval">
  <b>
   <font size='4'>Protocol Approval</font>
  </b>
  <table        xsl:use-attribute-sets = "table">
   <tr>
    <td         xsl:use-attribute-sets = "cell1of2">
     <b>Review ApprovalType</b>
    </td>
    <td         xsl:use-attribute-sets = "cell2of2">
     <xsl:value-of              select = "ReviewApprovalType"/>
     <br />
    </td>
   </tr>
   <tr>
    <td         xsl:use-attribute-sets = "cell1of2">
     <b>Reimbursement Approval Type</b>
    </td>
    <td         xsl:use-attribute-sets = "cell2of2">
     <xsl:value-of              select = "ReimbursementApprovalType"/>
    </td>
   </tr>
  </table>
  <b>Comment</b>
  <br />
  <xsl:value-of                 select = "Comment"/>
  <br />
 </xsl:template>


 <!-- 
 ====================================================================
 Display the Protocol Status Information
 ==================================================================== -->
 <xsl:template                   match = "CurrentProtocolStatus">
  <br />
  <b>
   <font size='4'>Current Protocol Status</font>
  </b>
  <table        xsl:use-attribute-sets = "table">
   <tr>
    <td         xsl:use-attribute-sets = "cell1of2">
     <b>Status</b>
    </td>
    <td         xsl:use-attribute-sets = "cell2of2">
     <xsl:value-of              select = "."/>
    </td>
   </tr>
  </table>
  <br />
  <br />
 </xsl:template>

 <!-- 
 ====================================================================
 Display the Lead Organization Information
 ==================================================================== -->
 <xsl:template                   match = "ProtocolLeadOrg">
  <hr />
  <b>
   <font size='4'>Lead Organization</font>
  </b>
  <br />
  <br />
  <table        xsl:use-attribute-sets = "table">
   <tr>
    <td         xsl:use-attribute-sets = "cell1of2">
     <b>Organization Name</b>
    </td>
    <td         xsl:use-attribute-sets = "cell2of2">
     <xsl:value-of              select = "LeadOrganizationID/
                                            Organization/
                                            OrganizationNameInformation/
                                            OfficialName/Name"/>
    </td>
   </tr>
  </table>

  <table        xsl:use-attribute-sets = "table">
   <tr>
    <td         xsl:use-attribute-sets = "cell1of2">
     <b>Organization Role</b>
    </td>
    <td         xsl:use-attribute-sets = "cell2of2">
     <xsl:value-of              select = "LeadOrgRole"/>
    </td>
   </tr>
  </table>

  <table        xsl:use-attribute-sets = "table">
   <tr>
    <td         xsl:use-attribute-sets = "cell1of2">
     <b>Protocol ID</b>
    </td>
    <td         xsl:use-attribute-sets = "cell2of2">
     <xsl:value-of              select = "LeadOrgProtocolID"/>
    </td>
   </tr>
  </table>

  <table        xsl:use-attribute-sets = "table">
   <tr>
    <td         xsl:use-attribute-sets = "cell1of2">
     <b>Current Protocol Status</b>
    </td>
    <td         xsl:use-attribute-sets = "cell2of2">
    </td>
   </tr>
  </table>

  <table        xsl:use-attribute-sets = "table">
   <tr>
    <td         xsl:use-attribute-sets = "cell1iof2">
    </td>
    <td         xsl:use-attribute-sets = "cell2iof2">
     <b>Status</b>
    </td>
    <td         xsl:use-attribute-sets = "cell2of2">
     <xsl:value-of              select = "LeadOrgProtocolStatuses/
                                          CurrentOrgStatus/StatusName"/>
    </td>
   </tr>
  </table>

  <table        xsl:use-attribute-sets = "table">     
   <tr>
    <td         xsl:use-attribute-sets = "cell1iof2">
    </td>
    <td         xsl:use-attribute-sets = "cell2iof2">
     <b>Date</b>
    </td>
    <td         xsl:use-attribute-sets = "cell2of2">
     <xsl:value-of              select = "LeadOrgProtocolStatuses/
                                          CurrentOrgStatus/StatusDate"/>
    </td>
   </tr>
  </table>

  <table        xsl:use-attribute-sets = "table">
   <tr>
    <td         xsl:use-attribute-sets = "cell1iof2">
    </td>
    <td         xsl:use-attribute-sets = "cell2iof2">
     <b>User</b>
    </td>     
    <td         xsl:use-attribute-sets = "cell2of2">
     <xsl:value-of              select = "LeadOrgProtocolStatuses/
                                          CurrentOrgStatus/EnteredBy"/>
    </td>
   </tr>
  </table>

  <table        xsl:use-attribute-sets = "table">
   <tr>
    <td         xsl:use-attribute-sets = "cell1iof2">
    </td>
    <td         xsl:use-attribute-sets = "cell2iof2">
     <b>Entry Date</b>
    </td>
    <td         xsl:use-attribute-sets = "cell2of2">
     <xsl:value-of              select = "LeadOrgProtocolStatuses/
                                          CurrentOrgStatus/EntryDate"/>
    </td>
   </tr>
  </table>
  <br />

  <table        xsl:use-attribute-sets = "table">
   <tr>
    <td         xsl:use-attribute-sets = "cell1of2">
     <xsl:if                      test = "LeadOrgProtocolStatuses/
                                          PreviousOrgStatus">
      <b>Previous Protocol Status</b>
     </xsl:if>
    </td>
    <td         xsl:use-attribute-sets = "cell2of2">
     <xsl:text> </xsl:text>
    </td>
   </tr>
  </table>

  <xsl:if                         test = "LeadOrgProtocolStatuses/
                                          PreviousOrgStatus">
   <xsl:for-each                select = "LeadOrgProtocolStatuses/
                                          PreviousOrgStatus">
    <table      xsl:use-attribute-sets = "table">
     <tr>
      <td       xsl:use-attribute-sets = "cell1iof2">
      </td>
      <td       xsl:use-attribute-sets = "cell2iof2">
       <b>Status</b>
      </td>
      <td       xsl:use-attribute-sets = "cell2of2">
       <xsl:value-of            select = "StatusName"/>
      </td>
     </tr>
    </table>
    <table      xsl:use-attribute-sets = "table">
     <tr>
      <td       xsl:use-attribute-sets = "cell1iof2">
      </td>
      <td       xsl:use-attribute-sets = "cell2iof2">
       <b>Date</b>
      </td>
      <td       xsl:use-attribute-sets = "cell2of2">
       <xsl:value-of            select = "StatusDate"/>
      </td>
     </tr>
    </table>

    <table      xsl:use-attribute-sets = "table">
     <tr>
      <td       xsl:use-attribute-sets = "cell1iof2">
      </td>
      <td       xsl:use-attribute-sets = "cell2iof2">
       <b>User</b>
      </td>
      <td       xsl:use-attribute-sets = "cell2of2">
       <xsl:value-of            select = "EnteredBy"/>
      </td>
     </tr>
    </table>

    <table      xsl:use-attribute-sets = "table">
     <tr>
      <td       xsl:use-attribute-sets = "cell1iof2">
      </td>
      <td       xsl:use-attribute-sets = "cell2iof2">
       <b>Entry Date</b>
      </td>
      <td       xsl:use-attribute-sets = "cell2of2">
       <xsl:value-of            select = "EntryDate"/>
      </td>
     </tr>
    </table>
    <br />
   </xsl:for-each>
  </xsl:if>

  <xsl:apply-templates          select = "OverallContact"/>

  <!-- 
  ==================================================================
  Display Lead Organization Information
  ================================================================== -->
  <br />
  <u>
   <b>Lead Organization Personnel</b>
  </u>
  <br />
  <br />
  <xsl:for-each                 select = "LeadOrgPersonnel/Person">
   <xsl:variable                  name = "orgref"       
                                select = "Person/@cdr:ref"/>
   <xsl:variable                  name = "OrgFrag"      
                                select = "substring-after($orgref,'#')"/>
        
   <table       xsl:use-attribute-sets = "table">
    <tr>
     <td        xsl:use-attribute-sets = "cell1of2">
      <u>
       <b>Person</b>
      </u>
     </td>
     <td        xsl:use-attribute-sets = "cell2of2">
      <xsl:value-of             select = "Person/
                                          PersonNameInformation/SurName"/>,
      <xsl:value-of             select = "Person/PersonNameInformation/
                                           GivenName"/>&#xa0;
      <xsl:variable               name = "personref"
                                select = "Person/@cdr:ref"/>
      <xsl:variable               name = "FragPersonRef" 
                                select = "substring-after($personref,'#')"/>
      <xsl:text>[</xsl:text>
      <xsl:value-of             select = "$FragPersonRef"/>
      <xsl:text>]</xsl:text>
      <xsl:apply-templates      select = "../@Public"/>
     </td>
    </tr>
   </table>

   <xsl:for-each                select = "../PersonRole">
    <table      xsl:use-attribute-sets = "table">
     <tr>
      <td       xsl:use-attribute-sets = "cell1of2">
       <xsl:if                    test = "not(preceding-sibling::PersonRole)">
        <b>Role</b>
       </xsl:if>
      </td>
      <td       xsl:use-attribute-sets = "cell2of2">
       <xsl:value-of            select = "."/>
      </td>
     </tr>
    </table>
   </xsl:for-each>

   <table       xsl:use-attribute-sets = "table">
    <tr>
     <td        xsl:use-attribute-sets = "cell1of2">
      <b>Organization Name</b>
     </td>           
     <td        xsl:use-attribute-sets = "cell2of2">
      <xsl:value-of             select = "Person/PersonLocations/
                                          OtherPracticeLocation
                                            [@cdr:id=$OrgFrag]/
                                          OrganizationLocation/
                                          Organization/
                                          OrganizationNameInformation/
                                          OfficialName/Name"/>
     </td>
    </tr>
   </table>

   <table       xsl:use-attribute-sets = "table">
    <tr>
     <td        xsl:use-attribute-sets = "cell1of2">
      <b>Contact</b>
     </td>
    </tr>
   </table>

   <!-- 
   Display ProtocolSpecificContact Information using special color
   =============================================================== -->
   <xsl:if                        test = "../ProtocolSpecificContact">
    <xsl:for-each               select = "../ProtocolSpecificContact/
                                             PostalAddress">  
     <xsl:for-each              select = "Street">     
      <table    xsl:use-attribute-sets = "table">
       <tr> 
        <td     xsl:use-attribute-sets = "cell1iof2">
        </td>
        <td     xsl:use-attribute-sets = "cell2iof2">
         <xsl:if                  test = "not(preceding-sibling::Street)">
          <b class="native">Street</b>
         </xsl:if>
        </td>
       
        <td     xsl:use-attribute-sets = "cell2of2">
         <p class="native">
          <xsl:value-of          select = "."/>
         </p>
        </td>
       </tr>
      </table> 
     </xsl:for-each> 
    </xsl:for-each>

    <xsl:for-each               select = "../ProtocolSpecificContact/
                                            PostalAddress">   
     <table     xsl:use-attribute-sets = "table">
      <tr>
       <td      xsl:use-attribute-sets = "cell1iof2">
       </td>
       <td      xsl:use-attribute-sets = "cell2iof2">
        <b class="native">City</b>
       </td>
       <td      xsl:use-attribute-sets = "cell2of2">
        <p class="native">
         <xsl:value-of          select = "City"/>
        </p>
       </td>
      </tr>
     </table>

     <xsl:if                      test = "CitySuffix">
      <table    xsl:use-attribute-sets = "table">                     
       <tr>
        <td     xsl:use-attribute-sets = "cell1iof2">
        </td>
        <td     xsl:use-attribute-sets = "cell2iof2">
         <b class="native">City Suffix</b>
        </td>
        <td     xsl:use-attribute-sets = "cell2of2">
         <p class="native">
          <xsl:value-of          select = "CitySuffix"/>
         </p>
        </td>
       </tr>
      </table>
     </xsl:if>

     <table     xsl:use-attribute-sets = "table">                       
      <tr>
       <td      xsl:use-attribute-sets = "cell1iof2">
       </td>
       <td      xsl:use-attribute-sets = "cell2iof2">
        <b class="native">State/Political Unit</b>
       </td>
       <td      xsl:use-attribute-sets = "cell2of2">
        <p class="native">
         <xsl:value-of          select = "PoliticalSubUnit_State/
                                          PoliticalSubUnitFullName"/>
        </p>
       </td>
      </tr>
     </table>
 
     <table     xsl:use-attribute-sets = "table"> 
      <tr>   
       <td      xsl:use-attribute-sets = "cell1iof2">
       </td>
       <td      xsl:use-attribute-sets = "cell2iof2">
        <b class="native">Country</b>
       </td>
       <td      xsl:use-attribute-sets = "cell2of2">
        <p class="native">
         <xsl:value-of          select = "Country/
                                          CountryFullName"/>
        </p>
       </td>
      </tr>
     </table>

     <table     xsl:use-attribute-sets = "table"> 
      <tr>  
       <td      xsl:use-attribute-sets = "cell1iof2">
       </td>
       <td      xsl:use-attribute-sets = "cell2iof2">
        <b class="native">Zip/Postal Code</b>
       </td>
       <td      xsl:use-attribute-sets = "cell2of2">
        <p class="native">
         <xsl:value-of           select = "PostalCode_ZIP"/> 
        </p>
       </td>
      </tr>
     </table>
    </xsl:for-each>
   </xsl:if>
  
   <!-- 
   Display Person Information using normal font-type 
   =============================================================== -->
   <xsl:if                        test = "Person/PersonLocations/
                                          OtherPracticeLocation 
                                            [@cdr:id=$OrgFrag]">      
    <xsl:for-each               select = "Person/PersonLocations/
                                          OtherPracticeLocation  
                                            [@cdr:id=$OrgFrag]/
                                          SpecificPostalAddress"> 
     <xsl:if                      test = "not(../../../../../
                                          ProtocolSpecificContact)">
      <xsl:for-each             select = "Street">  
       <table   xsl:use-attribute-sets = "table">
        <tr> 
         <td    xsl:use-attribute-sets = "cell1iof2">
         </td>
         <td    xsl:use-attribute-sets = "cell2iof2">
          <xsl:if                 test = "not(preceding-sibling::Street)">
           <b>Street</b>
          </xsl:if>
         </td>
         <td    xsl:use-attribute-sets = "cell2of2">
          <xsl:value-of         select = "."/>
         </td>
        </tr>
       </table> 
      </xsl:for-each> 
     </xsl:if>
    </xsl:for-each>
      
    <xsl:for-each               select = "Person/PersonLocations/
                                          OtherPracticeLocation  
                                            [@cdr:id=$OrgFrag]/
                                          SpecificPostalAddress">
     <xsl:if                      test = "not(../../../../../
                                          ProtocolSpecificContact)">
      <table    xsl:use-attribute-sets = "table">
       <tr>
        <td     xsl:use-attribute-sets = "cell1iof2">
        </td>
        <td     xsl:use-attribute-sets = "cell2iof2">
         <b>City</b>
        </td>
        <td     xsl:use-attribute-sets = "cell2of2">
         <xsl:value-of          select = "City"/>
        </td>
       </tr>
      </table>
      <xsl:if                     test = "CitySuffix">
       <table   xsl:use-attribute-sets = "table">                     
        <tr>
         <td    xsl:use-attribute-sets = "cell1iof2">
         </td>
         <td    xsl:use-attribute-sets = "cell2iof2">
          <b>City Suffix</b>
         </td>
         <td    xsl:use-attribute-sets = "cell2of2">
          <xsl:value-of         select = "CitySuffix"/>
         </td>
        </tr>
       </table>
      </xsl:if>

      <table    xsl:use-attribute-sets = "table">                       
       <tr>
        <td     xsl:use-attribute-sets = "cell1iof2">
        </td>
        <td     xsl:use-attribute-sets = "cell2iof2">
         <b>State/Political Unit</b>
        </td>
        <td     xsl:use-attribute-sets = "cell2of2">
         <xsl:value-of          select = "PoliticalSubUnit_State/
                                          PoliticalSubUnitFullName"/>
        </td>
       </tr>
      </table>
 
      <table    xsl:use-attribute-sets = "table"> 
       <tr>   
        <td     xsl:use-attribute-sets = "cell1iof2">
        </td>
        <td     xsl:use-attribute-sets = "cell2iof2">
         <b>Country</b>
        </td>
        <td     xsl:use-attribute-sets = "cell2of2">
         <xsl:value-of          select = "Country/
                                          CountryFullName"/>
        </td>
       </tr>
      </table>

      <table    xsl:use-attribute-sets = "table"> 
       <tr>  
        <td     xsl:use-attribute-sets = "cell1iof2">
        </td>
        <td     xsl:use-attribute-sets = "cell2iof2">
         <b>Zip/Postal Code</b>
        </td>
        <td     xsl:use-attribute-sets = "cell2of2">
         <xsl:value-of          select = "PostalCode_ZIP"/>
        </td>
       </tr>
      </table>
     </xsl:if>

     <table     xsl:use-attribute-sets = "table"> 
      <tr>     
       <td      xsl:use-attribute-sets = "cell1iof2">
       </td>
       <td      xsl:use-attribute-sets = "cell2iof2">
        <xsl:choose>
         <xsl:when                test = "../../../../../
                                           ProtocolSpecificContact/Phone">
          <b class="native">Phone-Fix Me</b>
         </xsl:when>
         <xsl:when                test = "../SpecificPhone">
          <b>Phone</b>
         </xsl:when>
         <xsl:when                test = "../OrganizationLocation/Organization/
                                          OrganizationLocations/
                                          OrganizationLocation/Location/Phone">
          <i>
           <b>Phone</b>
          </i>
         </xsl:when>
         <xsl:otherwise>
          <b>Phone</b>
         </xsl:otherwise>
        </xsl:choose>
       </td>
       <td      xsl:use-attribute-sets = "cell2of2">
       <xsl:choose>
        <xsl:when                 test = "not(../../../../../
                                              ProtocolSpecificContact/
                                              Phone)">
         <xsl:choose>
          <xsl:when               test = "../SpecificPhone">
           <xsl:value-of        select = "../SpecificPhone"/>
           <xsl:apply-templates select = "../SpecificPhone/@Public"/>
          </xsl:when>
          <xsl:otherwise> 
           <xsl:if                test = "../OrganizationLocation/
                                          Organization/OrganizationLocations/
                                          OrganizationLocation/Location/Phone">
            <i>
             <xsl:value-of      select = "../OrganizationLocation/
                                          Organization/OrganizationLocations/
                                          OrganizationLocation/Location/Phone"/>
                                                            
            </i>
            <xsl:apply-templates select = "../OrganizationLocation/Organization/
                                          OrganizationLocations/
                                          OrganizationLocation/
                                          Location/Phone/@Public"/>
           </xsl:if>
          </xsl:otherwise>
         </xsl:choose>
        </xsl:when>
        <xsl:when                 test = "../../../../../
                                          ProtocolSpecificContact/
                                          Phone">
         <xsl:value-of          select = "../../../../../
                                          ProtocolSpecificContact/
                                          Phone"/>
   
         <xsl:apply-templates   select = "../../../../../
                                          ProtocolSpecificContact/
                                          Phone/@Public"/>
        </xsl:when>
    <!--  <xsl:when              test  = "../OrganizationLocation/
                                          Organization/OrganizationLocations/
                                          OrganizationLocation/
                                          Location/Phone">
   <i>
   <xsl:value-of                select = "../OrganizationLocation/
                                          Organization/OrganizationLocations/
                                          OrganizationLocation/
                                          Location/Phone"/>
                                                            
    </i>
   <xsl:apply-templates         select = "../OrganizationLocation/Organization/
                                          OrganizationLocations/
                                          OrganizationLocation/
                                          Location/Phone/@Public"/>
    </xsl:when>-->
       </xsl:choose>
      </td>
     </tr>
    </table>

    <table      xsl:use-attribute-sets = "table"> 
     <tr> 
      <td       xsl:use-attribute-sets = "cell1iof2">
      </td>
      <td       xsl:use-attribute-sets = "cell2iof2">
       <xsl:choose>
        <xsl:when                 test = "../../../../../
                                          ProtocolSpecificContact/
                                          TollFreePhone | 
                                          ../SpecificTollFreePhone">
         <b>
          <xsl:text>Toll Free Phone</xsl:text>
         </b>
        </xsl:when>
        <xsl:when                 test = "../OrganizationLocation/Organization/
                                          OrganizationLocations/
                                          OrganizationLocation/
                                          Location/TollFreePhone">
         <i>
          <b>
           <xsl:text>Toll Free Phone</xsl:text>
          </b>
         </i>
        </xsl:when>
        <xsl:otherwise>
         <b>
          <xsl:text>Toll Free Phone</xsl:text>
         </b>
        </xsl:otherwise>
       </xsl:choose>
      </td>
      <td       xsl:use-attribute-sets = "cell2of2">
       <xsl:choose>
        <xsl:when                 test = "not(../../../../../
                                          ProtocolSpecificContact/
                                          TollFreePhone)">
         <xsl:choose>
          <xsl:when               test = "../SpecificTollFreePhone">
           <xsl:value-of        select = "../SpecificTollFreePhone"/>
          </xsl:when>
          <xsl:when               test = "../OrganizationLocation/Organization/
                                          OrganizationLocations/
                                          OrganizationLocation/
                                          Location/TollFreePhone">
           <i>
            <xsl:value-of       select = "../OrganizationLocation/Organization/
                                          OrganizationLocations/
                                          OrganizationLocation/
                                          Location/TollFreePhone"/>
           </i>
          </xsl:when>
         </xsl:choose>
        </xsl:when>
        <xsl:when                 test = "../../../../../
                                          ProtocolSpecificContact/
                                          TollFreePhone">
         <xsl:value-of          select = "../../../../../
                                          ProtocolSpecificContact/
                                          TollFreePhone"/>
        </xsl:when>
       </xsl:choose>
      </td>
     </tr>
    </table>
  
   <table       xsl:use-attribute-sets = "table"> 
    <tr>
     <td        xsl:use-attribute-sets = "cell1iof2">
     </td>
     <td        xsl:use-attribute-sets = "cell2iof2">
      <xsl:choose>
       <xsl:when                  test = "../SpecificFax | 
                                          ../../../../../
                                          ProtocolSpecificContact/
                                          Fax">
        <b>
         <xsl:text>Fax</xsl:text>
        </b>
       </xsl:when>
       <xsl:when                  test = "../OrganizationLocation/Organization/
                                          OrganizationLocations/
                                          OrganizationLocation/
                                          Location/Fax">
        <i>
         <b>
          <xsl:text>Fax</xsl:text>
         </b>
        </i>
       </xsl:when>
       <xsl:otherwise>
        <b>Fax</b>
       </xsl:otherwise>
      </xsl:choose> 
     </td>
     <td        xsl:use-attribute-sets = "cell2of2">
      <xsl:choose>
       <xsl:when                  test = "not(
                                          ../../../../../
                                          ProtocolSpecificContact/
                                          Fax)">
        <xsl:choose>
         <xsl:when                test = "../SpecificFax">
          <xsl:value-of         select = "../SpecificFax"/>
         </xsl:when>
         <xsl:otherwise>
          <xsl:if                 test = "../OrganizationLocation/Organization/
                                          OrganizationLocations/
                                          OrganizationLocation/
                                          Location/Fax">
           <i>
            <xsl:value-of       select = "../OrganizationLocation/Organization/
                                          OrganizationLocations/
                                          OrganizationLocation/
                                          Location/Fax"/>
           </i>
          </xsl:if>
         </xsl:otherwise>
        </xsl:choose>
       </xsl:when>
       <xsl:when                  test = "../../../../../
                                          ProtocolSpecificContact/
                                          Fax">
        <xsl:value-of           select = "../../../../../
                                          ProtocolSpecificContact/
                                          Fax"/>
                             
       </xsl:when>
   <!--<xsl:when                  test = "../OrganizationLocation/Organization/
                                          OrganizationLocations/
                                          OrganizationLocation/
                                          Location/Fax>

   <i>
   <xsl:value-of                select = "../OrganizationLocation/Organization/
                                          OrganizationLocations/
                                          OrganizationLocation/
                                          Location/Fax"/>

   </i>
   </xsl:when>-->
      </xsl:choose>
     </td>
    </tr>
   </table>

   <table       xsl:use-attribute-sets = "table"> 
    <tr>  
     <td        xsl:use-attribute-sets = "cell1iof2">
     </td>
     <td        xsl:use-attribute-sets = "cell2iof2">
      <b>Email</b>
     </td>
     <td        xsl:use-attribute-sets = "cell2of2">
      <xsl:choose>
       <xsl:when                  test = "../../../../../
                                          ProtocolSpecificContact/
                                          Email">
        <xsl:element              name = "a">
         <xsl:attribute           name = "href">
          <xsl:value-of         select = "concat('mailto:',
                                          ../../../../../
                                          ProtocolSpecificContact/
                                          Email)"/>
         </xsl:attribute>
         <xsl:value-of          select = "../../../../../
                                          ProtocolSpecificContact/
                                          Email"/>
        </xsl:element>
        <xsl:apply-templates    select = "../../../../../
                                          ProtocolSpecificContact/
                                          Email/@Public"/>
       </xsl:when>
       <xsl:otherwise>
        <xsl:element name="a">
         <xsl:attribute name="href">
          <xsl:value-of         select = "concat('mailto:',../SpecificEmail)"/>
         </xsl:attribute>
         <xsl:value-of          select = "../SpecificEmail"/>
        </xsl:element>
        <xsl:apply-templates    select = "../SpecificEmail/@Public"/>
       </xsl:otherwise>
      </xsl:choose>
     </td>
    </tr>
   </table> 

   <table       xsl:use-attribute-sets = "table"> 
    <tr>  
     <td        xsl:use-attribute-sets = "cell1iof2">
     </td>
     <td        xsl:use-attribute-sets = "cell2iof2">
      <b>Web Site</b>
     </td>
     <td        xsl:use-attribute-sets = "cell2of2">
      <xsl:choose>
       <xsl:when                  test = "not(../../../../../
                                          ProtocolSpecificContact/
                                          WebSite)">
        <xsl:element              name = "a">
         <xsl:attribute           name = "href">
          <xsl:choose>
           <xsl:when              test = "contains(../
                                            SpecificWebSite/@cdr:xref,'http')">
            <xsl:value-of       select = "../SpecificWebSite/@cdr:xref"/>
           </xsl:when>
           <xsl:otherwise>
            <xsl:value-of       select = "concat('http://',../SpecificWebSite/
                                            @cdr:xref)"/>
           </xsl:otherwise>
          </xsl:choose>
         </xsl:attribute>
         <xsl:attribute           name = "target">
          <xsl:text>new</xsl:text>
         </xsl:attribute>
         <xsl:value-of          select = "../SpecificWebsite/@cdr:xref"/>
        </xsl:element>
        <br />
        <xsl:value-of           select = "../SpecificWebsite"/>
       </xsl:when>
       <xsl:when                  test = "../../../../../
                                          ProtocolSpecificContact/
                                          WebSite">
        <xsl:element              name = "a">
         <xsl:attribute           name = "href">
          <xsl:choose>
           <xsl:when              test = "contains(../../../../../
                                          ProtocolSpecificContact/
                                          WebSite/@cdr:xref,'http')">
                             
            <xsl:value-of       select = "../../../../../
                                          ProtocolSpecificContact/
                                          WebSite/@cdr:xref"/>
           </xsl:when>
           <xsl:otherwise>
            <xsl:value-of       select = "concat('http://',../../../../../
                                          ProtocolSpecificContact/WebSite/
                                          @cdr:xref)"/>
   
           </xsl:otherwise>
          </xsl:choose>
         </xsl:attribute>
         <xsl:attribute           name = "target">
          <xsl:text>new</xsl:text>
         </xsl:attribute> 
         <xsl:value-of          select = "../../../../../
                                          ProtocolSpecificContact/
                                          WebSite/@cdr:xref"/>
        </xsl:element>
        <br />
        <xsl:value-of           select = "../../../../../
                                          ProtocolSpecificContact/
                                          WebSite"/>
       </xsl:when>
       <xsl:otherwise>
        <xsl:if                   test = "../OrganizationLocation/Organization/
                                          OrganizationLocations/
                                          OrganizationLocation/
                                          Location/WebSite">
         <xsl:element             name = "a">
          <xsl:attribute          name = "href">
           <xsl:choose>
            <xsl:when             test = "contains(../OrganizationLocation/
                                             Organization/
                                             OrganizationLocations/
                                             OrganizationLocation/
                                             Location/
                                             WebSite/@cdr:xref,'http')">
             <xsl:value-of      select = "../OrganizationLocation/Organization/
                                          OrganizationLocations/
                                          OrganizationLocation/
                                          Location/WebSite/@cdr:xref"/>
            </xsl:when>  
            <xsl:otherwise>
             <xsl:value-of      select = "concat('http://',
                                                  ../OrganizationLocation/
                                                  Organization/
                                                  OrganizationLocations/
                                                  OrganizationLocation/
                                                  Location/WebSite/
                                                  @cdr:xref)"/>
            </xsl:otherwise>
           </xsl:choose>
          </xsl:attribute>
          <xsl:attribute          name = "target">
           <xsl:text>new</xsl:text>
          </xsl:attribute>
          <i>
           <xsl:value-of        select = "../OrganizationLocation/Organization/
                                          OrganizationLocations/
                                          OrganizationLocation/
                                          Location/WebSite/
                                          @cdr:xref"/>
          </i>
         </xsl:element>  
         <br />
         <i>
          <xsl:value-of         select = "../OrganizationLocation/Organization/
                                          OrganizationLocations/
                                          OrganizationLocation/
                                          Location/WebSite"/>
         </i>  
        </xsl:if>
       </xsl:otherwise>
      </xsl:choose>
      <br/>
     </td>
    </tr>
   </table>
  </xsl:for-each>
 </xsl:if>
    
 <xsl:if             test="not(Person/PersonLocations/
                            OtherPracticeLocation[@cdr:id=$OrgFrag]/
                            SpecificPostalAddress)">
                         
   <table       xsl:use-attribute-sets = "table">                       
   <xsl:for-each       select="Person/PersonLocations/
                              OtherPracticeLocation[@cdr:id=$OrgFrag]     
                              /OrganizationLocation/
                              Organization/OrganizationLocations/
                              OrganizationLocation/Location/
                              PostalAddress/Street">
    <xsl:if            test = "not(../../../../../../../../../../../ProtocolSpecificContact/PostalAddress)">
     <xsl:variable name="OrgRef"  select="../../../../../@cdr:ref"/>
    <xsl:variable   name="OrgID"  select="substring-after($OrgRef,'#')"/>
    <xsl:if        test = "$OrgFrag =../../@cdr:id or $OrgID = ../../@cdr:id">
  

   <tr>
    <td     xsl:use-attribute-sets = "cell1iof2">
    </td>
    <td     xsl:use-attribute-sets = "cell2iof2">
      <xsl:if test="not(preceding-sibling::Street)">
      <i>
      <b>Street</b>
      </i>
      </xsl:if>
      </td>
     <td     xsl:use-attribute-sets = "cell2of2">
  <i>
 <xsl:value-of        select="."/>
  </i>
  </td>
  </tr>
  </xsl:if>
  </xsl:if> 
  </xsl:for-each>
  </table>
  <xsl:if            test= "../ProtocolSpecificContact/PostalAddress">
 <!-- <table       xsl:use-attribute-sets = "table">
  <xsl:for-each      select="../ProtocolSpecificContact/PostalAddress/
                             Street">
    <tr>
    <td     xsl:use-attribute-sets = "cell1iof2">
    </td>
    <td     xsl:use-attribute-sets = "cell2iof2">
      <xsl:if test="not(preceding-sibling::Street)">
      <b>Street</b>
      </xsl:if>
      </td>
     <td     xsl:use-attribute-sets = "cell2of2">
    <xsl:value-of        select="."/>
   </td>
   </tr>
   </xsl:for-each>
   </table>-->
   <xsl:for-each        select ="../ProtocolSpecificContact/PostalAddress">
  <!-- <table       xsl:use-attribute-sets = "table">   
   <tr>
    <td     xsl:use-attribute-sets = "cell1iof2">
    </td>
    <td     xsl:use-attribute-sets = "cell2iof2">
   <b>City</b>
   </td>
   <td     xsl:use-attribute-sets = "cell2of2">
   <xsl:value-of        select="City"/>
  </td>
  </tr>
  </table>
 
 
   <xsl:if            test="CitySuffix">
   <table       xsl:use-attribute-sets = "table">                       
   <tr>
    <td     xsl:use-attribute-sets = "cell1iof2">
    </td>
   <td     xsl:use-attribute-sets = "cell2iof2">
   <b>City Suffix</b>
   </td>
   <td     xsl:use-attribute-sets = "cell2of2">
   <xsl:value-of        select="CitySuffix"/>
  </td>
  </tr>
  </table>
  </xsl:if>
 
 
  <table       xsl:use-attribute-sets = "table">                       
    <tr>
    <td     xsl:use-attribute-sets = "cell1iof2">
    </td>
   <td     xsl:use-attribute-sets = "cell2iof2">
   <b>State/Political Unit</b>
   </td>
   <td     xsl:use-attribute-sets = "cell2of2">
    <xsl:value-of        select="PoliticalSubUnit_State/
                                PoliticalSubUnitFullName"/>
    </td>
  </tr>
  </table>
 
   <table       xsl:use-attribute-sets = "table"> 
   <tr>  
    <td     xsl:use-attribute-sets = "cell1iof2">
    </td>
    <td     xsl:use-attribute-sets = "cell2iof2">
   <b>Country</b>
   </td>
   <td     xsl:use-attribute-sets = "cell2of2">
   <xsl:value-of        select="Country/
                                CountryFullName"/>
  </td>
  </tr>
  </table>
   <table       xsl:use-attribute-sets = "table"> 
   <tr> 
    <td     xsl:use-attribute-sets = "cell1iof2">
    </td>
   <td     xsl:use-attribute-sets = "cell2iof2">
   <b>Zip/Postal Code</b>
   </td>
   <td     xsl:use-attribute-sets = "cell2of2">
    <xsl:value-of        select="PostalCode_ZIP"/>
      
  </td>
  </tr>
  </table> stopped here -->
  
   <!--
   Protocol Specific Phone for LeadOrgPersonnel
   ===================================================== -->
   <xsl:choose>
    <xsl:when                     test = "../Phone">
     <table     xsl:use-attribute-sets = "table"> 
      <tr>   
       <td      xsl:use-attribute-sets = "cell1iof2">
       </td>
       <td      xsl:use-attribute-sets = "cell2iof2">
	<b class="native">Phone</b>
       </td>
       <td      xsl:use-attribute-sets = "cell2of2">
        <p class="native">
         <xsl:value-of          select = "../Phone"/>
         <xsl:apply-templates   select = "../Phone/@Public"/>
	</p>
       </td>
      </tr>
     </table>
    </xsl:when>
    <xsl:when                     test = "../../Person/
	                                  Person/PersonLocations/
                                          OtherPracticeLocation
					    [@cdr:id=$OrgFrag]/
                                          SpecificPhone">
     <table     xsl:use-attribute-sets = "table"> 
      <tr>   
       <td      xsl:use-attribute-sets = "cell1iof2">
       </td>
       <td      xsl:use-attribute-sets = "cell2iof2">
	<b>Phone</b>
       </td>
       <td      xsl:use-attribute-sets = "cell2of2">
        <xsl:value-of           select = "../../Person/
	                                  Person/PersonLocations/
					  OtherPracticeLocation
					    [@cdr:id=$OrgFrag]/
					  SpecificPhone"/>
        <xsl:apply-templates    select = "../../Person/
	                                  Person/PersonLocations/
                                          OtherPracticeLocation
					    [@cdr:id=$OrgFrag]/
                                          SpecificPhone/@Public"/>
       </td>
      </tr>
     </table>
    </xsl:when>
    <xsl:when                     test = "../../Person/
	                                  Person/PersonLocations/
                                          OtherPracticeLocation
					    [@cdr:id=$OrgFrag]/
                                          OrganizationLocation/
                                          Organization/OrganizationLocations/
                                          OrganizationLocation/Location/
					  Phone">
     <table     xsl:use-attribute-sets = "table"> 
      <tr>   
       <td      xsl:use-attribute-sets = "cell1iof2">
       </td>
       <td      xsl:use-attribute-sets = "cell2iof2">
	<i>
         <b>Phone</b>
	</i>
       </td>
       <td      xsl:use-attribute-sets = "cell2of2">
        <i>
         <xsl:value-of          select = "../../Person/
	                                  Person/PersonLocations/
					  OtherPracticeLocation
					    [@cdr:id=$OrgFrag]/
                                          OrganizationLocation/
                                          Organization/OrganizationLocations/
                                          OrganizationLocation/Location/
					  Phone"/>
         <xsl:apply-templates   select = "../../Person/
	                                  Person/PersonLocations/
                                          OtherPracticeLocation
					    [@cdr:id=$OrgFrag]/
                                          OrganizationLocation/
                                          Organization/OrganizationLocations/
                                          OrganizationLocation/Location/
					  Phone/@Public"/>
        </i>
       </td>
      </tr>
     </table>
    </xsl:when>
    <xsl:otherwise>
     <table     xsl:use-attribute-sets = "table"> 
      <tr>   
       <td      xsl:use-attribute-sets = "cell1iof2">
       </td>
       <td      xsl:use-attribute-sets = "cell2iof2">
	<b>Phone</b>
       </td>
      </tr>
     </table>
    </xsl:otherwise>
   </xsl:choose>

   <!--
   Protocol Specific Fax for LeadOrgPersonnel
   ===================================================== -->
   <xsl:choose>
    <xsl:when                     test = "../Fax">
     <table     xsl:use-attribute-sets = "table"> 
      <tr>   
       <td      xsl:use-attribute-sets = "cell1iof2">
       </td>
       <td      xsl:use-attribute-sets = "cell2iof2">
        <b class="native">Fax</b>
       </td>
       <td      xsl:use-attribute-sets = "cell2of2">
	<p class="native">
         <xsl:value-of           select = "../Fax"/>
	</p>
       </td>
      </tr>
     </table>
    </xsl:when>
    <xsl:when                     test = "../../Person/
                                          Person/PersonLocations/
                                          OtherPracticeLocation
                                            [@cdr:id=$OrgFrag]/
                                          SpecificFax">
     <table     xsl:use-attribute-sets = "table"> 
      <tr>   
       <td      xsl:use-attribute-sets = "cell1iof2">
       </td>
       <td      xsl:use-attribute-sets = "cell2iof2">
        <b>Fax</b>
       </td>
       <td      xsl:use-attribute-sets = "cell2of2">
        <xsl:value-of           select = "../../Person/
                                          Person/PersonLocations/
                                          OtherPracticeLocation
                                            [@cdr:id=$OrgFrag]/
                                          SpecificFax"/>
       </td>
      </tr>
     </table>
    </xsl:when>
    <xsl:when                     test = "../../Person/
                                          Person/PersonLocations/
                                          OtherPracticeLocation
                                            [@cdr:id=$OrgFrag]/
                                          OrganizationLocation/
                                          Organization/OrganizationLocations/
                                          OrganizationLocation/Location/
                                          Fax">
     <table     xsl:use-attribute-sets = "table"> 
      <tr>   
       <td      xsl:use-attribute-sets = "cell1iof2">
       </td>
       <td      xsl:use-attribute-sets = "cell2iof2">
        <i>
         <b>Fax</b>
        </i>
       </td>
       <td      xsl:use-attribute-sets = "cell2of2">
        <xsl:value-of           select = "../../Person/
                                          Person/PersonLocations/
                                          OtherPracticeLocation
                                            [@cdr:id=$OrgFrag]/     
                                          OrganizationLocation/
                                          Organization/OrganizationLocations/
                                          OrganizationLocation/Location/
                                          Fax"/>
       </td>
      </tr>
     </table>
    </xsl:when>
    <xsl:otherwise>
     <table     xsl:use-attribute-sets = "table"> 
      <tr>   
       <td      xsl:use-attribute-sets = "cell1iof2">
       </td>
       <td      xsl:use-attribute-sets = "cell2iof2">
        <b>Fax</b>
       </td>
      </tr>
     </table>
    </xsl:otherwise>
   </xsl:choose>

   <!--
   Protocol Specific TollFreePhone for LeadOrgPersonnel
   ===================================================== -->
   <xsl:choose>
    <xsl:when                     test = "../TollFreePhone">
     <table     xsl:use-attribute-sets = "table"> 
      <tr>   
       <td      xsl:use-attribute-sets = "cell1iof2">
       </td>
       <td      xsl:use-attribute-sets = "cell2iof2">
        <b class="native">Toll Free Phone</b>
       </td>
       <td      xsl:use-attribute-sets = "cell2of2">
	<p class="native">
         <xsl:value-of           select = "../TollFreePhone"/>
	</p>
       </td>
      </tr>
     </table>
    </xsl:when>
    <xsl:when                     test = "../../Person/
                                          Person/PersonLocations/
                                          OtherPracticeLocation
                                            [@cdr:id=$OrgFrag]/
                                          SpecificTollFreePhone">
     <table     xsl:use-attribute-sets = "table"> 
      <tr>   
       <td      xsl:use-attribute-sets = "cell1iof2">
       </td>
       <td      xsl:use-attribute-sets = "cell2iof2">
        <b>Toll Free Phone</b>
       </td>
       <td      xsl:use-attribute-sets = "cell2of2">
        <xsl:value-of           select = "../../Person/
                                          Person/PersonLocations/
                                          OtherPracticeLocation
                                            [@cdr:id=$OrgFrag]/
                                          SpecificTollFreePhone"/>
       </td>
      </tr>
     </table>
    </xsl:when>
    <xsl:when                     test = "../../Person/
                                          Person/PersonLocations/
                                          OtherPracticeLocation
                                            [@cdr:id=$OrgFrag]/
                                          OrganizationLocation/
                                          Organization/OrganizationLocations/
                                          OrganizationLocation/Location/
                                          TollFreePhone">
     <table     xsl:use-attribute-sets = "table"> 
      <tr>   
       <td      xsl:use-attribute-sets = "cell1iof2">
       </td>
       <td      xsl:use-attribute-sets = "cell2iof2">
        <i>
         <b>Toll Free Phone</b>
        </i>
       </td>
       <td      xsl:use-attribute-sets = "cell2of2">
        <xsl:value-of           select = "../../Person/
                                          Person/PersonLocations/
                                          OtherPracticeLocation
                                            [@cdr:id=$OrgFrag]/     
                                          OrganizationLocation/
                                          Organization/OrganizationLocations/
                                          OrganizationLocation/Location/
                                          TollFreePhone"/>
       </td>
      </tr>
     </table>
    </xsl:when>
    <xsl:otherwise>
     <table     xsl:use-attribute-sets = "table"> 
      <tr>   
       <td      xsl:use-attribute-sets = "cell1iof2">
       </td>
       <td      xsl:use-attribute-sets = "cell2iof2">
        <b>Toll Free Phone</b>
       </td>
      </tr>
     </table>
    </xsl:otherwise>
   </xsl:choose>


   <!--
   Protocol Specific Email for LeadOrgPersonnel
   ===================================================== -->
   <xsl:choose>
   <xsl:when                      test = "../Email">  
    <table      xsl:use-attribute-sets = "table">
     <tr>   
      <td       xsl:use-attribute-sets = "cell1iof2">
      </td>
      <td       xsl:use-attribute-sets = "cell2iof2">
       <b class="native">Email</b>
      </td>
      <td       xsl:use-attribute-sets = "cell2of2">
       <xsl:element               name = "a">
        <xsl:attribute            name = "href">
         <xsl:value-of          select = "concat('mailto:',../Email)"/>
        </xsl:attribute>
        <p class="native">
         <xsl:value-of           select = "../Email"/>
        </p>
       </xsl:element>
       <xsl:apply-templates     select = "../Email/@Public"/>
      </td>
     </tr>
    </table>
   </xsl:when>
   <xsl:when                      test = "../../Person/Person/PersonLocations/
                                          OtherPracticeLocation
                                            [@cdr:id=$OrgFrag]/
                                          SpecificEmail">
    <table      xsl:use-attribute-sets = "table">
     <tr>   
      <td       xsl:use-attribute-sets = "cell1iof2">
      </td>
      <td       xsl:use-attribute-sets = "cell2iof2">
       <b>Email</b>
      </td>
      <td       xsl:use-attribute-sets = "cell2of2">
       <xsl:element               name = "a">
        <xsl:attribute            name = "href">
         <xsl:value-of          select = "concat('mailto:',../../Person/
                                                Person/PersonLocations/
                                                OtherPracticeLocation
                                                  [@cdr:id=$OrgFrag]/
                                                SpecificEmail)"/>
        </xsl:attribute>
        <xsl:value-of           select = "../../Person/
                                          Person/PersonLocations/
                                          OtherPracticeLocation
                                            [@cdr:id=$OrgFrag]/
                                          SpecificEmail"/>
       </xsl:element> 
       <xsl:apply-templates     select = "../../Person/
                                          Person/PersonLocations/
                                          OtherPracticeLocation
                                            [@cdr:id=$OrgFrag]/
                                          SpecificEmail/@Public"/>
      </td>
     </tr>
    </table>
   </xsl:when>
   <xsl:otherwise>
    <td         xsl:use-attribute-sets = "cell2iof2">
     <b>Email</b>
    </td>
   </xsl:otherwise>
   </xsl:choose>
   
   <!--
   Protocol Specific Website for LeadOrgPersonnel
   ===================================================== -->
   <xsl:choose>
    <xsl:when                     test = "../WebSite">
     <table     xsl:use-attribute-sets = "table">
      <tr>   
       <td      xsl:use-attribute-sets = "cell1iof2">
       </td>
       <td      xsl:use-attribute-sets = "cell2iof2">
        <b class="native">Web Site</b>
       </td>
       <td      xsl:use-attribute-sets = "cell2of2">
        <xsl:element              name = "a">
         <xsl:attribute           name = "href">
          <xsl:choose>
           <xsl:when              test = "contains(
                                          ../WebSite/@cdr:xref,'http')">
            <xsl:value-of       select = "../WebSite/@cdr:xref"/>
           </xsl:when>
           <xsl:otherwise>
            <xsl:value-of       select = "concat('http://',
                                          ../WebSite/@cdr:ref)"/>
           </xsl:otherwise>
          </xsl:choose>
         </xsl:attribute>
         <xsl:attribute           name = "target">
          <xsl:text>new</xsl:text>
         </xsl:attribute>
   
         <xsl:value-of          select = "../WebSite/@cdr:xref"/>
        </xsl:element>
	<p class="native">
         <xsl:value-of           select = "../WebSite"/>
	</p>
       </td>
      </tr>
     </table>
    </xsl:when>
    <xsl:when                     test = "../../Person/Person/PersonLocations/
                                          OtherPracticeLocation
                                            [@cdr:id=$OrgFrag]/
                                          SpecificWebSite">
     <table     xsl:use-attribute-sets = "table">
      <tr>   
       <td      xsl:use-attribute-sets = "cell1iof2">
       </td>
       <td      xsl:use-attribute-sets = "cell2iof2">
        <b>Web Site</b>
       </td>
       <td      xsl:use-attribute-sets = "cell2of2">
        <xsl:element              name = "a">
         <xsl:attribute           name = "href">
          <xsl:choose>
           <xsl:when              test = "contains(
                                          ../../Person/
                                          Person/PersonLocations/
                                          OtherPracticeLocation
                                            [@cdr:id=$OrgFrag]/
                                          SpecificWebSite/@cdr:xref,'http')">
            <xsl:value-of       select = "../../Person/
                                          Person/PersonLocations/
                                          OtherPracticeLocation
                                            [@cdr:id=$OrgFrag]/
                                          SpecificWebSite/@cdr:xref"/>
           </xsl:when>
           <xsl:otherwise>
            <xsl:value-of       select = "concat('http://',
                                          ../../Person/
                                          Person/PersonLocations/
                                          OtherPracticeLocation
                                            [@cdr:id=$OrgFrag]/
                                          SpecificWebSite/@cdr:ref)"/>
           </xsl:otherwise>
          </xsl:choose>
         </xsl:attribute>
         <xsl:attribute           name = "target">
          <xsl:text>new</xsl:text>
         </xsl:attribute>
   
         <xsl:value-of          select = "../../Person/
                                          Person/PersonLocations/
                                          OtherPracticeLocation
                                            [@cdr:id=$OrgFrag]/
                                          SpecificWebSite/@cdr:xref"/>
        </xsl:element>
        <br />
        <xsl:value-of           select = "../../Person/
                                          Person/PersonLocations/
                                          OtherPracticeLocation
                                            [@cdr:id=$OrgFrag]/
                                          SpecificWebSite"/>
       </td>
      </tr>
     </table>
    </xsl:when>
    <xsl:when                     test = "../../Person/
                                          Person/PersonLocations/
                                          OtherPracticeLocation
                                            [@cdr:id=$OrgFrag]/     
                                          OrganizationLocation/
                                          Organization/OrganizationLocations/
                                          OrganizationLocation/Location/
                                          WebSite">
     <table     xsl:use-attribute-sets = "table">
      <tr>   
       <td      xsl:use-attribute-sets = "cell1iof2">
       </td>
       <td      xsl:use-attribute-sets = "cell2iof2">
        <i>
         <b>Web Site</b>
        </i>
       </td>
       <td      xsl:use-attribute-sets = "cell2of2">
        <xsl:element              name = "a">
         <xsl:attribute           name = "href">
          <xsl:choose>
           <xsl:when              test = "contains(
                                          ../../Person/
                                          Person/PersonLocations/
                                          OtherPracticeLocation
                                            [@cdr:id=$OrgFrag]/
                                          OrganizationLocation/
                                          Organization/OrganizationLocations/
                                          OrganizationLocation/Location/
                                          WebSite/@cdr:xref, 'http')">
            <xsl:value-of      select = "../../Person/
                                         Person/PersonLocations/
                                         OtherPracticeLocation
                                           [@cdr:id=$OrgFrag]/
                                         OrganizationLocation/
                                         Organization/OrganizationLocations/
                                         OrganizationLocation/Location/
                                         WebSite/@cdr:xref"/>
           </xsl:when>
           <xsl:otherwise>
            <xsl:value-of      select = "concat('http://',
                                         ../../Person/
                                         Person/PersonLocations/
                                         OtherPracticeLocation
                                           [@cdr:id=$OrgFrag]/
                                         OrganizationLocation/
                                         Organization/OrganizationLocations/
                                         OrganizationLocation/Location/
                                         WebSite/@cdr:xref)"/>
           </xsl:otherwise>
          </xsl:choose>
         </xsl:attribute>
         <xsl:attribute           name = "target">
          <xsl:text>new</xsl:text>
         </xsl:attribute>
   
         <xsl:value-of          select = "../../Person/
                                          Person/PersonLocations/
                                          OtherPracticeLocation
                                            [@cdr:id=$OrgFrag]/
                                          OrganizationLocation/
                                          Organization/OrganizationLocations/
                                          OrganizationLocation/Location/
                                          WebSite/@cdr:xref"/>
        </xsl:element>
        <br />
        <xsl:value-of           select = "../../Person/
                                          Person/PersonLocations/
                                          OtherPracticeLocation
                                            [@cdr:id=$OrgFrag]/
                                          OrganizationLocation/
                                          Organization/OrganizationLocations/
                                          OrganizationLocation/Location/
                                          WebSite/@cdr:xref"/>
       </td>
      </tr>
     </table>
    </xsl:when>
    <xsl:otherwise>
     <td        xsl:use-attribute-sets = "cell2iof2">
      <b>Web Site</b>
     </td>
    </xsl:otherwise>
   </xsl:choose>

   </xsl:for-each>
   </xsl:if>
                     
   <xsl:for-each       select="Person/PersonLocations/
                              OtherPracticeLocation[@cdr:id=$OrgFrag]     
                              /OrganizationLocation/
                              Organization/OrganizationLocations/
                              OrganizationLocation/Location/
                              PostalAddress">
   <xsl:if            test = "not(../../../../../../../../../../
                             ProtocolSpecificContact/PostalAddress)">
                                
   <xsl:variable name="OrgRef"  select="../../../../@cdr:ref"/>
   <xsl:variable   name="OrgID"  select="substring-after($OrgRef,'#')"/>
   <xsl:if        test = "$OrgFrag =../@cdr:id or $OrgID = ../@cdr:id">
                 

   <table xsl:use-attribute-sets = "table">
   <tr>
    <td     xsl:use-attribute-sets = "cell1iof2">
    </td>
   <td     xsl:use-attribute-sets = "cell2iof2">
   <i><b>City</b></i>
   </td>
   <td     xsl:use-attribute-sets = "cell2of2">
  <i>
 <xsl:value-of        select="City"/>
  </i>
  </td>
  </tr>
  </table>
 
 
   <xsl:if            test="CitySuffix">
   <table xsl:use-attribute-sets = "table">
   <tr>
    <td     xsl:use-attribute-sets = "cell1iof2">
    </td>
   <td     xsl:use-attribute-sets = "cell2iof2">
   <i><b>City Suffix</b></i>
   </td>
   <td     xsl:use-attribute-sets = "cell2of2">
   <i>
  <xsl:value-of        select="CitySuffix"/>
  </i>
  </td>
  </tr>
  </table>
  </xsl:if>
 
 
  <table xsl:use-attribute-sets = "table">
    <tr>
    <td     xsl:use-attribute-sets = "cell1iof2">
    </td>
   <td     xsl:use-attribute-sets = "cell2iof2">
   <i><b>State/Political Unit</b></i>
   </td>
   <td     xsl:use-attribute-sets = "cell2of2">
   <i>
   <xsl:value-of        select="PoliticalSubUnit_State/
                                PoliticalSubUnitFullName"/>
  </i>
  </td>
  </tr>
  </table>
 
   <table xsl:use-attribute-sets = "table">
   <tr>  
    <td     xsl:use-attribute-sets = "cell1iof2">
    </td>
    <td     xsl:use-attribute-sets = "cell2iof2">
   <i><b>Country</b></i>
   </td>
   <td     xsl:use-attribute-sets = "cell2of2">
   <i>
   <xsl:value-of        select="Country/
                                CountryFullName"/>
   </i>
   </td>
  </tr>
  </table>
   <table xsl:use-attribute-sets = "table">
   <tr> 
    <td     xsl:use-attribute-sets = "cell1iof2">
    </td>
   <td     xsl:use-attribute-sets = "cell2iof2">
    <i>
   <b>Zip/Postal Code</b>
   </i>
   </td>
   <td     xsl:use-attribute-sets = "cell2of2">
    <i>
   <xsl:value-of        select="PostalCode_ZIP"/>
    </i>    
  </td>
  </tr>
  </table>
  
  </xsl:if> 
    
  <xsl:if              test="not(../../../../../../../../../../ProtocolSpecificContact/Phone)">
   <table xsl:use-attribute-sets = "table">
   <tr>   
    <td     xsl:use-attribute-sets = "cell1iof2">
    </td>
    <td     xsl:use-attribute-sets = "cell2iof2">
    <xsl:choose>
    <xsl:when       test ="../../../../../../SpecificPhone |
                           ../../../../../../../../../../
                           ProtocolSpecificContact/Phone">
    <b>Phone</b>
    </xsl:when>
    <xsl:otherwise>
    <i>
    <b>Phone</b>
    </i>
    </xsl:otherwise>
    </xsl:choose>

   </td>
    <td     xsl:use-attribute-sets = "cell2of2">
    <xsl:value-of  select="../../../../../../SpecificPhone"/>
   <xsl:apply-templates select = "../../../../../../SpecificPhone/@Public"/>
    <xsl:if  test="not(../../../../../../SpecificPhone)">
    <i>
    <xsl:value-of  select="../Phone"/>
    </i>
    </xsl:if>
    </td>
    </tr>
    </table>
    </xsl:if>
   <!-- adding new phone logic -->
   <xsl:if              test="../../../../../../../../../../ProtocolSpecificContact/Phone">
   <table xsl:use-attribute-sets = "table">
   <tr>   
    <td     xsl:use-attribute-sets = "cell1iof2">
    </td>
    <td     xsl:use-attribute-sets = "cell2iof2">
   <xsl:text>Phone</xsl:text>
   </td>
    <td     xsl:use-attribute-sets = "cell2of2">
   <xsl:value-of  select="../../../../../../../../
                          ../../ProtocolSpecificContact/Phone"/>
     
   <xsl:apply-templates select = "../../../../../../../../../../ProtocolSpecificContact/
               Phone/@Public"/>
   </td>
    </tr>
    </table>
    </xsl:if>
  
  
  
     <xsl:if            test = "not(../../../../../../../../../../../ProtocolSpecificContact/TollFreePhone)">
     
    <table xsl:use-attribute-sets = "table">
   <tr> 
   <td     xsl:use-attribute-sets = "cell1iof2">
   </td>
   <td     xsl:use-attribute-sets = "cell2iof2">
    <b>Toll Free Phone</b>
    <xsl:choose>
    <xsl:when         test="../../../../../../SpecificTollFreePhone |
                            ../../../../../../../../../../
                            ProtocolSpecificContact/TollFreePhone">
                            
   <xsl:text>Toll Free Phone</xsl:text>
   </xsl:when>
   <xsl:otherwise>
   <!-- i am here -->
   <xsl:if          test="../TollFreePhone">
    <i>
    <b>Toll Free Phone</b>
    </i>
    </xsl:if>
    </xsl:otherwise>
    </xsl:choose>
    </td>
   <td     xsl:use-attribute-sets = "cell2of2">
   <xsl:value-of  select="../../../../../../SpecificTollFreePhone"/>
   <xsl:if  test="not(../../../../../../SpecificTollFreePhone)">
   <i><xsl:value-of  select="../TollFreePhone"/>
   </i>
   </xsl:if>
   </td>
   </tr>
   </table>
   </xsl:if>
    <xsl:if              test="../../../../../../../../../../
                               ProtocolSpecificContact/TollFreePhone">
   <table xsl:use-attribute-sets = "table">
   <tr>   
    <td     xsl:use-attribute-sets = "cell1iof2">
    </td>
    <td     xsl:use-attribute-sets = "cell2iof2">
    <b>Toll Free Phone</b>
    </td>
    <td     xsl:use-attribute-sets = "cell2of2">
   <xsl:value-of  select="../../../../../../../../../../ProtocolSpecificContact/TollFreePhone"/>
    </td>
    </tr>
    </table>
    </xsl:if> 
   
    <xsl:if            test = "not(../../../../../../../../../../
                               ProtocolSpecificContact/Fax)">
     
   <table xsl:use-attribute-sets = "table">
   <tr>  
    <td     xsl:use-attribute-sets = "cell1iof2">
    </td>
    <td     xsl:use-attribute-sets = "cell2iof2">
    <xsl:choose>
    <xsl:when       test="../../../../../../SpecificFax |
                          ../../../../../../../../../../
                          ProtocolSpecificContact/Fax">
                          
   <b>Fax</b>
   </xsl:when>
   <xsl:otherwise>
    <i>
    <b>Fax</b>
    </i>
   </xsl:otherwise>
   </xsl:choose>
   </td>
   <td     xsl:use-attribute-sets = "cell2of2">
    <xsl:value-of  select="../../../../../../SpecificFax"/>
    <xsl:if  test="not(../../../../../../SpecificFax)">
    <i>
   <xsl:value-of  select="../Fax"/>
   </i>
    </xsl:if>
   </td>
   </tr>
   </table>
   </xsl:if>
     <xsl:if            test = "../../../../../../../../../../
                               ProtocolSpecificContact/Fax">
     
   <table xsl:use-attribute-sets = "table">
   <tr>  
    <td     xsl:use-attribute-sets = "cell1iof2">
    </td>
    <td     xsl:use-attribute-sets = "cell2iof2">
   <b>Fax</b>
   </td>
   <td     xsl:use-attribute-sets = "cell2of2">
   <xsl:value-of       select="../../../../../../../../../../
                               ProtocolSpecificContact/Fax"/>
   </td>
   </tr>
   </table>
   </xsl:if>
    
    <xsl:if            test = "not(../../../../../../../../../../..
                               /ProtocolSpecificContact/Email)">
     
   <table xsl:use-attribute-sets = "table">
   <tr>  
    <td     xsl:use-attribute-sets = "cell1iof2">
    </td>
   <td     xsl:use-attribute-sets = "cell2iof2">
   <b>Email</b>
   </td>
   <td     xsl:use-attribute-sets = "cell2of2">
   <xsl:element name="a">
   <xsl:attribute name="href">
   <xsl:value-of  select="concat('mailto:',../../../../../../SpecificEmail)"/>
   </xsl:attribute>
   <xsl:value-of  select="../../../../../../SpecificEmail"/>
   </xsl:element> 
   <xsl:apply-templates select = "../../../../../../SpecificEmail/@Public"/>
   </td>
   </tr>
   </table>
   </xsl:if>
   <xsl:if            test = "../../../../../../../../../../
                                ProtocolSpecificContact/Email">
     
   <table xsl:use-attribute-sets = "table">
   <tr>  
    <td     xsl:use-attribute-sets = "cell1iof2">
    </td>
   <td     xsl:use-attribute-sets = "cell2iof2">
   <b>Email</b>
   </td>
   <td     xsl:use-attribute-sets = "cell2of2">
   <xsl:element name="a">
   <xsl:attribute name="href">
   <xsl:value-of  select="concat('mailto:',../../../../../../../../../..
                          ProtocolSpecificContact/Email)"/>
   </xsl:attribute>
   <xsl:value-of     select="../../../../../../../../../../
                            ProtocolSpecificContact/Email"/>
   </xsl:element> 
   <xsl:apply-templates select = "../../../../../../../../../../
                 ProtocolSpecificContact/Email/@Public"/>
   </td>
   </tr>
   </table>
   </xsl:if>
    
      
   <table xsl:use-attribute-sets = "table">
   <tr>   
    <td     xsl:use-attribute-sets = "cell1iof2">
   </td>
   <td     xsl:use-attribute-sets = "cell2iof2">
   <xsl:choose>
   <xsl:when     test ="../../../../../../SpecificWebSite">
   <b>Web Site</b>
   </xsl:when>
   <xsl:when    test="../WebSite">
   <i>
   <b>Web Site</b>
   </i>
   </xsl:when>
   <xsl:otherwise>
   <b>
   <xsl:text>Web Site</xsl:text>
   </b>
   </xsl:otherwise>
   </xsl:choose>
   </td>
   <td     xsl:use-attribute-sets = "cell2of2">
    <xsl:if        test ="../../../../../../../../../../
                         ProtocolSpecificContact/WebSite ">
    <xsl:element name="a">
    <xsl:attribute name="href">
     <xsl:choose>
     <xsl:when      test="contains(../../../../../../../../../../
                          ProtocolSpecificContact/WebSite/
                          @cdr:xref,'http')">
                          
    <xsl:value-of   select="../../../../../../../../../../
                               ProtocolSpecificContact/WebSite/@cdr:xref"/>
    </xsl:when>
    <xsl:otherwise>
    <xsl:value-of   select="concat('http://',../../../../../../../../../../
                                    ProtocolSpecificContact/WebSite/@cdr:ref)"/>
                            
    </xsl:otherwise>
    </xsl:choose>
    </xsl:attribute>
    <xsl:attribute  name="target">
    <xsl:text>new</xsl:text>
   </xsl:attribute>
   
    <xsl:value-of   select="../../../../../../../../../../
                            ProtocolSpecificContact/WebSite"/>
    </xsl:element>
   <br /> 

   <xsl:value-of  select="../../../../../../../../../../
                               ProtocolSpecificContact/WebSite"/>
   </xsl:if>
    
     
   
    <xsl:if        test = "../../../../../../SpecificWebSite/@cdr:xref">
    <xsl:element name="a">
    <xsl:attribute name="href">
     <xsl:choose>
     <xsl:when      test="contains(../../../../../../SpecificWebSite/@cdr:xref,
                          'http')">
    <xsl:value-of   select="../../../../../../SpecificWebSite/@cdr:xref"/>
    </xsl:when>
    <xsl:otherwise>
    <xsl:value-of   select="concat('http://',../../../../../../SpecificWebSite/
                    @cdr:xref)"/>
    </xsl:otherwise>
    </xsl:choose>
    </xsl:attribute>
    <xsl:attribute  name="target">
    <xsl:text>new</xsl:text>
    </xsl:attribute>
   
    <xsl:value-of   select="../../../../../../SpecificWebSite/@cdr:xref"/>
    </xsl:element>
   <br /> 
      
   
   <xsl:value-of  select="../../../../../../SpecificWebSite"/>
   </xsl:if>
    
    <xsl:if        test="not(../../../../../../SpecificWebSite)">
    <xsl:if        test ="../WebSite/@cdr:xref">
    <xsl:element name="a">
    <xsl:attribute name="href">
     <xsl:choose>
     <xsl:when      test="contains(../WebSite/@cdr:xref,
                          'http')">
    <xsl:value-of   select="../WebSite/@cdr:xref"/>
    </xsl:when>
    <xsl:otherwise>
    <xsl:value-of   select="concat('http://',../WebSite/
                    @cdr:xref)"/>
    </xsl:otherwise>
    </xsl:choose>
    </xsl:attribute>
    <xsl:attribute  name="target">
    <xsl:text>new</xsl:text>
    </xsl:attribute>
   
    <i>
    <xsl:value-of   select="../WebSite/@cdr:xref"/>
    </i>
    </xsl:element>
    <br />
    <i>
    <xsl:value-of  select="../WebSite"/>
    </i>
   </xsl:if>
   </xsl:if>
   </td>
   </tr>
   </table>
  </xsl:if> 
  <br />
  </xsl:for-each>
  </xsl:if>
  </xsl:for-each>
 
 <!-- 
 ===================================================================
 Display Orgs Name, Status, and Contact Information
 If the SuppressContactInformation attribute is listed for the 
 ProtocolSites element display for all of its childres organizations
 the text " (suppress all contact information)"
 For individual organizations with the attribute SuppressContactInfo
 only display the string " (suppress contact information)"
 =================================================================== -->
  <xsl:for-each           select="ProtocolSites">
   <b>
    <u>Participating Organizations (for Lead Organization)</u>
   </b>
    <xsl:if                       test = "@SuppressContactInformation">
     <u>
      <xsl:apply-templates      select = "@SuppressContactInformation">
       <xsl:with-param            name = "suppressAll"
                                select = "'all'"/>
      </xsl:apply-templates>
     </u> 
    </xsl:if>
    <br />
   <ol bottom-margin='0'>
   <xsl:for-each                select = "OrgSiteID |
                                          PrivatePracticeSiteID">
                               
   <!-- xsl:sort          select="."/ -->
                                                    
   <li class="org">
   <table       xsl:use-attribute-sets = "table">
    <tr>
     <td        xsl:use-attribute-sets = "cell1of2">
      <b>Organization Name</b>
     </td>
     <td        xsl:use-attribute-sets = "cell2of2">
      <xsl:value-of             select = "Organization/
                                          OrganizationNameInformation/
                                          OfficialName/Name"/>
       <xsl:if                    test = "PrivatePracticePerson">
        <xsl:value-of           select = "'Private Practice'"/>
       </xsl:if>
       <xsl:choose>
        <xsl:when                 test = "../@SuppressContactInformation">
         <xsl:apply-templates   select = "../@SuppressContactInformation">
          <xsl:with-param         name = "suppressAll"
                                select = "'all'"/>
         </xsl:apply-templates>    
        </xsl:when>
        <xsl:otherwise>
         <xsl:apply-templates   select = "@SuppressContactInformation"/>
        </xsl:otherwise>
       </xsl:choose>
      </td>
     </tr>
     <tr>
      <td       xsl:use-attribute-sets = "cell1of2">
       <b>Organization Protocol Status</b>
      </td>
      <td       xsl:use-attribute-sets = "cell2of2">
       <xsl:value-of            select = "OrgSiteStatus | 
                                          PrivatePracticeSiteStatus"/>
      </td>
     </tr>
    </table>

    <xsl:for-each               select = "OrgSiteContact | 
                                          PrivatePracticePerson">
     <xsl:if                      test = "SpecificPerson |
                                          Person">
      <xsl:for-each             select = "SpecificPerson/Person |
                                          Person">
       <xsl:variable              name = "PerFrag" 
                                select = "substring-after(@cdr:ref,'#')"/>
       <table   xsl:use-attribute-sets = "table">
        <tr>
         <td    xsl:use-attribute-sets = "cell1of2">
          <b>Contact</b>
         </td>
         <td    xsl:use-attribute-sets = "cell2of2">
          <xsl:value-of         select = "PersonNameInformation/SurName"/>,
          <xsl:value-of         select = "PersonNameInformation/GivenName"/>
          <xsl:text> [</xsl:text>
          <xsl:value-of         select = "$PerFrag"/>
          <xsl:text>]</xsl:text>
         </td>
        </tr> 
        <tr>
         <td    xsl:use-attribute-sets = "cell1of2">
          <b>Role</b>
         </td>
         <td    xsl:use-attribute-sets = "cell2of2">
          <xsl:value-of         select = "../Role |
                                          ../../Role"/>
         </td>
        </tr>
        <tr>
         <td    xsl:use-attribute-sets = "cell1of2">
          <b>Organization Location</b>
         </td>
         <td    xsl:use-attribute-sets = "cell2of2">
          <xsl:value-of         select = "PersonLocations/
                                      OtherPracticeLocation[$PerFrag=@cdr:id]/
                                      OrganizationLocation/Organization/
                                      OrganizationNameInformation/
                                      OfficialName/Name"/>         
         </td>
        </tr>

   <!-- 
   ====================================================================
   Display the denormalized Postal Address information
   ==================================================================== -->
   <xsl:choose>
    <xsl:when                     test = "PersonLocations/
                                          OtherPracticeLocation
                                            [$PerFrag=@cdr:id]/
                                          SpecificPostalAddress">

     <xsl:for-each              select = "PersonLocations/
                                          OtherPracticeLocation
                                            [$PerFrag=@cdr:id]/
                                          SpecificPostalAddress/
                                          Street">
      <tr>
       <td      xsl:use-attribute-sets = "cell1of2">
        <xsl:if                   test = "not(preceding-sibling::Street)">
         <b>Street</b>
        </xsl:if>
       </td>
       <td      xsl:use-attribute-sets = "cell2of2">
        <xsl:value-of           select = "."/>
       </td>
      </tr>
     </xsl:for-each>

     <xsl:for-each              select = "PersonLocations/
                                          OtherPracticeLocation
                                            [$PerFrag=@cdr:id]/
                                          SpecificPostalAddress">
      <tr>
       <td      xsl:use-attribute-sets = "cell1of2">
        <b>City</b>
       </td>
       <td      xsl:use-attribute-sets = "cell2of2">
        <xsl:value-of           select = "City"/>
       </td>
      </tr>

      <xsl:if                     test = "CitySuffix">
       <tr>
        <td     xsl:use-attribute-sets = "cell1of2">
         <b>City Suffix</b>
        </td>
        <td     xsl:use-attribute-sets = "cell2of2">
         <xsl:value-of          select = "CitySuffix"/>
        </td>
       </tr>
      </xsl:if>

      <tr>
       <td      xsl:use-attribute-sets = "cell1of2">
        <b>State/Political Unit</b>
       </td>
       <td      xsl:use-attribute-sets = "cell2of2">
        <xsl:value-of           select = "PoliticalSubUnit_State/
                                          PoliticalSubUnitFullName"/>
  
       </td>
      </tr>
      <tr>                      
       <td      xsl:use-attribute-sets = "cell1of2">
        <b>Country</b>
       </td>
       <td      xsl:use-attribute-sets = "cell2of2">
        <xsl:value-of           select = "Country/
                                          CountryFullName"/>
       </td>
      </tr>
      <tr>                      
       <td      xsl:use-attribute-sets = "cell1of2">
        <b>Zip/Postal Code</b>
       </td>
       <td      xsl:use-attribute-sets = "cell2of2">
        <xsl:value-of           select = "PostalCode_ZIP"/>
       </td>
      </tr>
     </xsl:for-each>
    </xsl:when>
    <xsl:otherwise>
     <!-- 
     Create a variable holding the fragment ID of the Org Location
     for this OtherPracticeLocation.  This will be used to display
     the address since no SpecificPostalAddress element exists.
     ============================================================= -->
     <xsl:variable                name = "orgLocFrag"  
                                select = "substring-after(PersonLocations/
                                            OtherPracticeLocation
                                            [$PerFrag=@cdr:id]/
                                          OrganizationLocation/
                                          Organization/@cdr:ref, '#')"/>

     <xsl:for-each              select = "PersonLocations/
                                          OtherPracticeLocation
                                            [$PerFrag=@cdr:id]/
                                          OrganizationLocation/Organization/
                                          OrganizationLocations/
                                          OrganizationLocation/
                                          Location[@cdr:id = $orgLocFrag]/
                                          PostalAddress/
                                          Street">
      <tr>
       <td      xsl:use-attribute-sets = "cell1of2">
        <xsl:if                   test = "not(preceding-sibling::Street)">
         <i>
          <b>Street</b>
         </i>
        </xsl:if>
       </td>
       <td      xsl:use-attribute-sets = "cell2of2">
        <i>
         <xsl:value-of          select = "."/>
        </i>
       </td>
      </tr>
     </xsl:for-each>

     <xsl:for-each              select = "PersonLocations/
                                          OtherPracticeLocation
                                            [$PerFrag=@cdr:id]/
                                          OrganizationLocation/Organization/
                                          OrganizationLocations/
                                          OrganizationLocation/
                                          Location[@cdr:id = $orgLocFrag]/
                                          PostalAddress">
      <tr>
       <td      xsl:use-attribute-sets = "cell1of2">
        <i>
         <b>City</b>
        </i>
       </td>
       <td      xsl:use-attribute-sets = "cell2of2">
        <i>
         <xsl:value-of          select = "City"/>
        </i>
       </td>
      </tr>
      <xsl:if                     test = "CitySuffix">
       <tr>
        <td     xsl:use-attribute-sets = "cell1of2">
         <i>
          <b>City Suffix</b>
         </i>
        </td>
        <td     xsl:use-attribute-sets = "cell2of2">
         <i>
          <xsl:value-of         select = "CitySuffix"/>
         </i>
        </td>
       </tr>
      </xsl:if>
      <tr>
       <td      xsl:use-attribute-sets = "cell1of2">
        <i>
         <b>State/Political Unit</b>
        </i>
       </td>
       <td      xsl:use-attribute-sets = "cell2of2">
        <i>
         <xsl:value-of          select = "PoliticalSubUnit_State/
                                          PoliticalSubUnitFullName"/>
        </i>
       </td>
      </tr>
      <tr>                      
       <td      xsl:use-attribute-sets = "cell1of2">
        <i>
         <b>Country</b>
        </i>
       </td>
       <td      xsl:use-attribute-sets = "cell2of2">
        <i>
         <xsl:value-of          select = "Country/
                                          CountryFullName"/>
        </i>
       </td>
      </tr>
      <tr>                      
       <td      xsl:use-attribute-sets = "cell1of2">
        <i>
         <b>Zip/Postal Code</b>
        </i>
       </td>
       <td      xsl:use-attribute-sets = "cell2of2">
        <i>
         <xsl:value-of          select = "PostalCode_ZIP"/>
        </i>    
       </td>
      </tr>
     </xsl:for-each>
    </xsl:otherwise>
   </xsl:choose>
  </table>

  <xsl:if             test = "PersonLocations/PrivatePractice/
                             PrivatePracticeLocation[$PerFrag=@cdr:id]">

  <table xsl:use-attribute-sets = "table">

  <xsl:for-each       select = "PersonLocations/PrivatePractice/
                                PrivatePracticeLocation[$PerFrag=@cdr:id]/
                                PostalAddress/Street">
        <tr>
        <td     xsl:use-attribute-sets = "cell1of2">
        <xsl:if test="not(preceding-sibling::Street)">
         <b>Street</b>
         </xsl:if>
         </td>
         <td     xsl:use-attribute-sets = "cell2of2">
         <xsl:value-of       select = "."/>
         </td>
         </tr>
        </xsl:for-each>
        </table>

         <table xsl:use-attribute-sets = "table">
         <xsl:for-each        select="PersonLocations/PrivatePractice/
                                      PrivatePracticeLocation[$PerFrag=@cdr:id]/
                                      PostalAddress">
                                      
      <tr>
      <td     xsl:use-attribute-sets = "cell1of2">
      <b>City</b>
     </td>
     <td     xsl:use-attribute-sets = "cell2of2">
    <xsl:value-of        select="City"/>
    </td>
    </tr>
 
 
 
   <xsl:if            test="CitySuffix">
   <tr>
   <td     xsl:use-attribute-sets = "cell1of2">
   <b>City Suffix</b>
   </td>
   <td     xsl:use-attribute-sets = "cell2of2">
   <xsl:value-of        select="CitySuffix"/>
   </td>
   </tr>
   </xsl:if>
  
 
 
                         
   <tr>
   <td     xsl:use-attribute-sets = "cell1of2">
   <b>State/Political Unit</b>
   </td>
   <td     xsl:use-attribute-sets = "cell2of2">
   
   <xsl:value-of        select="PoliticalSubUnit_State/
                                PoliticalSubUnitFullName"/>
  
  </td>
  </tr>
  
 
   <tr>                      
   <td     xsl:use-attribute-sets = "cell1of2">
   <b>Country</b>
   </td>
   <td     xsl:use-attribute-sets = "cell2of2">
   <xsl:value-of        select="Country/
                                CountryFullName"/>
   
  </td>
  </tr>
   <tr>                      
   <td     xsl:use-attribute-sets = "cell1of2">
   <b>Zip/Postal Code</b>
   </td>
   <td     xsl:use-attribute-sets = "cell2of2">
   <xsl:value-of        select="PostalCode_ZIP"/>
   </td>
   </tr>
   </xsl:for-each>
   </table>
   </xsl:if>
  
  <xsl:if             test = "PersonLocations/
                             Home[$PerFrag=@cdr:id]">

  <table xsl:use-attribute-sets = "table">

  <xsl:for-each       select = "PersonLocations/
                                Home[$PerFrag=@cdr:id]/
                                PostalAddress/Street">
       <tr>
        <td     xsl:use-attribute-sets = "cell1of2">
        <xsl:if test="not(preceding-sibling::Street)">
         <b>Street</b>
         </xsl:if>
         </td>
         <td     xsl:use-attribute-sets = "cell2of2">
         <xsl:value-of       select = "."/>
         </td>
         </tr>
        </xsl:for-each>
        </table>

         <table xsl:use-attribute-sets = "table">
         <xsl:for-each         select="PersonLocations/
                                       Home[$PerFrag=@cdr:id]/
                                       PostalAddress">
                                      
      <tr>
      <td     xsl:use-attribute-sets = "cell1of2">
      <b>City</b>
     </td>
     <td     xsl:use-attribute-sets = "cell2of2">
    <xsl:value-of        select="City"/>
    </td>
    </tr>
 
 
 
   <xsl:if            test="CitySuffix">
   <tr>
   <td     xsl:use-attribute-sets = "cell1of2">
   <b>City Suffix</b>
   </td>
   <td     xsl:use-attribute-sets = "cell2of2">
   <xsl:value-of        select="CitySuffix"/>
   </td>
   </tr>
   </xsl:if>
  
 
 
                         
   <tr>
   <td     xsl:use-attribute-sets = "cell1of2">
   <b>State/Political Unit</b>
   </td>
   <td     xsl:use-attribute-sets = "cell2of2">
   
   <xsl:value-of        select="PoliticalSubUnit_State/
                                PoliticalSubUnitFullName"/>
  
  </td>
  </tr>
  
 
   <tr>                      
   <td     xsl:use-attribute-sets = "cell1of2">
   <b>Country</b>
   </td>
   <td     xsl:use-attribute-sets = "cell2of2">
   
   <xsl:value-of        select="Country/
                                CountryFullName"/>
   
   
  </td>
  </tr>
   <tr>                      
   <td     xsl:use-attribute-sets = "cell1of2">
   <b>Zip/Postal Code</b>
   </td>
   <td     xsl:use-attribute-sets = "cell2of2">
   <xsl:value-of        select="PostalCode_ZIP"/>
  </td>
  </tr>
  </xsl:for-each>
  </table>
  </xsl:if>

  <!--
  Display the Specific Protocol Information (Phone, Email, etc.)
  =================================================================== -->
   <table       xsl:use-attribute-sets = "table">

 <!-- Display SpecificPhone or Phone for Participants section
      If no phone exists display just the empty phone label.
      Information pulled in from another document (denormalized)
      is displayed in italics.
      =========================================================== -->
    <tr>
     <td        xsl:use-attribute-sets = "cell1of2">
      <xsl:choose>
       <xsl:when                  test = "../SpecificPhone">
        <b>Phone</b>
       </xsl:when>
       <xsl:when                  test = "PersonLocations/
                                            OtherPracticeLocation[$PerFrag=
                                                                     @cdr:id]/
                                            SpecificPhone |
                                          PersonLocations/PrivatePractice/
                                            PrivatePracticeLocation[$PerFrag=
                                                                     @cdr:id]/
                                            Phone | 
                                          PersonLocations/
                                            Home[$PerFrag=@cdr:id]/
                                            Phone |
                                          PersonLocations/
                                            OtherPracticeLocation[$PerFrag=
                                                                     @cdr:id]/
                                            OrganizationLocation/Organization/
                                            OrganizationLocations/
                                            OrganizationLocation/Location/
                                            Phone"> 
        <i>
         <b>Phone</b>
        </i>
       </xsl:when>
       <xsl:otherwise>
        <b>Phone</b>
       </xsl:otherwise>
      </xsl:choose>
     </td>
     <td        xsl:use-attribute-sets = "cell2of2">
      <xsl:choose>
       <xsl:when                  test = "../SpecificPhone">
        <xsl:value-of           select = "../SpecificPhone"/>
                                                                       
        <xsl:apply-templates    select = "SpecificPhone/@Public"/>
       </xsl:when>
       <xsl:when                  test = "PersonLocations/
                                            OtherPracticeLocation[$PerFrag=
                                                                      @cdr:id]/
                                            SpecificPhone |
                                          PersonLocations/PrivatePractice/
                                            PrivatePracticeLocation[$PerFrag=
                                                                      @cdr:id]/
                                            Phone |
                                          PersonLocations/
                                            Home[$PerFrag=@cdr:id]/
                                            Phone">
        <i>
         <xsl:value-of          select = "PersonLocations/
                                            OtherPracticeLocation[$PerFrag=
                                                                      @cdr:id]/
                                            SpecificPhone |
                                          PersonLocations/PrivatePractice/
                                            PrivatePracticeLocation[$PerFrag=
                                                                      @cdr:id]/
                                            Phone |
                                          PersonLocations/
                                            Home[$PerFrag=@cdr:id]/
                                            Phone"/>
         <xsl:apply-templates   select = "PersonLocations/
                                            OtherPracticeLocation[$PerFrag=
                                                                      @cdr:id]/
                                            SpecificPhone/@Public |
                                          PersonLocations/PrivatePractice/
                                            PrivatePracticeLocation[$PerFrag=
                                                                      @cdr:id]/
                                            Phone/@Public |
                                          PersonLocations/
                                            Home[$PerFrag=@cdr:id]/
                                            Phone/@Public"/>
        </i>
       </xsl:when>                              
       <xsl:when                  test = "PersonLocations/
                                          OtherPracticeLocation[$PerFrag=
                                                                      @cdr:id]/
                                          OrganizationLocation/Organization/
                                          OrganizationLocations/
                                          OrganizationLocation/Location/
                                          Phone">
        <i>
         <xsl:value-of          select = "PersonLocations/
                                          OtherPracticeLocation[$PerFrag=
                                                                      @cdr:id]/
                                          OrganizationLocation/Organization/
                                          OrganizationLocations/
                                          OrganizationLocation/Location/
                                          Phone"/>
        </i>
       </xsl:when>
      </xsl:choose>
     </td>
    </tr>

 <!-- Display SpecificTollFreePhone or TollFreePhone for 
      Participants section. 
      If no Phone exists just print an empty label.
      =========================================================== -->
    <tr>
     <td         xsl:use-attribute-sets = "cell1of2">
      <xsl:choose>
       <xsl:when                  test = "PersonLocations/
                                            OtherPracticeLocation[$PerFrag=
                                                                      @cdr:id]/
                                            SpecificTollFreePhone |
                                          PersonLocations/PrivatePractice/
                                            PrivatePracticeLocation[$PerFrag=
                                                                      @cdr:id]/
                                            TollFreePhone">
        <b>Toll Free Phone</b>
       </xsl:when>
       <xsl:when                  test = "PersonLocations/
                                          OtherPracticeLocation[$PerFrag=
                                                                      @cdr:id]/
                                          OrganizationLocation/Organization/
                                          OrganizationLocations/
                                          OrganizationLocation/Location/
                                          TollFreePhone">
        <i>
         <b>Toll Free Phone</b>
        </i>
       </xsl:when>
       <xsl:otherwise>
        <b>Toll Free Phone</b>
       </xsl:otherwise>
      </xsl:choose>
     </td>
     <td        xsl:use-attribute-sets = "cell2of2">
      <xsl:value-of             select = "PersonLocations/
                                            OtherPracticeLocation[$PerFrag=
                                                                      @cdr:id]/
                                            SpecificTollFreePhone |
                                          PersonLocations/PrivatePractice/
                                            PrivatePracticeLocation[$PerFrag=
                                                                      @cdr:id]/
                                            TollFreePhone"/>
      <xsl:if                     test = "not(PersonLocations/
                                          OtherPracticeLocation[$PerFrag=
                                                                      @cdr:id]/
                                          SpecificTollFreePhone)">
       <i>
        <xsl:value-of           select = "PersonLocations/
                                          OtherPracticeLocation[$PerFrag=
                                                                      @cdr:id]/
                                          OrganizationLocation/Organization/
                                          OrganizationLocations/
                                          OrganizationLocation/Location/
                                          TollFreePhone"/>
       </i>
      </xsl:if>
     </td>
    </tr>

 <!-- Display SpecificFax or Fax for Participants section. 
      If no Fax exists just print an empty label.
      =========================================================== -->
    <tr>
     <td        xsl:use-attribute-sets = "cell1of2">
      <xsl:choose>
       <xsl:when                  test = "PersonLocations/
                                            OtherPracticeLocation[$PerFrag=
                                                                      @cdr:id]/
                                            SpecificFax |
                                          PersonLocations/
                                            PrivatePractice/
                                            PrivatePracticeLocation[$PerFrag=
                                                                      @cdr:id]/
                                            Fax | 
                                          PersonLocations/
                                          Home[$PerFrag=@cdr:id]/
                                            Fax">
        <b>Fax</b>
       </xsl:when>
       <xsl:when                  test = "PersonLocations/
                                          OtherPracticeLocation[$PerFrag=
                                                                      @cdr:id]/
                                          OrganizationLocation/Organization/
                                          OrganizationLocations/
                                          OrganizationLocation/Location/Fax">
        <i>
         <b>Fax</b>
        </i>
       </xsl:when>
       <xsl:otherwise>
        <b>Fax</b>
       </xsl:otherwise>
      </xsl:choose>
     </td>
     <td        xsl:use-attribute-sets = "cell2of2">
      <xsl:value-of             select = "PersonLocations/
                                            OtherPracticeLocation[$PerFrag=
                                                                      @cdr:id]/
                                            SpecificFax |
                                          PersonLocations/PrivatePractice/
                                            PrivatePracticeLocation[$PerFrag=
                                                                      @cdr:id]/
                                            Fax |
                                          PersonLocations/
                                            Home[$PerFrag=@cdr:id]/
                                            Fax"/>
      <xsl:if                     test = "not(PersonLocations/
                                          OtherPracticeLocation[$PerFrag=
                                                                      @cdr:id]/
                                          SpecificFax)">
       <i>
        <xsl:value-of           select = "PersonLocations/
                                          OtherPracticeLocation[$PerFrag=
                                                                      @cdr:id]/
                                          OrganizationLocation/Organization/
                                          OrganizationLocations/
                                          OrganizationLocation/Location/Fax"/>
       </i>
      </xsl:if>
     </td>
    </tr>
      
 <!-- Display SpecificEmail or Email for Participants
      =========================================================== -->
       <tr>
        <td     xsl:use-attribute-sets = "cell1of2">
         <xsl:choose>
          <xsl:when               test = "PersonLocations/
                                            OtherPracticeLocation[$PerFrag=
                                                                     @cdr:id]/
                                            SpecificEmail |
                                          PersonLocations/PrivatePractice/
                                            PrivatePracticeLocation[$PerFrag=
                                                                     @cdr:id]/
                                            Email |
                                          PersonLocations/
                                            Home[$PerFrag=@cdr:id]/
                                            Email">
           <i>
            <b>Email</b>
           </i>
          </xsl:when>
          <xsl:otherwise>
           <b>Email</b>
          </xsl:otherwise>
         </xsl:choose>
        </td>
        <td     xsl:use-attribute-sets = "cell2of2">
         <xsl:element             name = "a">
          <xsl:attribute          name = "href">
           <xsl:choose>
            <xsl:when             test = "../SpecificEmail">
             <xsl:value-of      select = "concat('mailto:', ../SpecificEmail)"/>
            </xsl:when>
            <xsl:otherwise>
             <xsl:value-of      select = "concat('mailto:',PersonLocations/
                                            OtherPracticeLocation[$PerFrag=
                                                                     @cdr:id]/
                                            SpecificEmail |
                                          PersonLocations/PrivatePractice/
                                            PrivatePracticeLocation[$PerFrag=
                                                                     @cdr:id]/
                                            Email |
                                          PersonLocations/
                                            Home[$PerFrag=@cdr:id]/Email)"/>
            </xsl:otherwise>
           </xsl:choose>
          </xsl:attribute>
          <xsl:choose>
           <xsl:when              test = "../SpecificEmail">
            <xsl:value-of       select = "../SpecificEmail"/>
            <xsl:apply-templates select= "../SpecificEmail/@Public"/>
           </xsl:when>
           <xsl:otherwise>
            <i>
             <xsl:value-of      select = "PersonLocations/
                                            OtherPracticeLocation[$PerFrag=
                                                                     @cdr:id]/
                                            SpecificEmail |
                                          PersonLocations/PrivatePractice/
                                            PrivatePracticeLocation[$PerFrag=
                                                                     @cdr:id]/
                                            Email |
                                          PersonLocations/
                                            Home[$PerFrag=@cdr:id]/
                                            Email"/>
             <xsl:apply-templates select = "PersonLocations/
                                            OtherPracticeLocation[$PerFrag=
                                                                     @cdr:id]/
                                            SpecificEmail/@Public |
                                          PersonLocations/PrivatePractice/
                                            PrivatePracticeLocation[$PerFrag=
                                                                     @cdr:id]/
                                            Email/@Public |
                                          PersonLocations/
                                            Home[$PerFrag=@cdr:id]/
                                            Email/@Public"/>
            </i>
           </xsl:otherwise>
          </xsl:choose>
         </xsl:element>
        </td>
       </tr>

 <!-- Display SpecificWebSite or WebSite for Participants
      =========================================================== -->
       <tr>
       <td      xsl:use-attribute-sets = "cell1of2">
        <xsl:choose>
         <xsl:when                test = "PersonLocations/
                                            OtherPracticeLocation[$PerFrag=
                                                                     @cdr:id]/
                                            SpecificWebSite |
                                          PersonLocations/PrivatePractice/
                                            PrivatePracticeLocation[$PerFrag=
                                                                     @cdr:id]/
                                            WebSite |
                                          PersonLocations/
                                            Home[$PerFrag=@cdr:id]/WebSite">
          <b>Web Site</b>
         </xsl:when>
         <xsl:when                test = "PersonLocations/
                                          OtherPracticeLocation[$PerFrag=
                                                                     @cdr:id]/
                                          OrganizationLocation/Organization/
                                          OrganizationLocations/
                                          OrganizationLocation/Location/
                                          WebSite">
          <i>
           <b>Web Site</b>
          </i>
         </xsl:when>
         <xsl:otherwise>
          <b>Web Site</b>
         </xsl:otherwise>
        </xsl:choose>
       </td>
       <td      xsl:use-attribute-sets = "cell2of2">
        <xsl:if                   test = "PersonLocations/
                                            OtherPracticeLocation[$PerFrag=
                                                                     @cdr:id]/
                                            SpecificWebSite/@cdr:xref |
                                          PersonLocations/PrivatePractice/
                                            PrivatePracticeLocation[$PerFrag=
                                                                     @cdr:id]/
                                            WebSite/@cdr:xref |
                                          PersonLocations/
                                            Home[$PerFrag=@cdr:id]/
                                            WebSite/@cdr:xref">
        
         <xsl:element             name = "a">
          <xsl:attribute          name = "href">
           <xsl:choose>
            <xsl:when             test = "contains(PersonLocations/
                                          OtherPracticeLocation[$PerFrag=
                                                                      @cdr:id]/
                                          SpecificWebSite/@cdr:xref,'http')">
                                    
             <xsl:value-of      select = "PersonLocations/
                                          OtherPracticeLocation[$PerFrag=
                                                                      @cdr:id]/
                                          SpecificWebSite/@cdr:xref"/>
            </xsl:when>
            <xsl:otherwise>
             <xsl:value-of      select = "concat('http://',PersonLocations/
                                          OtherPracticeLocation[$PerFrag=
                                                                      @cdr:id]/
                                          SpecificWebSite/@cdr:xref)"/>
        
            </xsl:otherwise>
           </xsl:choose>

           <xsl:choose>                                     
            <xsl:when             test = "contains(PersonLocations/
                                          PrivatePractice/
                                          PrivatePracticeLocation[$PerFrag=
                                                                     @cdr:id]/
                                          WebSite/@cdr:xref,'http')">
                                    
             <xsl:value-of      select ="PersonLocations/PrivatePractice/
                                         PrivatePracticeLocation[$PerFrag=
                                                                      @cdr:id]/
                                         WebSite/@cdr:xref"/>
            </xsl:when>
            <xsl:otherwise>
             <xsl:value-of      select = "concat('http://',PersonLocations/
                                          PrivatePractice/
                                          OtherPracticeLocation[$PerFrag=
                                                                      @cdr:id]/
                                          WebSite/@cdr:xref)"/>
        
            </xsl:otherwise>
           </xsl:choose>

           <xsl:choose>
            <xsl:when             test = "contains(PersonLocations/
                                          Home[$PerFrag=@cdr:id]/
                                          WebSite/@cdr:xref,'http')">
                                    
             <xsl:value-of      select = "PersonLocations/
                                          Home[$PerFrag=@cdr:id]/
                                          WebSite/@cdr:xref"/>
            </xsl:when>
            <xsl:otherwise>
             <xsl:value-of      select = "concat('http://',PersonLocations/
                                          Home[$PerFrag=@cdr:id]/
                                          WebSite/@cdr:xref)"/>
        
            </xsl:otherwise>
           </xsl:choose>
                    
           <xsl:value-of        select = "PersonLocations/
                                            OtherPracticeLocation[$PerFrag=
                                                                      @cdr:id]/
                                            SpecificWebSite/@cdr:xref |
                                          PersonLocations/PrivatePractice/
                                            PrivatePracticeLocation[$PerFrag=
                                                                      @cdr:id]/
                                            WebSite/@cdr:xref |
                                          PersonLocations/
                                            Home[$PerFrag=@cdr:id]/
                                            WebSite/@cdr:xref"/>
          </xsl:attribute>
          <xsl:attribute          name = "target">
           <xsl:text>new</xsl:text>
          </xsl:attribute>

          <xsl:value-of         select = "PersonLocations/
                                            OtherPracticeLocation[$PerFrag=
                                                                     @cdr:id]/
                                            SpecificWebSite/@cdr:xref |
                                          PersonLocations/PrivatePractice/
                                            PrivatePracticeLocation[$PerFrag=
                                                                     @cdr:id]/
                                            WebSite/@cdr:xref |
                                          PersonLocations/
                                            Home[$PerFrag=@cdr:id]/
                                            WebSite/@cdr:xref"/>
         </xsl:element> 
         <br />
        </xsl:if>

        <xsl:value-of           select = "PersonLocations/
                                            OtherPracticeLocation[$PerFrag=
                                                                      @cdr:id]/
                                            SpecificWebSite |
                                          PersonLocations/PrivatePractice/
                                            PrivatePracticeLocation[$PerFrag=
                                                                      @cdr:id]/
                                            WebSite |
                                          PersonLocations/
                                            Home[$PerFrag=@cdr:id]/
                                            WebSite"/>

                                       
                
         <xsl:if                  test = "not(PersonLocations/
                                          OtherPracticeLocation[$PerFrag=
                                                                      @cdr:id]/
                                          SpecificWebSite)">
          <xsl:if                 test = "PersonLocations/
                                          OtherPracticeLocation[$PerFrag=
                                                                      @cdr:id]/
                                          OrganizationLocation/Organization/
                                          OrganizationLocations/
                                          OrganizationLocation/Location/
                                          WebSite/@cdr:xref">
           <xsl:element           name = "a">
            <xsl:attribute        name = "href">
             <xsl:choose>
              <xsl:when           test = "contains(PersonLocations/
                                          OtherPracticeLocation[$PerFrag=
                                                                      @cdr:id]/
                                          OrganizationLocation/Organization/
                                          OrganizationLocations/
                                          OrganizationLocation/Location/
                                          WebSite/@cdr:xref,'http')"> 
      
               <xsl:value-of    select = "PersonLocations/
                                          OtherPracticeLocation[$PerFrag=
                                                                      @cdr:id]/
                                          OrganizationLocation/Organization/
                                          OrganizationLocations/
                                          OrganizationLocation/Location/
                                          WebSite/@cdr:xref"/> 
   
              </xsl:when>
             <xsl:otherwise>
              <xsl:value-of     select = "concat('http://',
                                          PersonLocations/
                                          OtherPracticeLocation[$PerFrag=
                                                                      @cdr:id]/
                                          OrganizationLocation/Organization/
                                          OrganizationLocations/
                                          OrganizationLocation/Location/
                                          WebSite/@cdr:xref)"/>
   
             </xsl:otherwise>
            </xsl:choose>
           </xsl:attribute>
           <xsl:attribute         name = "target">
            <xsl:text>new</xsl:text>
           </xsl:attribute>
   
           <i>
            <xsl:value-of       select = "PersonLocations/
                                          OtherPracticeLocation[$PerFrag=
                                                                      @cdr:id]/
                                          OrganizationLocation/Organization/
                                          OrganizationLocations/
                                          OrganizationLocation/Location/
                                          WebSite/@cdr:xref"/>
     
           </i>
          </xsl:element>
          <br /> 
          <i> 
           <xsl:value-of        select = "PersonLocations/
                                          OtherPracticeLocation[$PerFrag=
                                                                      @cdr:id]/
                                          OrganizationLocation/Organization/
                                          OrganizationLocations/
                                          OrganizationLocation/Location/
                                          WebSite"/>
          </i>
         </xsl:if>   
        </xsl:if>
       </td>
      </tr>
     </table>
    </xsl:for-each>
   </xsl:if> 

   <xsl:apply-templates      select = "GenericPerson"/>

   <!-- Add Clinical Trials Office Information
        ====================================== -->
      <xsl:if                     test = "ClinicalTrialOffice">
       <table   xsl:use-attribute-sets = "table">
        <tr>
         <td    xsl:use-attribute-sets = "cell1of2">
          <b>Clinical Trial Office</b>
         </td>
         <td    xsl:use-attribute-sets = "cell2of2">
          <xsl:value-of         select = "ClinicalTrialOffice"/>
         </td>
        </tr>
       </table>
      </xsl:if>
      <br />  
     </xsl:for-each>
    </li>
   </xsl:for-each>
  </ol>
 </xsl:for-each>
 </xsl:template>
         
    <!-- =================================================================
                        Protocol Processing Details
      ================================================================ -->
             <xsl:template      match ="ProtocolProcessingDetails">
              <b>
              <font size='4'>Protocol Processing Details
              </font>
              </b>
              <br />
             <table xsl:use-attribute-sets = "table">
             <tr>
             <td     xsl:use-attribute-sets = "cell1of2">
             <b>Processing Status</b>
             </td>
             <td     xsl:use-attribute-sets = "cell2of2">
             <xsl:value-of     select="ProcessingStatus"/>
             </td>
             </tr>
             <tr>
            <td     xsl:use-attribute-sets = "cell1of2">
            <b>Processing Date</b>
            </td>
            <td     xsl:use-attribute-sets = "cell2of2">
            <xsl:value-of      select="ProcessingDate"/>
            </td>
            </tr>
            </table>
            <b>Comment</b><br />
           <xsl:apply-templates       select="Comment"/><br />
           </xsl:template>

         
 <!-- 
 ================================================================
 Display a Note
 ================================================================ -->
 <xsl:template                  match = "Note">
  <xsl:apply-templates         select = "." 
                                 mode = "RS"/>
 </xsl:template>  


    <!-- ==============================================================
                     Display Dated Action
       ============================================================== -->

         <xsl:template             match = "ProtocolAdminInfo/DatedAction">
          <b>
        <font size='4'><xsl:text>Dated Action</xsl:text></font>
          </b>
          <br />
         <table xsl:use-attribute-sets = "table">
         <tr>
         <td     xsl:use-attribute-sets = "cell1of2">
         <b>Action Description</b>
         </td>
         <td     xsl:use-attribute-sets = "cell2of2">
         <xsl:value-of             select = "ActionDescription"/>
         </td>
         </tr>
         </table>
         <table xsl:use-attribute-sets = "table">
         <tr>
         <td     xsl:use-attribute-sets = "cell1of2">
        <b>Action Date</b>
        </td>
        <td     xsl:use-attribute-sets = "cell2of2">
        <xsl:value-of             select ="ActionDate"/>
        </td>
        </tr>
        </table>
        <b>Comment</b>   
        <br />
        <xsl:value-of             select ="Comment"/>  
        <xsl:if                   test = "Comment">                         
        <br />
        <br />
        </xsl:if>
        </xsl:template>

 
 <!-- 
 ===============================================================
 Display Protocol-Related Links
 =============================================================== -->
 <xsl:template                   match = "ProtocolRelatedLinks">
  <b>
   <font size='4'>Related Protocols</font>
  </b>
  <br />
          
  <xsl:for-each                 select = "RelatedProtocols/InScopeProtocol">
   <xsl:value-of                select = "ProtocolIDs/PrimaryID/IDString"/>;
   <xsl:if                        test = "ProtocolIDs/OtherID/IDString">
    <xsl:value-of               select = "ProtocolIDs/OtherID/IDString"/>;
   </xsl:if>
   <xsl:value-of                select = "ProtocolTitle
                                            [@Type='Professional']"/>
   <br />
   <br />                       
  </xsl:for-each>
  <br />
  <b>
   <font size='4'>Related Websites</font>
  </b>
  <br />
  <xsl:for-each                 select = "RelatedWebsites">
   <table       xsl:use-attribute-sets = "table">
    <tr>
     <td        xsl:use-attribute-sets = "cell1of2">
      <b>URL</b>
     </td>
     <td        xsl:use-attribute-sets = "cell2of2">
      <xsl:element                name = "a">
       <xsl:attribute             name = "href">
        <xsl:choose>
         <xsl:when                test = "contains(RelatedWebsites/
                                                   @cdr:xref,'http')">
          <xsl:value-of         select = "RelatedWebsites/@cdr:xref"/>
         </xsl:when>
         <xsl:otherwise>
          <xsl:value-of         select = "concat('http://',RelatedWebsites/
                                              @cdr:xref)"/>
         </xsl:otherwise>
        </xsl:choose>
       </xsl:attribute>
       <xsl:value-of            select = "RelatedWebsites/@cdr:xref"/>
      </xsl:element>
     </td>
    </tr>
    <tr>
     <td        xsl:use-attribute-sets = "cell1of2">
      <b>Name</b>
     </td>
     <td        xsl:use-attribute-sets = "cell2of2">
      <xsl:value-of             select = "RelatedWebsites"/>
     </td>
    </tr>
   </table>
  </xsl:for-each>
  <xsl:for-each                 select = "Comment">
   <b>Comment</b>
   <br />
   <xsl:value-of                select = "."/>
   <br />
  </xsl:for-each>
 </xsl:template>


 <!--
 ======================================================================
 Template to display OverallContact and Generic Person Information
 ====================================================================== -->
 <xsl:template                   match = "OverallContact |
                                          GenericPerson">
  <table        xsl:use-attribute-sets = "table">
   <xsl:if                        test = "name() = 'OverallContact'">
    <tr>
     <td         xsl:use-attribute-sets = "cell1of2">
      <u>
       <b>Overall Contact</b>
      </u>
     </td>
    </tr>
   </xsl:if>
   <tr>
    <td         xsl:use-attribute-sets = "cell1of2">
     <xsl:choose>
      <xsl:when                   test = "name() = 'OverallContact'">
       <b>Title</b>
      </xsl:when>
      <xsl:otherwise>
       <b>Generic Title</b>
      </xsl:otherwise>
     </xsl:choose>
    </td>
    <td         xsl:use-attribute-sets = "cell2of2">
     <xsl:value-of              select = "PersonTitle"/>
    </td>
   </tr>

   <xsl:apply-templates          select = "GenericPersonContact"/>
  </table>
 </xsl:template>


 <!--
 ======================================================================
 Template to display OverallContact Information
 ====================================================================== -->
 <xsl:template                   match = "GenericPersonContact">
  <tr>
   <td          xsl:use-attribute-sets = "cell1of2">
    <xsl:choose>
     <xsl:when                    test = "name(..) = 'OverallContact'">
      <b>Name</b>
     </xsl:when>
     <xsl:otherwise>
      <b>Generic Contact</b>
     </xsl:otherwise>
    </xsl:choose>
   </td>
   <td          xsl:use-attribute-sets = "cell2of2">
    <xsl:value-of               select = "ContactName"/>
   </td>
  </tr>

  <xsl:for-each                 select = "ContactDetail/PostalAddress/Street">
   <tr>                  
    <td         xsl:use-attribute-sets = "cell1of2">
     <xsl:if                      test = "not(preceding-sibling::Street)">
      <b>
       <xsl:text>Street</xsl:text>
      </b>
     </xsl:if>
    </td>
    <td         xsl:use-attribute-sets = "cell2of2">
     <xsl:value-of              select = "."/>
    </td>
   </tr>
  </xsl:for-each>

  <tr>
   <td          xsl:use-attribute-sets = "cell1of2">
    <b>City</b>
   </td>
   <td          xsl:use-attribute-sets = "cell2of2">
    <xsl:value-of               select = "ContactDetail/PostalAddress/City"/>
   </td>
  </tr>
  <tr>
   <td          xsl:use-attribute-sets = "cell1of2">
    <b>PoliticalSubUnit</b>
   </td>
   <td          xsl:use-attribute-sets = "cell2of2">
    <xsl:value-of               select = "ContactDetail/PostalAddress/
                                          PoliticalSubUnit_State/
                                          PoliticalSubUnitFullName"/>
   </td>
  </tr>
  <tr>
   <td          xsl:use-attribute-sets = "cell1of2">
    <b>Country</b>
   </td>
   <td          xsl:use-attribute-sets = "cell2of2">
    <xsl:value-of               select = "ContactDetail/PostalAddress/
                                          Country/CountryFullName"/>
   </td>
  </tr>
  <tr>
   <td          xsl:use-attribute-sets = "cell1of2">
    <b>ZIP/PostalCode</b>
   </td>
   <td          xsl:use-attribute-sets = "cell2of2">
    <xsl:value-of               select = "ContactDetail/
                                          PostalAddress/
                                          PostalCode_ZIP"/>
   </td>
  </tr>
  <tr>
   <td          xsl:use-attribute-sets = "cell1of2">
    <b>Phone</b>
   </td>
   <td          xsl:use-attribute-sets = "cell2of2">
    <xsl:value-of               select = "ContactDetail/Phone"/>
   <xsl:apply-templates select = "ContactDetail/Phone/@Public"/>
   </td>
  </tr>
  <tr>
   <td          xsl:use-attribute-sets = "cell1of2">
    <b>Toll Free Phone</b>
   </td>
   <td          xsl:use-attribute-sets = "cell2of2">
    <xsl:value-of               select = "ContactDetail/
                                          TollFreePhone"/>
   </td>
  </tr>
  <tr>
   <td          xsl:use-attribute-sets = "cell1of2">
    <xsl:choose>
     <xsl:when                    test = "ContactDetail/Fax">
      <b>Fax</b>
     </xsl:when>
     <xsl:otherwise>
      <i>
       <b>Fax</b>
      </i>
     </xsl:otherwise>
    </xsl:choose>   
   </td>
   <td          xsl:use-attribute-sets = "cell2of2">
    <xsl:choose>
     <xsl:when                    test = "ContactDetail/Fax">
      <xsl:value-of             select = "ContactDetail/Fax"/>
     </xsl:when>
     <xsl:otherwise>
      <i>
       <xsl:value-of            select = "../../../Organization/
                                         OrganizationLocations/
                                         OrganizationLocation/Location/
                                         Fax"/>
      </i>
     </xsl:otherwise>
    </xsl:choose>
   </td>
  </tr>
  <tr>
   <td          xsl:use-attribute-sets = "cell1of2">
    <b>Email</b>
   </td>
   <td          xsl:use-attribute-sets = "cell2of2">
    <xsl:element                  name = "a">
     <xsl:attribute               name = "href">                        
      <xsl:value-of             select = "concat('mailto:',
                                                  ContactDetail/Email)"/>
     </xsl:attribute>
     <xsl:value-of              select = "ContactDetail/Email"/>
    </xsl:element>
    <xsl:text> </xsl:text>
   <xsl:apply-templates select = "ContactDetail/Email/@Public"/>
   </td>
  </tr>
  <tr>
   <td          xsl:use-attribute-sets = "cell1of2">
    <xsl:choose>
     <xsl:when                    test = "ContactDetail/WebSite">
                                  
      <b>Web Site</b>
     </xsl:when>
     <xsl:otherwise>
      <i>
       <b>Web Site</b>
      </i>
     </xsl:otherwise>
    </xsl:choose>
   </td>
   <td          xsl:use-attribute-sets = "cell2of2">
    <xsl:if                       test = "ContactDetail/WebSite">
     <xsl:element                 name = "a">
      <xsl:attribute              name = "href">
       <xsl:choose>
        <xsl:when                 test = "contains(ContactDetail/WebSite, 
                                                   'http')">
         <xsl:value-of          select = "ContactDetail/WebSite/@cdr:xref"/>
        </xsl:when>
        <xsl:otherwise>
         <xsl:value-of          select = "concat('http://', ContactDetail/
                                                  WebSite/@cdr:xref)"/>
        </xsl:otherwise>
       </xsl:choose>
      </xsl:attribute>
      <xsl:attribute              name = "target">
       <xsl:text>new</xsl:text>
      </xsl:attribute>

      <xsl:value-of             select = "ContactDetail/WebSite/@cdr:xref"/>
     </xsl:element>
     <br />
     <xsl:value-of              select = "ContactDetail/WebSite"/>
     <br />
    </xsl:if>
                                                   
    <xsl:if                       test = "not(ContactDetail/WebSite)">
     <xsl:if                      test = "../../../Organization/
                                            OrganizationLocations/
                                             OrganizationLocation/Location/
                                             WebSite/@cdr:xref">
      <xsl:element                name = "a">
       <xsl:attribute             name = "href">
        <xsl:choose>
         <xsl:when                test = "contains(../../../Organization/
                                          OrganizationLocations/
                                          OrganizationLocation/Location/
                                          WebSite/@cdr:xref,'http')">
          <xsl:value-of         select = "../../../Organization/
                                          OrganizationLocations/
                                          OrganizationLocation/Location/
                                          WebSite/@cdr:xref"/>
         </xsl:when>
         <xsl:otherwise>
          <xsl:value-of         select = "concat('http://', ../../../
                                                  Organization/
                                                  OrganizationLocations/
                                                  OrganizationLocation/
                                                  Location/
                                                  WebSite/@cdr:xref)"/>
         </xsl:otherwise>
        </xsl:choose>
       </xsl:attribute>
       <xsl:attribute             name = "target">
        <xsl:text>new</xsl:text>
       </xsl:attribute>
       <i>
        <xsl:value-of           select = "../../../Organization/
                                             OrganizationLocations/
                                             OrganizationLocation/Location/
                                             WebSite/@cdr:xref"/>
       </i>
      </xsl:element>
      <br />
      <i>
       <xsl:value-of            select = "../../../Organization/
                                             OrganizationLocations/
                                             OrganizationLocation/Location/
                                             WebSite"/>
      </i>
     </xsl:if>
    </xsl:if>
   </td>
  </tr>
  <xsl:if                         test = "ClinicalTrialOffice">
   <tr>
    <td         xsl:use-attribute-sets = "cell1of2">
     <b>Clinical Trial Office</b>
    </td>
    <td         xsl:use-attribute-sets = "cell2of2">
     <xsl:value-of              select = "ClinicalTrialOffice"/>
    </td>
   </tr>
  </xsl:if>
 </xsl:template>


 <!--
 ======================================================================
 Template to add (Public = No) to the display
 ====================================================================== -->
 <xsl:template                   match = "@Public">
  <b> 
   <xsl:text> (Public = No)</xsl:text>
  </b>
 </xsl:template>


 <!--
 ======================================================================
 Template to add the SuppressContactInformation to the OrgSiteID and
 PrivatePracticeSiteID elements
 ====================================================================== -->
 <xsl:template                   match = "@SuppressContactInformation">
  <xsl:param                      name = "suppressAll"
                                select = "''"/>
  <b>
   <font size="+1">
    <xsl:text> (suppress </xsl:text>
    <xsl:value-of               select = "$suppressAll"/>
    <xsl:text> contact information)</xsl:text>
   </font>
  </b>
 </xsl:template>
</xsl:transform>
]]>
</CdrDocXml>
</CdrDoc>