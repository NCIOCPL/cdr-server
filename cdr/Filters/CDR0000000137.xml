<CdrDoc Type='Filter' Id='CDR0000000137'>
<CdrDocCtl>
<DocValStatus readonly="yes">U</DocValStatus>
<DocActiveStatus readonly="yes">A</DocActiveStatus>
<DocTitle readonly="yes">Vendor Filter: GlossaryTerm</DocTitle>
</CdrDocCtl>
<CdrDocXml><![CDATA[<?xml version="1.0"?>
  
  
 <!--======================================================================
             Filter to create Vendor XML for Glossary
      ====================================================================== -->

        <xsl:transform xmlns:xsl="http://www.w3.org/1999/XSL/Transform"
                    version="1.0"
                 xmlns:cdr="cips.nci.nih.gov/cdr"
             exclude-result-prefixes="cdr">
    
    <xsl:output method="xml" omit-xml-declaration="no" indent="yes"/>
 

  <!-- =================================================================== 
         Copy DocId, TermName,TermDefinition, Term Pronunciation
        ================================================================= -->
   
<xsl:template match="GlossaryTerm">
 <xsl:text disable-output-escaping="yes">
&lt;!DOCTYPE GlossaryTerm &gt;</xsl:text>

<xsl:copy>
<xsl:for-each  select="document('cdrutil:/docid')">
<xsl:attribute name="id">
<xsl:value-of select="."/>
</xsl:attribute>
</xsl:for-each>
<xsl:if test="PdqKey">
<xsl:attribute name="LegacyPDQID">
<xsl:value-of select="PdqKey"/>
</xsl:attribute>
</xsl:if>

<xsl:apply-templates  select="TermName" mode="copy"/>
<xsl:apply-templates  select="SpanishTermName" mode="copy"/>
<xsl:apply-templates  select="TermPronunciation" mode="copy"/>

<xsl:for-each select="TermDefinition">
<TermDefinition><xsl:value-of select="."/></TermDefinition>
</xsl:for-each>
<xsl:for-each select="SpanishTermDefinition">
<TermDefinition><xsl:value-of select="."/></TermDefinition>
</xsl:for-each>
<!-- ===================================================================
            Copy Date First Published and Date Last Modified
     ================================================================== -->
<xsl:if test="CdrDocCtl/Create/Date">
 <DateFirstPublished><xsl:value-of select="substring-before(CdrDocCtl/Create/Date,'T')"/></DateFirstPublished>
</xsl:if>
<xsl:if test="DateLastModified">
<xsl:apply-templates select="DateLastModified" mode="copy"/>
</xsl:if>
</xsl:copy>
</xsl:template>


<!-- ===================================================================
     Template rule used to do XML to XML transformations which
     copies any attribute node, or node that is child of of something 
     ==================================================================== -->

    <xsl:template match="@*|node()" mode="copy">
       <xsl:copy>
       <xsl:apply-templates select="@*" mode="copy"/>
       <xsl:apply-templates mode="copy"/>
       </xsl:copy> 
    </xsl:template>

</xsl:transform>]]>
</CdrDocXml>
</CdrDoc>