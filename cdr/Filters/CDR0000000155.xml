<CdrDoc Type='Filter' Id='CDR0000000155'>
<CdrDocCtl>
<DocValStatus readonly="yes">U</DocValStatus>
<DocActiveStatus readonly="yes">A</DocActiveStatus>
<DocTitle readonly="yes">InScopeProtocol Full QC Report</DocTitle>
<ReadyForReview readonly="yes">N</ReadyForReview>
</CdrDocCtl>
<CdrDocXml><![CDATA[<?xml      version = "1.0"?>
<!--
 ================================================================
     $Id: CDR0000000155.xml,v 1.69 2005-04-29 21:35:27 venglisc Exp $

     Filter to create a Full InScope Protocol QC Report
        Written by Cheryl Burg

     $Log: not supported by cvs2svn $
 ================================================================ -->
<xsl:transform               xmlns:xsl = "http://www.w3.org/1999/XSL/Transform"
                               version = "1.0"
                             xmlns:cdr = "cips.nci.nih.gov/cdr">

 <xsl:output                    method = "html"/>

 <xsl:include  href = "cdr:name:Module: Attribute Sets"/>
 <xsl:include  href = "cdr:name:Module: InScopeProtocol HP Titles"/>
 <xsl:include  href = "cdr:name:Module: InScopeProtocol HP Identification"/>
 <xsl:include  href = "cdr:name:Module: InScopeProtocol HP Abstract"/>
 <xsl:include  href = "cdr:name:Module: InScopeProtocol HP Details"/>
 <xsl:include  href = "cdr:name:Module: InScopeProtocol Patient Abstract"/> 
 <xsl:include  href = "cdr:name:Module: InScopeProtocol Administrative Details"/>
 <xsl:include  href = "cdr:name:Module: InScopeProtocol Related Links"/>
 <xsl:include  href = "cdr:name:Module: InScopeProtocol HP Record Information"/>
 <xsl:include  href = "cdr:name:Module: Inline Markup Formatter"/>
 <xsl:include  href = "cdr:name:Module: QC Filter Templates"/>
 <xsl:include  href = "cdr:name:Module: Table Formatter"/>
 <xsl:include  href = "cdr:name:Module: STYLE Default"/>  

 <xsl:variable                    name = "docID"
                                select = "document('cdrutil:/docid')"/>

 <!--
 =======================================================================
 Filter written by C.Burg - 4/29/2002
 Modified  7/5/2002 to include Inline Markup
 Modified  7/22/2002 to include sort for Diagnosis,InterventionName
 Modified 5/1/2003 to run with new denormalization filter
 ======================================================================= -->
 <xsl:template                   match = "/">
  <HTML>
   <HEAD>
    <xsl:variable                 name = "cdrdocs" 
                                select = "document('cdrx:/*/CdrCtl')"/>
    <TITLE>
     <xsl:value-of              select = "concat('CDR', 
                                           number(
                                           substring-after($docID, 'CDR')))"/>
     <xsl:text>: </xsl:text>
     <xsl:value-of              select = "substring-before(
                                           concat($cdrdocs/CdrDocCtl/
                                                  DocTitle, ';'), ';')"/> 
    </TITLE>
    <STYLE type='text/css'>
     <xsl:call-template           name = "defaultStyle"/>  
     ul.term         {margin-left: 16 ; padding-left: 0;}
    </STYLE>
   </HEAD>
   <BASEFONT                      FACE = 'Arial, Helvetica, sans-serif' />
   <xsl:apply-templates         select = "InScopeProtocol | 
                                          ScientificProtocolInfo"/>
  </HTML>
 </xsl:template>


 <!-- 
 ===================================================================
 Generate the HTML for the Organization QC Report
 =================================================================== -->
 <xsl:template                   match = "InScopeProtocol | 
                                          ScientificProtocolInfo">
  <BODY>

   <!-- 
   ==================================================================
   Display Report heading and subheading 
   ================================================================== -->
   <b>
    <font size='4'>
     <center>
      <xsl:text>Full Protocol</xsl:text>
      <br/>
      <xsl:text>QC Report</xsl:text>
     </center>
    </font>
    <font size='3'>
     <center>
      <xsl:value-of             select = "document('cdrutil:/date/%25B %25#d, %25Y %25#I:%25M% 25p')"/>
     </center>
    </font>
   </b>
   <p/>

   <!-- 
   ====================================================================
   Display CDR ID
   ==================================================================== -->
   <b>
    <font size='4'>
     <xsl:value-of              select = "concat('CDR', 
                                           number(
                                           substring-after($docID, 'CDR')))"/>
    </font>
   </b>
   <p/>

   <xsl:variable                  name = "cdrdoc" 
                                select = "document('cdrx:/*/CdrCtl')"/>
   <xsl:apply-templates/>
  </BODY>
 </xsl:template>

 <!-- 
 ================================================================
 Display a Note
 ================================================================ -->
 <xsl:template                  match = "Note">
  <xsl:apply-templates         select = "." 
                                 mode = "RS"/>
 </xsl:template>  

 <!-- 
 ================================================================
 Display a GlossaryTermRef-Patient
 ================================================================ -->
 <xsl:template                  match = "GlossaryTermRef">
  <xsl:apply-templates         select = "." 
                                 mode = "PE"/>
 </xsl:template> 

 <!-- 
 ================================================================
 Display a GlossaryTermRef-Health Professional
 ================================================================ -->
 <xsl:template                  match = "GlossaryTermRef | LOERef">
  <xsl:apply-templates         select = "."
                                 mode = "HPE" />
 </xsl:template>

</xsl:transform>
]]>
</CdrDocXml>
</CdrDoc>