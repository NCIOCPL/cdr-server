<CdrDoc Type='Filter' Id='CDR0000000159'>
<CdrDocCtl>
<DocValStatus readonly="yes">U</DocValStatus>
<DocActiveStatus readonly="yes">A</DocActiveStatus>
<DocTitle readonly="yes">Summary-Copy XML for Patient Summary Report</DocTitle>
</CdrDocCtl>
<CdrDocXml><![CDATA[<?xml version="1.0"?>
<xsl:transform xmlns:xsl="http://www.w3.org/1999/XSL/Transform"
               version="1.0"
               xmlns:cdr="cips.nci.nih.gov/cdr">
<xsl:output method="xml" omit-xml-declaration="no"/>
<!--Filter written by C.Burg/N.Gottlieb - 5/6/2002 -->

<xsl:template match="Summary">
   <xsl:copy>
   <!--==========================
      only do Patient Summaries
      ==========================-->
      <xsl:if test="SummaryMetaData/SummaryAudience='Patients'">

  <!-- <xsl:apply-templates select="document('cdrutil:/docid')" mode="copy"/>-->

  <!--==================================
       copy summary meta data, and title
      ================================== -->
      <SummaryMetaData>
         <xsl:apply-templates select="SummaryMetaData/SummaryType" mode="copy"/>
         <xsl:apply-templates select="SummaryMetaData/SummaryAudience" mode="copy"/>
         <xsl:apply-templates select="SummaryMetaData/SummaryLanguage" mode="copy"/>
      </SummaryMetaData>
      <xsl:apply-templates select="SummaryTitle" mode="copy"/>
      <xsl:for-each select="SummarySection">
   
      <!--=================================
          copy keypoints for keypoints box
          =================================-->
      <SummarySection>
        <xsl:apply-templates select="Title" mode="copy"/>
        <KeyPoints>
        <KeyPointsList Style='bullet'>
      <xsl:for-each select="SummarySection">
            
            <xsl:if test="KeyPoint">
                     
           <ListItem><xsl:value-of select="KeyPoint"/>       
               
            <xsl:for-each select="SummarySection">
             
             <xsl:if test="KeyPoint">
       <KeyPointsList Style='dash'><ListItem><xsl:value-of select="KeyPoint"/></ListItem>
             </KeyPointsList>
             </xsl:if>
             </xsl:for-each>
           
           </ListItem>
           </xsl:if>
          </xsl:for-each>
          </KeyPointsList>
          </KeyPoints>
          
         
      
         
          <!--  <xsl:for-each select=".//KeyPoint"> 
            <KeyPointBox>
              <xsl:value-of select="."/>
               </KeyPointBox>
             </xsl:for-each>-->
         <!--  ============================================
                copy indented keypoints for keypoints box
             ============================================= 
            <xsl:for-each select="SummarySection/SummarySection">
               <KeyPointBox2>
                  <xsl:value-of select="KeyPoint"/>
               </KeyPointBox2>
            </xsl:for-each>
         </KeyPoints>-->
   
            
     <!--============================================================
         copy summary sections and add references at the end of each 
         section 
         ============================================================-->
         <xsl:apply-templates select="SectMetaData" mode="copy"/>
         <xsl:apply-templates select="KeyPoint" mode="copy"/>
         <xsl:apply-templates select="Para | OrderedList |ItemizedList | SummarySection | Table"  mode="copy"/>
         <xsl:apply-templates select="PdqKey" mode="copy"/>
      </SummarySection>
      </xsl:for-each>
      </xsl:if>
   </xsl:copy>  
</xsl:template>

<!-- ================================================================
     Template rule used to do XML to XML transformations which
     copies any attribute node, or node that is child of of something
     ================================================================ -->

   <xsl:template match="@*|node()" mode="copy">
     <xsl:copy>
       <xsl:apply-templates select="@*" mode="copy"/>
       <xsl:apply-templates mode="copy"/>
     </xsl:copy> 
   </xsl:template>  


</xsl:transform>]]>
</CdrDocXml>
</CdrDoc>