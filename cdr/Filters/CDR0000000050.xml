<CdrDoc Type='Filter' Id='CDR0000000050'>
<CdrDocCtl>
<DocValStatus readonly="yes">U</DocValStatus>
<DocActiveStatus readonly="yes">A</DocActiveStatus>
<DocTitle readonly="yes">Organization QC Report Filter</DocTitle>
<ReadyForReview readonly="yes">N</ReadyForReview>
</CdrDocCtl>
<CdrDocXml><![CDATA[<?xml version="1.0"?>
   <xsl:transform xmlns:xsl="http://www.w3.org/1999/XSL/Transform"
                    version="1.0"
                  xmlns:cdr="cips.nci.nih.gov/cdr">
   <xsl:output method="html"/>
   <!--Filter written by C.Burg - 9/25/2001 -->
   <!-- minor format changes 7/10/2002 -->
   <!-- more minor changes - 6/2003 - Nanci (to work w/new denorm filters) -->
   <!-- more minor changes - 6/16/2003 - Nanci (added tables) -->
   <!-- added space after CDRID - 8/7/2003 - Nanci -->
   <!-- added Website element content - 8/18/2003 - Nanci -->

   <!-- =========================================================
          This program is a filter to create an Organization
          Content QC Report 
        =========================================================-->
   <xsl:template match="/">
      <xsl:text disable-output-escaping="yes">&lt;!DOCTYPE HTML PUBLIC '-//IETF//DTD HTML//EN' /&gt;
      </xsl:text>
      <HTML>
         <HEAD>
            <xsl:variable name="cdrmydoc" select="document('cdrx:/*/CdrCtl')"/>
            <TITLE><xsl:value-of select="document('cdrutil:/docid')"/>&#xa0;&#xa0;<xsl:value-of select="substring-before($cdrmydoc/CdrDocCtl/DocTitle,';')"/> </TITLE>
     
        <!--
       <LINK REL='stylesheet' 
           HREF='/stylesheets/protocol2.css' 
           TYPE='text/css' /> -->
        </HEAD>
        <BASEFONT FACE='Arial, Helvetica, sans-serif' />
         <xsl:apply-templates select="Organization"/>
    
      </HTML>
   </xsl:template>

   <!-- =======================================================
         Generate the HTML for the Organization QC Report
        ========================================================-->
   <xsl:template match="Organization">
      <body>
      <!-- =========================================
            Display Report heading and subheading 
           =========================================-->
<!-- <b><font size='4'><center>Organization Information QC Report QC Report</center></font></b><br />-->

    <!-- ==============================
          Display report title 
         ==============================-->
      <b><font size='4'><center><xsl:text>Organization Information QC Report</xsl:text></center></font></b>
      <b><font size='3'><center><xsl:value-of select="document('cdrutil:/date/%25B %25#d, %25Y %25#I:%25M%25p')"/></center></font></b><br /><br />

      <!-- =========================================
             Display name header 
           =========================================-->
  <p>
    <b><xsl:value-of select="document('cdrutil:/docid')"/></b>
  </p>
 
  <b><font size='4'><xsl:text>Name</xsl:text></font></b>
  <br /><br />

 <table width = '90%' cellspacing = '0'>
    <tr>
      <td width = '40%' valign = 'top'>
        <b><font size='3'>Official Name</font></b>
      </td>
      <td width = '60%'>
        <xsl:apply-templates select = "OrganizationNameInformation
                                      /OfficialName/Name"/>
      </td>
    </tr>
    <tr>
      <td><b><font size='3'>Short Name</font></b></td>
      <td><xsl:apply-templates select = "OrganizationNameInformation
                                         /ShortName"/></td>
    </tr>
  </table>


  <xsl:if  test = "OrganizationNameInformation/AlternateName">
    <table width = '90%' cellspacing = '0'>
      <tr>
        <td width = '40%' valign = 'top'>
          <b><font size='3'>Alternate Name</font></b>
        </td>
        <td width = '60%'>
          <table>
            <xsl:for-each select = "OrganizationNameInformation/AlternateName">
              <tr>
                <td><xsl:value-of select="."/></td>
              </tr>     
            </xsl:for-each>
          </table>
        </td>
      </tr>
    </table>
 
  </xsl:if>

  <br />

  <table width = '90%'>
    <xsl:if  test = "OrganizationNameInformation/FormerName">
      <tr>
        <td width = '40%' valign = 'top'>
          <b><font size='3'>Former Name</font></b>
        </td>
        <td width = '60%'>
          <xsl:for-each select="OrganizationNameInformation/FormerName">
            <table>
              <tr>
                <td><xsl:value-of select="."/></td>
              </tr>
            </table>
          </xsl:for-each>
        </td>
      </tr>
    </xsl:if>
  </table>

  <!-- can't find any OrganizationInformation/Comments to test this -->
  <xsl:if test="OrganizationInformation/Comment">
    <table width = '90%'>
      <tr>
        <td width = '40%'><b><font size='3'>Comment</font></b></td>
        <td width = '60%'>
          <xsl:apply-templates select="OrganizationInformation/Comment"/>
        </td>
      </tr>
    </table>
  </xsl:if>

  <b><font size='4'><xsl:text>Parent Organization</xsl:text></font></b>
  <br />
   <table width = '90%' cellspacing = '0'>
    <xsl:for-each  select = "OrganizationParent">
      <tr>
        <td width = '40%'><b><font size='3'>Name</font></b></td>
        <td width = '60%'><xsl:value-of select = "."/></td>
      </tr>
    </xsl:for-each>
  </table>
  <br />

   <!-- ==============================================================
         Display Administrative Information 
        ==============================================================-->

  <b><font size='4'>Administrative Information</font></b>
  <br />
 
  <p>
  <table width = '90%'>   
    <tr>
      <td width = '3%'></td>
      <td width = '37%' valign = 'top'>
        <b><font size='3'>CIPS Contact Person</font></b>
      </td>
      <td width = '60%'>
        <table>
          <xsl:for-each select = "OrganizationDetails/CIPSContactPerson/Person
                                 /PersonNameInformation">
            <tr>
              <td>
                <xsl:value-of select="GivenName"/>&#xa0;
                <xsl:value-of select="SurName"/>
              </td>
            </tr>
          </xsl:for-each>
        </table>
      </td>
    </tr>
    <tr>
      <xsl:for-each  select = "OrganizationDetails/
                               OrganizationAdministrativeInformation
                               /@Directory">
        <td></td>
        <td>
          <b><font size='3'><xsl:text>Directory Type</xsl:text></font></b>
        </td>
        <td><xsl:value-of  select = "."/></td>
      </xsl:for-each>
    </tr>
    <xsl:if test = "OrganizationDetails/
                   OrganizationAdministrativeInformation
                   /IncludeInDirectory = 'Include'">
      <tr>
        <td></td>
        <td><b><font size='3'>Include</font></b></td>
        <td><xsl:text>Yes</xsl:text></td>
      </tr>
    </xsl:if>
    <xsl:if test = "OrganizationDetails/
                    OrganizationAdministrativeInformation/
                    IncludeInDirectory = 'Do not include'">
      <tr>
        <td></td>
        <td><b><font size='3'>Include</font></b></td>
        <td>No</td>
      </tr>
    </xsl:if>
  </table>

  <xsl:for-each  select = "OrganizationDetails
                           /OrganizationAdministrativeInformation"> 
    <table width = '90%'>
      <tr>
        <td width = '3%'>&#xa0;</td>
        <td width = '37%'><b>Date</b></td>
        <td width = '60%'><xsl:value-of select = "Date"/></td>
      </tr>
    </table>
    <table width = '90%'>
      <tr>
        <td width = '3%'>&#xa0;</td>
        <td width = '97%'><b>Comment</b></td>
      </tr>
      <tr>
        <td></td>
        <td><xsl:value-of select="Comment"/></td>
      </tr>
    </table>
  </xsl:for-each>

  <table width = '90%'>
    <xsl:for-each select="Status">
      <tr>
        <td width = '3%'>&#xa0;</td>
        <td width = '37%'><b><font size='3'>Current Status</font></b></td>
        <td width = '60%'><xsl:value-of   select = "CurrentStatus"/></td>
      </tr>
    </xsl:for-each>

    <xsl:if test = "OrganizationType">
      <tr>
        <td></td>
        <td valign = 'top'><b><font size='3'>Organization Type</font></b></td>
        <td>
          <table cellspacing = '0'>
            <xsl:for-each select="OrganizationType">
              <tr>
                <td><xsl:value-of select="."/></td>
                <td>&#xa0;</td>
                <xsl:if test="@Public">
                  <td>(Public=No)</td>
                </xsl:if>
              </tr>
            </xsl:for-each>
          </table>
        </td>
      </tr>
    </xsl:if>  
  </table> 

  <xsl:if test = "ProtocolIDAcronym">
    <table width = '90%'>
      <tr>
        <td width = '3%'>&#xa0;</td>
        <td width = '37%' valign = 'top'>
          <b><font size='3'>Protocol ID Acronym</font></b>
        </td>
        <td width = '60%'>
          <table cellspacing = '0'>
            <tr>
              <xsl:for-each select="ProtocolIDAcronym">
                <td><xsl:value-of select="."/></td>
              </xsl:for-each>
            </tr>
          </table>
        </td>
      </tr>
    </table>
  </xsl:if>


<!--<xsl:text>&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;</xsl:text>
       <b>
          <font size='3'>
             <xsl:text>Preferred Contact Mode</xsl:text>
          </font>
       </b>
       <xsl:for-each select="OrganizationDetails/OrganizationAdministrativeInformation">
          <xsl:value-of select="concat('.................',PreferredContactMode)"/><br />
       </xsl:for-each>  -->
   </p> 

   <!-- ==================================================
         Display locations for Organization 
        ==================================================-->

<!--  <br /> -->
  <b><font size='4'>Location Information</font></b>
  <br />
  <br />

  <xsl:for-each  select = "OrganizationLocations/OrganizationLocation">
    <xsl:variable name = "cipscontact"  select = "../CIPSContact"/>
    <xsl:if   test = "@cdr:id=$cipscontact">
      <b><font size='4'>CIPS Contact</font></b>
      <br />
    </xsl:if>

    <xsl:if        test = "@IncludeParentName">
      <xsl:for-each select = "Location/OrganizationAddressNames
                              /OrganizationName">
        <xsl:value-of select="."/>
      <br />
      </xsl:for-each>
    </xsl:if>

    <xsl:for-each    select = "PostalAddress/Street">
      <xsl:value-of  select = "."/>
      <br />
    </xsl:for-each>

    <xsl:if   test = "PostalAddress/PostalCodePosition = 'before City'">
      <xsl:value-of  select = "PostalAddress/PostalCode_ZIP"/>&#xa0;
      <xsl:if        test = "PostalAddress/CitySuffix">
        <xsl:value-of  select = "concat(PostalAddress/City,' ',
                                 PostalAddress/CitySuffix)"/>
      </xsl:if> 
      <xsl:if            test = "not(PostalAddress/CitySuffix)">   
        <xsl:value-of  select = "PostalAddress/City"/>
      </xsl:if> 
      <xsl:value-of select = "PostalAddress/PoliticalSubUnitShortName"/>
      <br />

      <xsl:value-of    select = "PostalAddress/CountryName"/>
      <xsl:if            test   = "PostalAddress/@AddressType='Non-US'">
      <xsl:value-of      select ="concat('   (',PostalAddress/
                                  @AddressType,')')"/>
      </xsl:if>
  
      <br />
    </xsl:if>

    <xsl:if      test = "PostalAddress/PostalCodePosition='after City'">
      <xsl:if    test = "PostalAddress/CitySuffix">
        <xsl:value-of   select = "concat(PostalAddress/City,' ',
                                  PostalAddress/CitySuffix)"/>
      </xsl:if> 
      <xsl:if    test = "not(PostalAddress/CitySuffix)">   
        <xsl:value-of    select = "PostalAddress/City"/>,
      </xsl:if>
      <xsl:value-of      select = "PostalAddress/PostalCode_ZIP"/>&#xa0;
      <xsl:value-of      select = "PostalAddress/PoliticalSubUnitShortName"/>
      <br />
      <xsl:value-of      select = "PostalAddress/CountryName"/>
      <xsl:if            test   = "PostalAddress/@AddressType='Non-US'">
      <xsl:value-of      select ="concat('   (',PostalAddress/
                                  @AddressType,')')"/>
      </xsl:if>
  
      <br />
    </xsl:if>

    <xsl:if      test = "PostalAddress/PostalCodePosition=
                        'after PoliticalSubUnit_State'">
      <xsl:if test="PostalAddress/CitySuffix">
        <xsl:value-of   select = "concat(PostalAddress/City,' ',
                                 PostalAddress/CitySuffix)"/>
      </xsl:if> 
      <xsl:if    test = "not(PostalAddress/CitySuffix)">   
        <xsl:value-of   select = "PostalAddress/City"/>,
      </xsl:if>
      <xsl:value-of select = "PostalAddress/PoliticalSubUnitShortName"/>&#xa0;
      <xsl:value-of select = "PostalAddress/PostalCode_ZIP"/>
      <br />
      <xsl:value-of select = "PostalAddress/CountryName"/>
      <xsl:if            test   = "PostalAddress/@AddressType='Non-US'">
      <xsl:value-of      select ="concat('   (',PostalAddress/
                                  @AddressType,')')"/>
      </xsl:if>
  
      <br />
    </xsl:if>

    <xsl:if     test = "PostalAddress/Country/PostalCodePosition=
                       'after Country'">
      <xsl:if   test = "PostalAddress/CitySuffix">
        <xsl:value-of  select = "concat(PostalAddress/City,' ',
                                PostalAddress/CitySuffix)"/>
      </xsl:if> 
      <xsl:if   test = "not(PostalAddress/CitySuffix)">   
        <xsl:value-of  select = "PostalAddress/City"/>,
      </xsl:if>
      <xsl:value-of select = "PostalAddress/PoliticalSubUnitShortName"/>&#xa0;
      <br />
      <xsl:value-of select = "PostalAddress/PostalCode_ZIP"/>
      <br />
      <br />
      <xsl:value-of select = "PostalAddress/CountryName"/>
    </xsl:if>  

    <table width = '90%' cellspacing = '0'>
      <tr>
        <td width = '20%'>Phone:</td>
        <td width = '80%'>
          <xsl:value-of select = "Phone"/>&#xa0;
          <xsl:if test="Phone/@Public">
            <xsl:text>(Public=</xsl:text>
            <xsl:value-of select="Phone/@Public"/>
            <xsl:text>)</xsl:text>
          </xsl:if>
        </td>
      </tr>
      <tr>
        <td>Fax:</td>
        <td><xsl:value-of select = "Fax"/></td>
      </tr>
      <tr>
        <td>Email:</td>
        <td>
          <u><xsl:value-of select="Email"/></u>&#xa0;
          <xsl:if test = "Email/@Public">
            <xsl:text>(Public=</xsl:text>
            <xsl:value-of select = "Email/@Public"/>
            <xsl:text>)</xsl:text>
          </xsl:if>
        </td>
      </tr>
      <tr>
        <td>Website:</td>
        <td><u><xsl:value-of select = "WebSite/@xref"/></u></td>
      </tr>
      <tr>
        <td></td>
        <td><xsl:value-of    select = "WebSite"/></td>
      </tr>
    </table>
    <br />
  </xsl:for-each>

<!-- ==========================================
      Display Organization Affiliations
     ==========================================-->

      <b><font size='4'>Organization Affiliations</font></b><br /><br />

   <!--   <b><font size='3'>Research Base For</font></b><br /><br />-->

  <xsl:if test="OrganizationAffiliations/MemberOfProfessionalOrganization">
    <b><font size='3'>Professional Organization Membership</font></b><br />
    <xsl:for-each select = "OrganizationAffiliations/
                            MemberOfProfessionalOrganization"> 
      <xsl:value-of select="."/>
      <br />
    </xsl:for-each>
  </xsl:if>
  <br />

  <b><font size='3'>Cooperative Group Membership</font></b>
  <br />
  <table width = '90%'>
    <tr>
      <td width = '3%'></td>
      <td width = '97%'><b><font size='3'>Main Member of</font></b> </td>
    </tr>
    <xsl:if test = "OrganizationAffiliations/MemberOfCooperativeGroups
                   /MainMemberOf">
      <xsl:for-each select = "OrganizationAffiliations/
                             MemberOfCooperativeGroups/MainMemberOf">
        <tr>
          <td></td>
          <td>
            <xsl:value-of select = "CooperativeGroup/Organization
                                   /OrganizationNameInformation/OfficialName
                                   /Name"/>
          </td>
        </tr>
        <tr>
          <td></td>
          <td>
            <xsl:if  test = "ProtocolParticipation">
              <table width = '90%' cellspacing = '0'>
                <tr>
                  <td width = '60%'>Protocol Participation</td>
                  <td width = '40%'>
                    <xsl:apply-templates select="ProtocolParticipation"/>
                  </td>
                </tr>
              </table> 
            </xsl:if> 
          </td>
        </tr>
      </xsl:for-each>  
    </xsl:if>    
  </table>

  <xsl:if test = "OrganizationAffiliations/
                  MemberOfCooperativeGroups/AffiliateMemberOf">
    <br />
    <table width = '90%' cellspacing = '0'>
       <tr>
         <td width = '3%'></td>
         <td width = '97%'><b><xsl:text>Affiliate Member Of</xsl:text></b></td>
       </tr>
     </table>

   <!--
   <xsl:for-each select="OrganizationAffiliations/MemberOfCooperativeGroups/AffiliateMemberOf">
      <xsl:value-of select="concat('&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;',CooperativeGroup/Name)"/> 
   </xsl:for-each>-->

  </xsl:if>

  <xsl:for-each  select = "//OrganizationAffiliations/MemberOfCooperativeGroups
                          /AffiliateMemberOf">
    <table width = '90%'>
      <tr>
        <td width = '3%'>&#xa0;</td>
        <td width = '37%'>Cooperative Group</td>
        <td width = '60%'>
          <xsl:value-of  select = "CooperativeGroup/Organization
                                  /OrganizationNameInformation/OfficialName
                                  /Name"/>
        </td>
      </tr>
      <tr>
        <td></td>
        <td>Main Member</td>
        <td>
          <xsl:value-of  select = "MainMember/Organization
                                  /OrganizationNameInformation/OfficialName
                                  /Name"/>
        </td>
      </tr>
      <xsl:if  test = "ProtocolParticipation">
        <tr>
          <td></td>
          <td>Protocol Participation</td>
          <td><xsl:value-of  select = "ProtocolParticipation"/></td>
        </tr>
      </xsl:if>
    </table>
  </xsl:for-each>

  <br />
  <b><font size='3'>CCOP Group Membership</font></b><br />

  <xsl:for-each select = "OrganizationAffiliations/MemberOfCCOP/CCOP
                         /Organization/OrganizationNameInformation
                         /OfficialName/Name">
    <xsl:value-of select="."/><br />
  </xsl:for-each><br />

      <b><font size='3'>AdHoc Group Membership</font></b><br /> 
  <xsl:for-each   select = "OrganizationAffiliations/MemberOfAdHocGroup
                           /Organization/OrganizationNameInformation
                           /OfficialName/Name">
    <xsl:value-of  select = "."/>
    <br />
  </xsl:for-each>
  <br />

    <b><font size='3'>Research Base For</font></b><br /><br />

  <xsl:for-each   select = "OrganizationAffiliations/ResearchBaseFor
                           /Organization/OrganizationNameInformation
                           /OfficialName/Name">
    <xsl:value-of  select = "."/>
    <br />
  </xsl:for-each>
  <br />  

  <b><font size='4'>Record Information</font></b><br /><br />
  <table width = '90%' cellspacing = '0'>
    <xsl:for-each select="CdrDocCtl">
      <tr>
        <td width = '3%'>&#xa0;</td>
        <td width = '32%'><b>Date created</b></td>
        <td width = '65%'>
          <xsl:value-of select="substring-before(Create/Date,'T')"/>
        </td>
      </tr>
      <tr>
        <td></td>
        <td><b>User</b></td>
        <td><xsl:value-of select="Create/User"/></td>
      </tr>
      <tr>
        <td></td>
        <td><b>Date Modfied</b></td>
        <td><xsl:value-of select="substring-before(Modify/Date,'T')"/></td>
      </tr>
      <tr>
        <td></td>
        <td><b>User</b></td>
        <td><xsl:value-of select="Modify/User"/></td>
      </tr>
    </xsl:for-each>
  </table>
   
  <br />
  <b><font size='4'>Dated Action</font></b>
  <br />
  <xsl:apply-templates select="DatedAction"/>
  <br />

   
   <!-- =================================================================
        Display most recent Mailer Information
     ================================================================= -->

  <b><font size='4'>Most Recent Mailer</font></b><br /><br />

  <table width = '90%' cellspacing = '0'>
    <tr>
      <td width = '3%'>&#xa0;</td>
      <td width = '32%'>
        <b><font size='3'>Date Sent</font></b>
      </td>
      <td width = '65%'>@@MAILER_DATE_SENT@@</td>
    </tr>
    <tr>
      <td></td>
      <td><b><font size='3'>Date Received</font></b></td>
      <td>@@MAILER_RESPONSE_RECEIVED@@</td>
    </tr>
    <tr>
      <td></td>
      <td><b><font size='3'>Type of Change</font></b></td>
      <td>@@MAILER_TYPE_OF_CHANGE@@</td>
    </tr>
  </table>

  <br />

     </body>

 </xsl:template>

  </xsl:transform>]]>
</CdrDocXml>
</CdrDoc>