<?xml version="1.0"?>
<!-- ===========================================================
      Filter to generate a Protocol Citations QC Report
     ============================================================ -->

<xsl:transform           xmlns:xsl="http://www.w3.org/1999/XSL/Transform"
                           version="1.0"
                         xmlns:cdr="cips.nci.nih.gov/cdr">
   
 <xsl:output method="html"/>

 <!-- ==========================================================
                    Generate the report title and date 
      ========================================================== -->
 <xsl:template match="/">
  
  <!-- <!DOCTYPE HTML PUBLIC '-//IETF//DTD HTML//EN' /> -->
    <HTML>
    <HEAD>
    <xsl:variable name="cdrmydoc" select="document('cdrx:/*/CdrCtl')"/>

    <TITLE><xsl:value-of select="document('cdrutil:/docid')"/>&#xa0;&#xa0;<xsl:value-of select="substring-before($cdrmydoc/CdrDocCtl/DocTitle,';')"/></TITLE>
     <!--
     <LINK REL='stylesheet' 
           HREF='/stylesheets/protocol2.css' 
           TYPE='text/css' /> -->
    </HEAD>
    <BASEFONT FACE='Arial, Helvetica, sans-serif' /> 
    <xsl:apply-templates select="InScopeProtocol"/>
    </HTML>
    </xsl:template>
    <xsl:template match="InScopeProtocol">
    <BODY>
  
  <b><font size='4'><center>Protocol Citations QC Report</center></font></b>
  <b><font size='3'><center><xsl:value-of select="document('cdrutil:/date/%25B %25#d, %25Y %25#I:%25M%25p')"/></center></font></b><br /><br />


<!-- ====================================================================
      Display CDR ID, Protocol ID ( Primary and Others )
     ==================================================================== -->
 
<b><font size='3'>DocID </font></b><xsl:text>...................................................</xsl:text> 
<xsl:value-of select="document('cdrutil:/docid')"/><br />
<b><font size='3'>Protocol ID</font></b><br />
<xsl:text>&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;</xsl:text>
<b><font size='3'>Primary ID</font></b><xsl:text>....................................</xsl:text>
<xsl:apply-templates select="ProtocolIDs/PrimaryID/IDString"/><br />
<xsl:text>&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;</xsl:text>
<b><font size='3'>Other IDs</font></b><xsl:text>......................................</xsl:text>
<xsl:for-each select="ProtocolIDs/OtherID">
<xsl:value-of select="IDString"/>
<xsl:if test="position()!=last()">,</xsl:if>
</xsl:for-each>
<br /><br />

<!-- ==============================================================
                       Display Protocol Titles
     =============================================================== -->

<b><font size='4'>Original Protocol Title</font></b><br />
  <xsl:apply-templates select="ProtocolTitle[@Type='Original']"/><br /><br />
  
<b><font size='4'>Professional Title</font></b><br />
  <xsl:apply-templates select="ProtocolTitle             [@Type='Professional']"/><br /><br />

<!-- ================================================================
                    Display Protocol Chairman
     ================================================================ -->

<b><font size='4'>Protocol Chairman</font></b>
<xsl:text>.......................</xsl:text>

  <xsl:for-each select="ProtocolAdminInfo/ProtocolLeadOrg/LeadOrgPersonnel/Person">
   <xsl:if test="../../LeadOrgRole='Primary'">
  <xsl:value-of select="PersonNameInformation/SurName"/>,
  <xsl:value-of select="PersonNameInformation/GivenName"/>
  </xsl:if>
  </xsl:for-each>
<hr />

<!-- ==============================================================
                Display Published Results/Format Citation 
     =============================================================== -->

<b><i><font size='4'>Published Results</font></i></b><br /><br />

<xsl:for-each select="PublishedResults/Citation/CitationText">

<b><font size='3'>Citation ID</font></b>
<xsl:text>...............................</xsl:text>
<xsl:value-of select="../@ref"/><br /><br />
<xsl:choose>
<xsl:when test="../CancerLitID">
<b><font size='3'>CANCERLIT ID</font></b>
<xsl:text>.......................</xsl:text>
<xsl:value-of select="../CancerLitID"/><br /><br />
</xsl:when>
<xsl:when test="../PMID">
<b><font size='3'>PUBMED ID</font></b>
<xsl:text>............................</xsl:text>
<xsl:value-of select="../PMID"/><br /><br />
</xsl:when>
<xsl:otherwise>
<b><font size='3'>CANCERLIT ID</font></b>
<xsl:text>.......................</xsl:text><br /><br />
</xsl:otherwise>
</xsl:choose>


<b><font size='3'>Citation</font></b><br />
<xsl:value-of select="."/><br /><br />
<b><font size='3'>Abstract</font></b><br />
<xsl:value-of select="../AbstractText"/>
<hr />
</xsl:for-each>

</BODY>
</xsl:template>
  </xsl:transform>