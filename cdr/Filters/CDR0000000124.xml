<CdrDoc Type='Filter' Id='CDR0000000124'>
<CdrDocCtl>
<DocValStatus readonly="yes">U</DocValStatus>
<DocActiveStatus readonly="yes">A</DocActiveStatus>
<DocTitle readonly="yes">InScopeProtocol HP Citations QC Report</DocTitle>
<DocComment>CVS-V1.5: Note Label Display (Bug 892)</DocComment><ReadyForReview readonly="yes">N</ReadyForReview>
</CdrDocCtl>
<CdrDocXml><![CDATA[<?xml      version = "1.0"?>
<!--
 ================================================================
     $Id: CDR0000000124.xml,v 1.9 2004-08-04 19:35:20 venglisc Exp $

     Filter to generate a Protocol Citations QC Report
        Written by Cheryl Burg

     $Log: not supported by cvs2svn $
 ================================================================ -->
<xsl:transform               xmlns:xsl = "http://www.w3.org/1999/XSL/Transform"
                               version = "1.0"
                             xmlns:cdr = "cips.nci.nih.gov/cdr">
   
 <xsl:output                    method = "html"/>
 
 <xsl:include  href = "cdr:name:Module: Attribute Sets"/>

 <xsl:variable                    name = "docID"
                                select = "document('cdrutil:/docid')"/>

 <!-- 
 ===========================================================
 Generate the report title and date 
 =========================================================== -->
 <xsl:template match="/"> 
  <!-- <!DOCTYPE HTML PUBLIC '-//IETF//DTD HTML//EN' /> -->
  <HTML>
   <HEAD>
    <xsl:variable                 name = "cdrdocs" 
                                select = "document('cdrx:/*/CdrCtl')"/>
    <TITLE>
     <xsl:value-of              select = "concat('CDR', 
                                           number(
                                           substring-after($docID, 'CDR')))"/>
     <xsl:text>: </xsl:text>
     <xsl:value-of              select = "substring-before(
                                           concat($cdrdocs/CdrDocCtl/
                                                  DocTitle, ';'), ';')"/> 
    </TITLE>
   </HEAD>
   <BASEFONT FACE='Arial, Helvetica, sans-serif' /> 
   <xsl:apply-templates         select = "Protocol"/>
  </HTML>
 </xsl:template>

 <!-- 
 ====================================================================
 Main Protocol Template
 ==================================================================== -->
 <xsl:template                   match = "Protocol">
  <BODY>
   <b>
    <font size='4'>
     <center>Protocol Citations<br /> QC Report</center>
    </font>
    <center>
     <xsl:value-of              select = "document('cdrutil:/date/%25B %25#d, %25Y %25#I:%25M%25p')"/>
    </center>
   </b>
   <br />

   <!-- 
   ====================================================================
   Display CDR ID, Protocol ID ( Primary and Others )
   ==================================================================== -->
   <b>
    <font size='4'>
     <xsl:value-of              select = "concat('CDR', 
                                          number(
                                          substring-after(@id, 'CDR')))"/>
    </font>
   </b>
   <p/>  

   <table       xsl:use-attribute-sets = "table">
    <tr>
     <td        xsl:use-attribute-sets = "cell1of2">
      <u>
       <b>
        <font size='4'>Protocol ID</font>
       </b>
      </u>
     </td>
    </tr>
   </table>

   <table       xsl:use-attribute-sets = "table"> 
    <tr>
     <td        xsl:use-attribute-sets = "cell1of2">
      <b>Primary ID</b>
     </td>
     <td        xsl:use-attribute-sets = "cell2of2">
      <xsl:value-of             select = "ProtocolIDs/
                                          PrimaryID/
                                          IDString"/>
     </td>
    </tr>
   </table>

   <table       xsl:use-attribute-sets = "table">
    <tr>
     <td        xsl:use-attribute-sets = "cell1of2">
      <b>Other IDs</b>
     </td>
     <td        xsl:use-attribute-sets = "cell2of2">
      <xsl:for-each             select = "ProtocolIDs/OtherID">
       <xsl:value-of            select = "IDString"/>
       <xsl:if                    test = "position() != last()">
        <xsl:text>,&#xa0;</xsl:text>
       </xsl:if>
      </xsl:for-each>
     </td>
    </tr>
   </table>
   <br/>

   <!-- 
   ==============================================================
   Display Protocol Titles
   ============================================================== -->
   <table       xsl:use-attribute-sets = "table">
    <tr>
     <td        xsl:use-attribute-sets = "cell1of2">
      <b>
       <font size='4'>Original Protocol Title</font>
      </b>
     </td>
     <td>
      <xsl:apply-templates      select = "ProtocolTitle[@Audience='Original']"/>
     </td>
    </tr>
   </table>
   <br />

   <table       xsl:use-attribute-sets = "table">
    <tr>
     <td        xsl:use-attribute-sets = "cell1of2">
      <b>
       <font size='4'>Professional Title</font>
      </b>
     </td>
     <td        xsl:use-attribute-sets = "cell2of2">
      <xsl:apply-templates      select = "ProtocolTitle[@Audience=
                                                          'Professional']"/>
     </td>
    </tr>
   </table>
   <br />

   <!-- 
   ================================================================
   Display Protocol Chairman
   ================================================================ -->
   <table       xsl:use-attribute-sets = "table">
    <tr>
     <td        xsl:use-attribute-sets = "cell1of2">
      <b>
       <font size='4'>Protocol Chairman</font>
      </b>
     </td>
     <td        xsl:use-attribute-sets = "cell2of2">
      <xsl:for-each             select = "ProtocolAdminInfo/
                                          ProtocolLeadOrg/
                                          LeadOrgPersonnel/
                                          ProtPerson/
                                          PersonNameInformation">
                                       


       <xsl:if                    test = "../../../LeadOrgRole = 'Primary'">
        <xsl:value-of           select = "SurName"/>,
        <xsl:value-of           select = "GivenName"/>
       </xsl:if>
       <br />
      </xsl:for-each>
     </td>
    </tr>
   </table>
   <hr />

   <!-- 
   ==============================================================
   Display Published Results/Format Citation 
   ============================================================== -->
   <b>
    <i>
     <font size='4'>Published Results</font>
    </i>
   </b>
   <p/>

   <xsl:for-each                select = "PublishedResults">
    <table      xsl:use-attribute-sets = "table">
     <tr>
      <td       xsl:use-attribute-sets = "cell1of2">
       <b>Citation ID</b>
      </td>
      <td       xsl:use-attribute-sets = "cell2of2">
       <xsl:value-of            select = "concat('CDR', number(
                                              substring-after(@ref, 'CDR')))"/>
    
      </td>
     </tr>
    </table>
 
    <xsl:if                       test = "@PMID">
     <table     xsl:use-attribute-sets = "table">
      <tr>
       <td      xsl:use-attribute-sets = "cell1of2">
        <b>PUBMED ID</b>
       </td>
       <td      xsl:use-attribute-sets = "cell2of2">
        <xsl:value-of           select = "@PMID"/>
       </td>
      </tr>
     </table>
    </xsl:if>

    <table      xsl:use-attribute-sets = "table">
     <tr>
      <td       xsl:use-attribute-sets = "cell1of2">
       <b>Citation</b>
      </td>
      <td       xsl:use-attribute-sets = "cell2of2">
       <xsl:value-of            select = "."/>
      </td>
     </tr>
    </table>
    <hr />
   </xsl:for-each>

  </BODY>
 </xsl:template>


 <!-- 
 ================================================================
 Display a Note
 ================================================================ -->
 <xsl:template                  match = "Note">
  <xsl:apply-templates         select = "." 
                                 mode = "RS"/>
 </xsl:template>  

</xsl:transform>]]>
</CdrDocXml>
</CdrDoc>