<CdrDoc Type='Filter' Id='CDR0000256346'>
<CdrDocCtl>
<DocValStatus readonly="yes">U</DocValStatus>
<DocActiveStatus readonly="yes">A</DocActiveStatus>
<DocTitle readonly="yes">InLine Markup Formatter</DocTitle>
<ReadyForReview readonly="yes">N</ReadyForReview>
</CdrDocCtl>
<CdrDocXml><![CDATA[<?xml version="1.0"?>
<xsl:transform             xmlns:xsl = "http://www.w3.org/1999/XSL/Transform"
                             version = "1.0"
                           xmlns:cdr = "cips.nci.nih.gov/cdr"
             exclude-result-prefixes = "cdr">
  
<!-- ======================================================================
      Display a Summary Reference, SummaryFragmentRef or LOEFragmentRef or 
      ProtocolRef
     ====================================================================== -->
    <xsl:template              match = "SummaryRef | ProtocolRef |
                                        SummaryFragmentRef | 
                                        LOEFragmentRef">
     <u><xsl:apply-templates/></u>
    </xsl:template>

<!-- ======================================================================
                       Link to glossaryTermRefs 
     ====================================================================== -->
    <xsl:template              match = "GlossaryTermRef | LOERef">
                                                                             
     <xsl:choose>
     <xsl:when                  test = "Deletion">
      <a>
      <xsl:attribute            name = "href">
       <xsl:value-of          select = "concat('/cgi-bin/cdr/Filter.py?',
                                               'DocId=', @cdr:href,
                                               '&amp;Filter=name:Glossary',
                                               '+Term+Display+for+Patient',
                                               '+Summaries')"/>
      </xsl:attribute>
      <strike>
      <xsl:value-of           select = "."/>
      </strike>
     </a>
    </xsl:when>
    <xsl:otherwise>
     <a>
      <xsl:attribute            name = "href">
       <xsl:value-of          select = "concat('/cgi-bin/cdr/Filter.py?',
                                               'DocId=', @cdr:href,
                                               '&amp;Filter=name:Glossary',
                                               '+Term+Display+for+Patient',
                                               '+Summaries')"/>
      </xsl:attribute>
      <xsl:value-of           select = "."/>
     </a>
     </xsl:otherwise>
     </xsl:choose>
      </xsl:template>


    
<!-- =====================================================================
                Display Itemized Lists for KeyPoints
     ===================================================================== -->
   <xsl:template              match = "KeyPointsList[@Style='bullet'] |
                                       KeyPointsList[@Style='dash']">
     <ul>
     <xsl:for-each            select = "ListItem">
      <li>
      <xsl:choose>
       <xsl:when                test = "../@Style='bullet'">
        <xsl:attribute          name = "type">
         <xsl:text>disc</xsl:text>
        </xsl:attribute>
       </xsl:when>
       <xsl:when                test = "../@Style='dash'">
        <xsl:attribute          name = "type">
         <xsl:text>square</xsl:text>
        </xsl:attribute>
       </xsl:when>
      </xsl:choose>                               
      <xsl:apply-templates/>
      </li>
     </xsl:for-each>
     </ul>
    </xsl:template>
                       
<!-- =====================================================================
                Display an itemized list
     ===================================================================== -->
   <xsl:template              match = "ItemizedList">   
  
     <xsl:apply-templates     select = "ListTitle"/>
 
     <!-- Handle ListItem now. -->
     <ul>
     <xsl:for-each            select = "ListItem"> 
     <xsl:call-template        name = "ItemizedListItem"/>
    
    
      <!-- Take care of extra attributes. -->
      <xsl:if                   test = "position() != last() and
                                        ../@Compact = 'No'">
       <br /><br />
      </xsl:if>
     </xsl:for-each>    
     </ul>  
    </xsl:template>  
 
<!-- =====================================================================
                       Display an ordered list 
     ===================================================================== -->
    <xsl:template              match = "OrderedList">   
      
       
     <xsl:apply-templates     select = "ListTitle"/>     

     <!-- Handle ListItem now. -->
     <ol>
     <xsl:attribute             name = "Class">
      <xsl:choose>
       <xsl:when                test = "@Style = 'UAlpha'">        
        <xsl:text>A</xsl:text>
       </xsl:when>
       <xsl:when                test = "@Style = 'LAlpha'">
        <xsl:text>little-alpha</xsl:text>
       </xsl:when>
       <xsl:when                test = "@Style = 'URoman'">
        <xsl:text>I</xsl:text>
       </xsl:when>
       <xsl:when                test = "@Style = 'LRoman'">
        <xsl:text>little-roman</xsl:text>
       </xsl:when>
       <xsl:otherwise>
        <xsl:text>d</xsl:text>
       </xsl:otherwise>
      </xsl:choose>
     </xsl:attribute>

     <xsl:for-each            select = "ListItem">
      <li>  
           <xsl:apply-templates/>
      </li>
    
      <!-- Take care of extra attribute compact. -->
      <xsl:if                   test = "position() != last() and
                                        ../@Compact = 'No'">
      
       <br />
       <br /> 
       </xsl:if>
       </xsl:for-each>
       </ol>
       </xsl:template>        
 
<!-- =====================================================================
                     Display a Subscript 
     ===================================================================== -->
    <xsl:template              match = "Subscript">
     <sub><xsl:apply-templates/></sub>
    </xsl:template>

<!-- =====================================================================
                     Display a Superscript 
     ===================================================================== -->
    <xsl:template              match = "Superscript">
     <sup><xsl:apply-templates/></sup>
    </xsl:template>

<!-- =====================================================================
                     Display Strong 
     ===================================================================== -->
    <xsl:template              match = "Strong">
     <b><xsl:apply-templates/></b>
    </xsl:template>

<!-- =====================================================================
       Display Emphasis, ScientificName, ForeignWord, GeneName
     ===================================================================== -->
    <xsl:template              match = "Emphasis | ScientificName |
                                        ForeignWord | GeneName">
     <i><xsl:apply-templates/></i>
    </xsl:template>

<!-- =====================================================================
                         Display a note        
     ===================================================================== -->
    <xsl:template              match = "Note" mode="R">
    <xsl:choose>
     <xsl:when                 test  = "Insertion/@RevisionLevel='approved'">
     <i>
     <font color="RED">
      <xsl:text> [</xsl:text>
      </font>
     </i>
     </xsl:when>
      <xsl:when                 test  = "Insertion/@RevisionLevel='proposed'">
      <i>
     <font color="FUCHSIA">
      <xsl:text> [</xsl:text>
     </font>
     </i>
     </xsl:when>
     <xsl:when                 test  = "Deletion/@RevisionLevel='approved'">
      <i>
     <xsl:text> [</xsl:text>
     </i>
     </xsl:when>
    <xsl:when                 test  = "Deletion/@RevisionLevel='proposed'">
     <strike>
      <i>
     <font color="FUCHSIA">
     <xsl:text> [</xsl:text>
     </font>
     </i>
     </strike>
     </xsl:when>
     <xsl:otherwise>
      <i>
      <xsl:text> [</xsl:text>
      </i>
     </xsl:otherwise>
     </xsl:choose>
     <xsl:choose>
     <xsl:when                 test = "//SummaryLanguage ='Spanish'"> 
     <xsl:choose>
     <xsl:when                 test  = "Insertion/@RevisionLevel='approved'">
     <i>
     <font color="RED">
     <xsl:text>Nota: </xsl:text>
     </font>
      </i>
     </xsl:when>
      <xsl:when                 test  = "Insertion/@RevisionLevel='proposed'">
      <i>
     <font color="FUCHSIA">
     <xsl:text>Nota: </xsl:text>
     </font>
     </i>
     </xsl:when>
     <xsl:when                 test  = "Deletion/@RevisionLevel='approved'">
     <i>
     <xsl:text>Nota: </xsl:text>
     </i>
     </xsl:when>
     <xsl:when                 test  = "Deletion/@RevisionLevel='proposed'">
     <strike>
     <i>
     <font color="FUCHSIA">
     <xsl:text>Nota: </xsl:text>
     </font>
     </i>
     </strike>
     </xsl:when>
     <xsl:otherwise>
      <i>
     <xsl:text>Nota: </xsl:text>
      </i>
     </xsl:otherwise>
     </xsl:choose>
     </xsl:when>
     <xsl:otherwise>
     <xsl:choose>
     <xsl:when                 test  = "Insertion/@RevisionLevel='approved'">
     <i>
     <font color="RED">
     <xsl:text>Note: </xsl:text>
     </font>
     </i>
     </xsl:when>
      <xsl:when                 test  = "Insertion/@RevisionLevel='proposed'">
      <i>
     <font color="FUCHSIA">
     <xsl:text>Note: </xsl:text>
     </font>
     </i>
     </xsl:when>
     <xsl:when                 test  = "Deletion/@RevisionLevel='approved'">
     <i>
     <xsl:text>Note: </xsl:text>
     </i>
    </xsl:when>
     <xsl:when                 test  = "Deletion/@RevisionLevel='proposed'">
     <strike>
     <i>
     <font color="FUCHSIA">
     <xsl:text>Note: </xsl:text>
     </font>
     </i>
     </strike>
     </xsl:when>
     <xsl:otherwise>
      <i>
      <xsl:text>Note: </xsl:text>
     </i>
     </xsl:otherwise>
     </xsl:choose>
     </xsl:otherwise>
     </xsl:choose>
      <i>
     <xsl:apply-templates/>
      </i>
     <xsl:choose>
     <xsl:when                 test  = "Insertion/@RevisionLevel='approved'">
     <i>
     <font color="RED">
      <xsl:text>]</xsl:text>
      </font>
     </i>
     </xsl:when>
      <xsl:when                 test  = "Insertion/@RevisionLevel='proposed'">
      <i>
     <font color="FUCHSIA">
      <xsl:text>]</xsl:text>
     </font>
     </i>
     </xsl:when>
     <xsl:when                 test  = "Deletion/@RevisionLevel='approved'">
     <i>
     <xsl:text>] </xsl:text>
     </i>
     </xsl:when>
     <xsl:when                 test  = "Deletion/@RevisionLevel='proposed'">
     <strike>
     <i>
     <font color="FUCHSIA">
     <xsl:text>]</xsl:text>
     </font>
     </i>
     </strike>
     </xsl:when>
     <xsl:otherwise>
     <i>
     <xsl:text>]</xsl:text>
     </i>
     </xsl:otherwise>
     </xsl:choose>
     </xsl:template> 

  <!-- =====================================================================
                         Display a note        
     ===================================================================== -->
    <xsl:template              match = "Note" mode="B">
    <xsl:if                    test  = "not(.='')">
    <xsl:choose>
    <xsl:when                 test  =  "Insertion/@RevisionLevel='approved'">
     <b>
     <u>
     <i>
     <xsl:text> [</xsl:text>
     </i>
     </u>
     </b>
     </xsl:when>
     <xsl:when                 test  = "Insertion/@RevisionLevel='proposed'">
     <b>
     <i>
     <xsl:text>[</xsl:text>
     </i>
     </b>
     </xsl:when>
     <xsl:when                 test  = "Deletion/@RevisionLevel='proposed'">
     <strike>
     <xsl:text> [</xsl:text>
     </strike>
     </xsl:when>
   <xsl:otherwise>
     <xsl:if            test  = "not(Deletion/@RevisionLevel='approved')">
     <i>
     <xsl:text> [</xsl:text>
     </i>
     </xsl:if>
      </xsl:otherwise>
     </xsl:choose>
     <xsl:choose>
     <xsl:when                 test = "//SummaryLanguage ='Spanish'"> 
     <xsl:choose>
     <xsl:when                 test  = "Insertion/@RevisionLevel='approved'">
     <b>
     <u>
     <i>
     <xsl:text>Nota: </xsl:text>
     </i>
     </u>
     </b>
     </xsl:when>
     <xsl:when                 test  = "Insertion/@RevisionLevel='proposed'">
     <b>
     <i>
     <xsl:text>Nota: </xsl:text>
     </i>
     </b>
     </xsl:when>
     <xsl:when                 test  = "Deletion/@RevisionLevel='proposed'">
     <strike>
      <i>
     <xsl:text>Nota: </xsl:text>
     </i>
     </strike>
     </xsl:when>
     <xsl:otherwise>
      <xsl:if            test  = "not(Deletion/@RevisionLevel='approved')">
      <i>
     <xsl:text>Nota: </xsl:text>
     </i>
     </xsl:if>
     </xsl:otherwise>
     </xsl:choose>
     </xsl:when>
     <xsl:otherwise>
     <xsl:choose>
     <xsl:when                 test  = "Insertion/@RevisionLevel='approved'">
     <b>
     <u>
     <i>
     <xsl:text>Note: </xsl:text>
     </i>
     </u>
     </b>
     </xsl:when>
     <xsl:when                 test  = "Insertion/@RevisionLevel='proposed'">
     <b>
     <i>
     <xsl:text>Note: </xsl:text>
     </i>
     </b>
     </xsl:when>
     <xsl:when                 test  = "Deletion/@RevisionLevel='proposed'">
     <strike>
     <i>
     <xsl:text>Note: </xsl:text>
     </i>
     </strike>
     </xsl:when>
     <xsl:otherwise>
      <xsl:if            test  = "not(Deletion/@RevisionLevel='approved')">
      <i>
     <xsl:text>Note: </xsl:text>
     </i>
     </xsl:if>
     </xsl:otherwise>
     </xsl:choose>
     </xsl:otherwise>
     </xsl:choose>
     <i>
     <xsl:apply-templates/>
     </i>
     <xsl:choose>
     <xsl:when                 test  =  "Insertion/@RevisionLevel='approved'">
     <b>
     <u>
     <i>
     <xsl:text>] </xsl:text>
     </i>
     </u>
     </b>
     </xsl:when>
     <xsl:when                 test  = "Insertion/@RevisionLevel='proposed'">
     <b>
     <i>
     <xsl:text>]</xsl:text>
     </i>
     </b>
     </xsl:when>
     <xsl:when                 test  = "Deletion/@RevisionLevel='proposed'">
     <strike>
     <i>
     <xsl:text>]</xsl:text>
     </i>
     </strike>
     </xsl:when>
    <xsl:otherwise>
     <xsl:if            test  = "not(Deletion/@RevisionLevel='approved')">
     
      <i>
     <xsl:text>]</xsl:text>
     </i>
      </xsl:if>
     </xsl:otherwise>
     </xsl:choose>
     </xsl:if>
     </xsl:template> 




<!-- ======================================================================
        Template handling ListTitle
     ====================================================================== -->
    <xsl:template              match = "ListTitle">    
     <br/>
     <b><i>
     <xsl:apply-templates /> 
     </i></b>      
    </xsl:template>

<!-- =====================================================================
        Template handling ListItem in ItemizedList
     ===================================================================== -->  
    <xsl:template               name = "ItemizedListItem">
          
     <li> 
     <xsl:attribute             name = "class">
      <xsl:choose>
       <xsl:when                test = "../@Style = 'bullet'">        
       <xsl:text>disc</xsl:text>   
       </xsl:when>
       <xsl:when                test = "../@Style = 'dash'">
        <xsl:text>square</xsl:text>      
       </xsl:when>
       <xsl:when                test = "../@Style = 'simple'">
        <xsl:text>lnone</xsl:text>     
       </xsl:when> 
      </xsl:choose> 
     </xsl:attribute>
     <xsl:apply-templates />
     </li>
     </xsl:template>

<!-- =====================================================================
         Display TOC Summary Title with Deletion and Insertion
     ===================================================================== -->
    <xsl:template              match = "SummaryTitle"
                                mode = "TOC">
     <h2>
     <xsl:apply-templates />
     </h2>
    </xsl:template> 

<!-- =====================================================================
           Display summary titles in TOC.
     ===================================================================== -->
    <xsl:template              match = "Title" 
                               mode = "TOC">
    <xsl:apply-templates/>
    </xsl:template>

<!-- =====================================================================
           Display SummarySection in TOC.
     ===================================================================== -->
    <xsl:template               name = "TocSummarySection">
     <xsl:param                 name = "level"/> 

     <xsl:if                    test = "Title"> 
      <li>
      <xsl:apply-templates    select = "Title"
                                mode = "TOC"/>
     </li>
     </xsl:if>                   
   
     <xsl:if                    test = "SummarySection and
                                        $level &lt; 3">
      <ul Class="lnone">
      <xsl:for-each           select = "SummarySection">
      <xsl:if                 test   =  "not(Title/Deletion)">
      <xsl:call-template       name = "TocSummarySection">
        <xsl:with-param         name = "level"
                              select = "$level + 1"/>
      </xsl:call-template>
       </xsl:if>
      </xsl:for-each>
      </ul>
     </xsl:if>

    </xsl:template>

<!-- =====================================================================
        Display a summary section title depending on how many 
        SummarySection in its ancestors. We may have to use
        a mode here to avoid unintended usage in documents that
        are not summaries, but with Title.
     ===================================================================== -->
    <xsl:template              match = "Title">
    <xsl:if                    test  ="not(../../SummaryMetaData/
                                       SummaryAudience='Patients')">
    <xsl:variable              name = "ancestors"
                              select = "ancestor::SummarySection"/>
     <xsl:variable              name = "heading">
      <xsl:choose>
       <xsl:when                test = "count($ancestors) &lt; 4">
        <xsl:value-of         select = "count($ancestors)+1"/>
       </xsl:when>
       <xsl:otherwise>
        <xsl:value-of         select = "4"/>
       </xsl:otherwise>
      </xsl:choose>
     </xsl:variable>
    
     <xsl:text disable-output-escaping="yes">&lt;h</xsl:text>
     <xsl:value-of            select = "$heading"/>
     <xsl:text disable-output-escaping="yes">&gt;</xsl:text>    
     <xsl:apply-templates/>
     <xsl:text disable-output-escaping="yes">&lt;/h</xsl:text>
     <xsl:value-of            select = "$heading"/> 
     <xsl:text disable-output-escaping="yes">&gt;</xsl:text>  
     </xsl:if> 
     </xsl:template>

   <!-- ===============================================================
              Display Paragraphs in a ListItem - not approved yet
        ============================================================== -->

       <xsl:template              match = "ListItem/Para">
        <br />
        <br />
       <xsl:apply-templates/>
       <nobr />
       </xsl:template> 

     

<!-- =====================================================================
       Display Paragraphs 
     ===================================================================== -->
     <xsl:template              match = "Para">
     <p>
    <xsl:apply-templates/>
     </p>
     </xsl:template>

<!-- =====================================================================
      Display tables in old format
     ===================================================================== -->
    <xsl:template              match = "TT">
     <pre>
     <xsl:apply-templates/>
     </pre>
    </xsl:template>

<!-- =====================================================================
       Create a link to another document or website 
     ===================================================================== -->
    <xsl:template              match = "ExternalRef">
     <xsl:variable              name = "nlink" 
                              select = "@cdr:xref"/>
     <a href="{$nlink}">
     <xsl:apply-templates/>
     </a>
    </xsl:template>

<!-- =====================================================================
       Display references 
     ===================================================================== -->
    <xsl:template              match = "ReferenceList">
     <xsl:if                    test = "Reference">
      <xsl:choose>
       <xsl:when                test = "//SummaryLanguage='Spanish'">        
        <h3>Referencias:</h3>
       </xsl:when>
       <xsl:otherwise>
        <h3>References:</h3>        
       </xsl:otherwise>     
      </xsl:choose>
      
      <ol>
      <xsl:for-each           select = "Reference">
       <p><li>
       <xsl:apply-templates select="."/>
       </li></p>
      </xsl:for-each>
      </ol>
     </xsl:if>
    </xsl:template>

     <!-- ================================================================
                           Display Comments -Redline/Strikeout       
          ============================================================= -->

 
                                                                                             <xsl:template          match= "Comment" mode="RS">
              <b>
              <i>
              <font color="FUCHSIA">
              <xsl:text>[Comment: </xsl:text>
              <xsl:apply-templates/>
              <xsl:text>]</xsl:text>
              </font>
              </i>
              </b>
              </xsl:template>


      

     <!-- ================================================================
                       Display Comments -Bold/UnderLine
       =============================================================== -->


              <xsl:template          match="Comment" mode="BU">
                <i>
                <b>
                <xsl:text>[Comment: </xsl:text>
                <xsl:apply-templates/>
                <xsl:text>]</xsl:text>
                </b>
                </i>
                </xsl:template>
                             
       
              

  
                                    

</xsl:transform>]]>
</CdrDocXml>
</CdrDoc>