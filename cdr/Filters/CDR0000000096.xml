<CdrDoc Type='Filter' Id='CDR0000000096'>
<CdrDocCtl>
<DocValStatus readonly="yes">U</DocValStatus>
<DocActiveStatus readonly="yes">A</DocActiveStatus>
<DocTitle readonly="yes">Person QC Report Filter</DocTitle>
<ReadyForReview readonly="yes">N</ReadyForReview>
</CdrDocCtl>
<CdrDocXml><![CDATA[<?xml version="1.0"?>

<!-- ================================================================
        Filter to create a Person Content QC Report 
     ================================================================ -->

  <xsl:transform xmlns:xsl="http://www.w3.org/1999/XSL/Transform"
                 version="1.0"
                 xmlns:cdr="cips.nci.nih.gov/cdr">
   <xsl:output method="html"/>
     <xsl:template match="/">
     <!--Filter written by C.Burg - 4/26/2002 -->
     <!-- <!DOCTYPE HTML PUBLIC '-//IETF//DTD HTML//EN' /> -->
    <HTML>
    <HEAD>
      <xsl:variable name="cdrmydoc" select="document('cdrx:/*/CdrCtl')"/>

    <TITLE><xsl:value-of select="document('cdrutil:/docid')"/>&#xa0;&#xa0;<xsl:value-of select="substring-before($cdrmydoc/CdrDocCtl/DocTitle,';')"/> </TITLE>
     
       <!--
     <LINK REL='stylesheet' 
           HREF='/stylesheets/protocol2.css' 
           TYPE='text/css' /> -->
    </HEAD>
  <BASEFONT FACE='Arial, Helvetica, sans-serif' />
    <xsl:apply-templates select="Person"/>
    
    </HTML>
    </xsl:template>
  <!-- Generate the HTML for the Person QC Report-->

  <xsl:template match="Person">
    <BODY>

 <!-- ==================================================================
              Display Report heading and subheading 
      ================================================================== -->

  <!-- Display report title -->
 <b><font size='4'><center>
  <xsl:text>Person QC Report</xsl:text></center></font>
 </b>
 <b><font size='3'><center>
 <xsl:value-of        select="document('cdrutil:/date/%25B %25#d, %25Y %25#I:%25M% 25p')"/></center>
 </font></b><br /><br />

<!-- ====================================================================
                 Display Name Header, and PersonNameInformation
     ==================================================================== -->
 
 
 <b><xsl:value-of select="document('cdrutil:/docid')"/></b>
 <br />
 <b>
 <font size='4'><xsl:text>Name</xsl:text>
    </font>
</b><br /><br />
 <xsl:if                     test  = "PersonNameInformation/Prefix">
 <xsl:apply-templates        select="PersonNameInformation/Prefix"/>
 <xsl:text>&#xa0;</xsl:text>
 </xsl:if>
 <xsl:apply-templates        select="PersonNameInformation/GivenName"/>
 <xsl:text>&#xa0;</xsl:text>
 <xsl:apply-templates        select="PersonNameInformation/MiddleInitial"/>
 <xsl:text>&#xa0;</xsl:text>
 
 
 


<!--check for Professional suffix and display -->
   <xsl:choose>
   <xsl:when               test="PersonNameInformation/ProfessionalSuffix">
    <xsl:apply-templates   select="PersonNameInformation/SurName"/>,
   <xsl:apply-templates    select="PersonNameInformation/GenerationSuffix"/>
   <xsl:text>&#xa0;</xsl:text>
    <xsl:for-each              select="PersonNameInformation/
                                       ProfessionalSuffix |
                                       PersonNameInformation/
                                       CustomProfessionalSuffix">
<xsl:value-of              select="."/>
<xsl:if                    test="position() !=last()">,&#xa0;</xsl:if>
</xsl:for-each>
  <br /><br />
   </xsl:when>
   <xsl:otherwise>
   <!-- Display surname if no Suffix is present -->
    <xsl:apply-templates   select="PersonNameInformation/SurName"/>
         <br /><br />
    </xsl:otherwise>
    </xsl:choose>
 <b><font size='4'>Comment</font></b><br />
 <xsl:apply-templates      select="PersonNameInformation/Comment"/>
  <br /><br />
<!-- ============================================================
                  Display Professional information 
      ============================================================ -->

   <b><font size='4'>
  <xsl:text>Professional Information</xsl:text>
   </font>
   </b>
   <br /><br />
 
<xsl:for-each             select="ProfessionalInformation/PhysicianDetails/
                                  PhysicianSpecialtyInformation">
 <table cellpadding='0' width='90%'>
  <tr>
  <th align='left' width='40%'>
  <b>
 <xsl:text>PDQ Board</xsl:text>
  </b>
  </th>
  <xsl:if                 test  ="../../PDQBoardMembershipDetails/
                                   PDQEditorialBoard">
  <td width='60%'>
 <xsl:value-of            select ="../../PDQBoardMembershipDetails/
                                   PDQEditorialBoard/Organization/
                                   OrganizationName"/>
  </td>
  
 </xsl:if>
  <xsl:if                 test  ="../../PDQBoardMembershipDetails/
                                   PDQAdvisoryBoard">
  <td width='60%'>
 <xsl:value-of            select ="../../PDQBoardMembershipDetails/
                                   PDQAdvisoryBoard/Organization/
                                   OrganizationName"/>
  </td>
  
 </xsl:if>
  <xsl:if                 test  ="../../PDQBoardMembershipDetails/
                                   PDQVoluntaryProtocolReviewBoard">
  <td width='60%'>
  <xsl:value-of            select ="../../PDQBoardMembershipDetails/
                                   PDQVoluntaryProtocolReviewBoard/
                                   Organization/
                                   OrganizationName"/>
  </td>
  </xsl:if>
  </tr>
  <tr>
  <td>
  <xsl:text>&#xa0;</xsl:text>
  </td>
  </tr>
<xsl:for-each             select="BoardCertifiedSpecialty">
 <tr>
 <th align='left' width='40%'>
  <b>
 <xsl:text>Specialty</xsl:text>
  </b>
  </th>
  <td with='60%'>
  <xsl:value-of             select="BoardCertifiedSpecialtyName"/>
  </td>
  </tr>
  <tr>
  <th align='left' width='40%'>
  <b>
 <xsl:text>Board Certification</xsl:text>
  </b>
  </th>
  <td width='60%'>
  <xsl:value-of             select="Certified"/>
  </td>
  </tr>
  
  <tr>
  <th align='left' width='40%'>
  <b>
 <xsl:text>Verification</xsl:text>
  </b>
  </th>
  <td width='60%'> 
  <xsl:value-of             select="Verified"/>
  </td> 
  </tr>
  <tr>
  <td>
  <xsl:text>&#xa0;</xsl:text>
  </td>
  </tr>
  </xsl:for-each>
  
   <tr>
   <td align='left' width='40%'>
   <b>
 <xsl:text>Other Specialty</xsl:text>
  </b>
  </td>
  </tr>
  <xsl:for-each             select="OtherSpecialty">
   <tr>
   <td width='60%'>
  <xsl:value-of            select="."/>
  </td>
  </tr>
 </xsl:for-each>
 </table>
 </xsl:for-each>

 
  

<!-- ===================================================================
                 Display Membership Information
     ================================================================== -->
 <br />
 <b>
 <font size='3'>
 <xsl:text>Membership Information</xsl:text>
 </font>
 </b>
 <br /><br />
 <b><font size='3'>Cooperative Group(s)</font></b>
 
 <xsl:for-each               select="ProfessionalInformation/PhysicianDetails/
                                     PhysicianMembershipInformation/
                                     MemberOfCooperativeGroup/
                                     CooperativeGroup/
                                     Organization/
                                     OrganizationName">
                                     
 <table cellpadding='0' width='90%'>
 <tr>
 <th align='left'>
  <xsl:text>&#xa0;</xsl:text>
  </th>
                                       
 <xsl:if                     test="not(../../../../../@GroupChair)">
 <td>
<xsl:value-of               select="."/>
 </td>
</xsl:if>
<xsl:if                     test="../../../../../@GroupChair">
<td>
<xsl:value-of               select="."/>
<xsl:text>&#xa0;&#xa0;(Group Chair)</xsl:text>
</td>
</xsl:if>
</tr>
 </table>
</xsl:for-each> 

 <br />
  
 <b>
 <font size='3'>Medical Societies
 </font>
 </b>
  <table cellpadding='0' width='90%'>
  <xsl:for-each          select="ProfessionalInformation/PhysicianDetails/
                                  PhysicianMembershipInformation/
                                  MemberOfMedicalSociety">
  <tr>
  <th align='left'>
  <xsl:text>&#xa0;</xsl:text>
  </th>
  <td >
  <xsl:value-of           select="."/>
  </td>
  </tr> 
  </xsl:for-each>
  </table>
  <br />
  <b><font size='4'>Comment</font></b><br />
 <xsl:apply-templates      select="ProfessionalInformation/PhysicianDetails/
                                   Comment"/>
  <br /><br />


<!-- ======================================================================
                      Display Administrative Information 
      ===================================================================== -->

     <br /><br />
     <b>
     <font size='4'>Administrative Information</font>
     </b>
     <br /><br />
     
    <xsl:for-each         select="ProfessionalInformation/PhysicianDetails/
                                  AdministrativeInformation/Directory">
    <table cellpadding='0' width='90%'>
    <tr> 
    <th align='left' width='40%'>
    <b>
    <xsl:text>Directory</xsl:text>
    </b>
    </th>
    <td width='60%'>   
    <xsl:value-of           select="Include"/>
    </td>
    </tr>

  <tr>
  <th align='left' width='40%'>
  <b>
 <xsl:text>Entered By</xsl:text>
  </b>
  </th>
  <td width='60%'>
  <xsl:value-of          select="EnteredBy"/>
  </td>
  </tr>
   
   <tr> 
  <th align='left' width='40%'>
  <b>
 <xsl:text>Date</xsl:text>
  </b>
  </th>
  <td width='60%'>
  <xsl:value-of         select="Date"/>
  </td>
  </tr>
  </table>
  </xsl:for-each>
  
  
  <b>
 <xsl:text>Comment</xsl:text>
  </b>
  <br />
  <xsl:value-of           select="ProfessionalInformation/PhysicianDetails/
                                  AdministrativeInformation/Directory/
                                  Comment"/>
 
   <br />
   <br />
   <table cellpadding='0' width='90%'>
   <xsl:for-each           select="Status">
  <tr>
  <th align='left' width='40%'>
  <b>
 <xsl:text>Status</xsl:text>
  </b>
  </th>
  <td width='60%'>
  <xsl:value-of           select="CurrentStatus"/>
  </td>
  </tr>
   <tr>
  <th align='left' width='40%'>
  <b>
 <xsl:text>Entered By</xsl:text>
  </b>
  </th>
  <td width='60%'>
  <xsl:value-of           select="EnteredBy"/>
  </td>
  </tr>
   <tr>
  <th align='left' width='40%'>
  <b>
 <xsl:text>Entry Date</xsl:text>
  </b>
  </th>
   <td width='60%'>
  <xsl:value-of           select="EntryDate"/>
  </td>
  </tr>
 </xsl:for-each>
  </table>
  <b>
  <xsl:text>Comment</xsl:text> 
  </b>
  <br />
  <xsl:for-each             select="Status/Comment">
   <xsl:value-of            select="."/>
   </xsl:for-each>
    
  

   <table cellpadding='0' width='90%'>
   <xsl:for-each        select="ProfessionalInformation/PhysicianDetails/
                               AdministrativeInformation">
    <tr>
    <th align='left' width='40%'>
    <b>
    <xsl:text>Preferred Contact Mode</xsl:text>
    </b>
    </th>
   
   <td width='60%'>
    <xsl:value-of          select="PreferredContactMode"/>
  </td>
  </tr>
  </xsl:for-each>
  </table>
   <br /><br />

<!-- ======================================================================
                 Display Location Information for Home Office
     ===================================================================== -->

<b><font size='4'>Location Information</font></b><br /><br />

   <b><font size='3'>Home</font></b><br />
    <xsl:if test="PersonLocations/Home">
    <xsl:if test="PersonLocations/CIPSContact=PersonLocations/Home/@cdr:id">
    <b><font size="3">CIPS Contact</font></b><br />
    </xsl:if>
    <xsl:for-each         select="PersonLocations/Home/PostalAddress">
    <xsl:for-each         select="Street">
    <xsl:value-of         select="."/><br />
    </xsl:for-each>
    <xsl:if               test="Country/PostalCodePosition='before City'">
    <xsl:value-of         select="PostalCode_ZIP"/>&#xa0;
<xsl:if test="CitySuffix">
<xsl:value-of             select="concat(City,' ',CitySuffix)"/>
</xsl:if> 
<xsl:if                  test="not(CitySuffix)">   
<xsl:value-of            select="City"/>,
</xsl:if>
<xsl:text>&#xa0;</xsl:text>
<xsl:value-of           select="PoliticalSubUnit_State/
                                PoliticalSubUnitShortName"/><br />
<xsl:value-of           select="Country/CountryFullName"/><br />
</xsl:if>
<xsl:if                 test="Country/PostalCodePosition='after City'">
<xsl:if                 test="CitySuffix">
<xsl:value-of           select="concat(City,' ',CitySuffix )"/>
</xsl:if> 
<xsl:if                 test="not(CitySuffix)">   
<xsl:value-of           select="City"/>,
</xsl:if>
<xsl:value-of           select="PostalCode_ZIP"/>&#xa0;
<xsl:value-of           select="PoliticalSubUnitShortName"/><br />
<xsl:value-of           select="Country/CountryFullName"/><br />
</xsl:if>
 
<xsl:if                 test="Country/
                              PostalCodePosition=
                             'after PoliticalSubUnit_State'">
<xsl:if                 test="CitySuffix">
<xsl:value-of           select="concat(City,' ',CitySuffix, ', ')"/>
</xsl:if> 
<xsl:if                 test="not(CitySuffix)">   
<xsl:value-of           select="City"/>,
</xsl:if>
<xsl:value-of           select="PoliticalSubUnit_State
                              /PoliticalSubUnitShortName"/>&#xa0;
<xsl:value-of           select="PostalCode_ZIP"/><br />
<xsl:value-of           select="Country/CountryFullName"/><br />
</xsl:if>
<xsl:if                 test="Country/Country/
                              PostalCodePosition='after Country'">
<xsl:if                 test="CitySuffix">
<xsl:value-of           select="concat(City,' ',CitySuffix)"/>
</xsl:if> 
<xsl:if                 test="not(CitySuffix)">   
<xsl:value-of           select="City"/>,&#xa0;
</xsl:if>
<xsl:value-of           select="PoliticalSubUnit_State/
                                PoliticalSubUnitShortName"/>&#xa0;
<xsl:value-of           select="Country/CountryFullName"/><br />
<xsl:value-of           select="PostalCode_ZIP"/><br />
</xsl:if>
 <xsl:text>Phone:&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;
                 &#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;</xsl:text>
  <xsl:value-of         select="../Phone"/>&#xa0;
<xsl:if                 test="../Phone/@Public">
<xsl:text>(Public=</xsl:text>
<xsl:value-of           select="../Phone/@Public"/>
<xsl:text>)</xsl:text>
</xsl:if>
<br />

  <xsl:value-of         select="concat('TollFreePhone:&#xa0;&#xa0;&#xa0;',../TollFreePhone)"/><br />

  <xsl:value-of         select="concat(      
                                   'Fax:&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;
                                    &#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;
                                    &#xa0;&#xa0;&#xa0;&#xa0;&#xa0;
                                    &#xa0;&#xa0;
                                    ',../Fax)"/>
   <br />
<xsl:text>Email:&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;
                &#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;</xsl:text>
 
 <u><xsl:value-of     select="../Email"/></u>&#xa0;
<xsl:if               test="../Email/@Public">
<xsl:text>(Public=</xsl:text>
<xsl:value-of         select="../Email/@Public"/>
<xsl:text>)</xsl:text>
</xsl:if>
<br />

 <xsl:text>Website:&#xa0;&#xa0;&#xa0;&#xa0;</xsl:text>
 <u><xsl:value-of   select="../WebSite/@cdr:xref"/></u><br />
 <br />
 </xsl:for-each>
 </xsl:if>
 <br />
<!-- =====================================================================
        Display Person Location Information for Private Practice Location
     ===================================================================== -->

    <b><font size='3'>Private Practice</font></b><br /><br />

   <xsl:if              test="PersonLocations/PrivatePractice/
                              PrivatePracticeLocation">
      <xsl:for-each     select="PersonLocations/PrivatePractice/
                                PrivatePracticeLocation/PostalAddress">
      <xsl:variable     name="contact" select="../../../CIPSContact"/>
      <xsl:if test="$contact=../@cdr:id">
      <b><font size="3">CIPS Contact</font></b><br />
      </xsl:if>
      
    <xsl:if             test="../../PreviousLocation">
    <b><xsl:text>(Previous Location)</xsl:text></b><br />
    </xsl:if>
     <xsl:for-each                 select="Street">
     <xsl:value-of                 select="."/><br />
     </xsl:for-each>
    <xsl:if                        test="Country/
                                         PostalCodePosition='before City'">
<xsl:value-of                      select="PostalCode_ZIP"/>&#xa0;
<xsl:if                            test="CitySuffix">
<xsl:value-of                      select="concat(City,' ',CitySuffix)"/>
</xsl:if> 
<xsl:if                            test="not(CitySuffix)">   
<xsl:value-of                      select="City"/>,
</xsl:if>
<xsl:value-of                      select="PoliticalSubUnit_State/
                                           PoliticalSubUnitShortName"/><br />
<xsl:value-of                      select="Country/CountryFullName"/><br />
</xsl:if>
<xsl:if                            test="PostalCodePosition='after City'">
<xsl:if                            test="CitySuffix">
<xsl:value-of                      select="concat(City,' ',CitySuffix)"/>
</xsl:if> 
<xsl:if                            test="not(CitySuffix)">   
<xsl:value-of                      select="City"/>,
</xsl:if>
<xsl:value-of                      select="PostalCode_ZIP"/>&#xa0;
<xsl:value-of                      select="PoiticalSubUnit_State/
                                          PoliticalSubUnitShortName"/><br />
<xsl:value-of                      select="Country/CountryFullName"/><br />
</xsl:if>
 
<xsl:if                           test="Country/
                                        PostalCodePosition=
                                        'after PoliticalSubUnit_State'">
                                       
<xsl:if                           test="CitySuffix">
<xsl:value-of                     select="concat(City,' ',CitySuffix)"/>
</xsl:if> 
<xsl:if                          test="not(CitySuffix)">   
<xsl:value-of                    select="City"/>,
</xsl:if>
<xsl:value-of                    select="PoliticalSubUnit_State/
                                         PoliticalSubUnitShortName"/>&#xa0;
<xsl:value-of                    select="PostalCode_ZIP"/><br />
<xsl:value-of                    select="Country/CountryFullName"/><br />
</xsl:if>
<xsl:if                          test="PostalCodePosition='after Country'">
<xsl:if                          test="CitySuffix">
<xsl:value-of                    select="concat(City,' ',CitySuffix)"/>
</xsl:if> 
<xsl:if                          test="not(CitySuffix)">   
<xsl:value-of                    select="City"/>,
</xsl:if>
<xsl:value-of                    select="PoliticalSubUnit_State/
                                         PoliticalSubUnitShortName"/>&#xa0;
<xsl:value-of                    select="Country/
                                         CountryFullName"/><br />
<xsl:value-of                    select="PostalCode_ZIP"/><br />
</xsl:if>

 <xsl:value-of                   select="concat('Phone:&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;
        &#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;',../Phone)"/>&#xa0;
<xsl:if                          test="../Phone/@Public">
<xsl:text>(Public=</xsl:text>
<xsl:value-of                    select="../Phone/@Public"/>
<xsl:text>)</xsl:text>
</xsl:if>
<br />

 <xsl:value-of                  select="concat('TollFreePhone:&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;',../../TollFreePhone)"/><br />

  <xsl:value-of                 select="concat('Fax:&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;',../Fax)"/><br />

<xsl:text>Email:&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;
                &#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;
</xsl:text>
 <u><xsl:value-of              select="../Email"/></u>&#xa0;
 <xsl:if                       test="../../Email/@Public">
<xsl:text>(Public=</xsl:text>
<xsl:value-of                  select="../Email/@Public"/>
<xsl:text>)</xsl:text>
</xsl:if>
<br />

 <xsl:text>Website:&#xa0;&#xa0;&#xa0;&#xa0;</xsl:text>
 <u><xsl:value-of             select="../WebSite/@cdr:xref"/></u><br />
 <br />
 </xsl:for-each>
 </xsl:if>

<!-- ====================================================================
      Display Other Practice Locations Information
     ================================================================== -->
      <b><font size='3'>Other Practice Locations</font></b><br /><br />
 
     <xsl:for-each            select="PersonLocations/OtherPracticeLocation">
     <xsl:variable            name='id' select="@cdr:id"/>
                           
     <xsl:if                  test="../CIPSContact= @cdr:id">
    <b>
    <font size="3">CIPS Contact</font>
   </b><br />
   </xsl:if>
       
    <xsl:if                  test="@PreviousLocation">
    <b><xsl:text>(Previous Location)</xsl:text>
    </b><br />
    </xsl:if>
    
    <xsl:if                  test="PersonTitle">
    <xsl:value-of            select="PersonTitle"/><br />
    </xsl:if>
    
    <xsl:if                 test="PersonRole">
    <xsl:value-of           select="PersonRole"/><br />
    </xsl:if>

   
    

    <xsl:for-each             select="OrganizationLocation/Organization/
                                      OrganizationName">
    <i>
    <xsl:value-of             select="."/>
    </i>
    <br />
    <xsl:text>&#xa0;</xsl:text>                        
    </xsl:for-each>
  
   
   <xsl:if                   test="not(SpecificPostalAddress)">
   <xsl:for-each             select="OrganizationLocation/Organization/
                                     OrganizationLocations/
                                     OrganizationLocation/Location">
  <xsl:variable             name="Loid" select="@cdr:id"/>
  <xsl:variable      name="OID" select="substring-after(../../../@cdr:ref,'#')"/>
   
   <xsl:if                  test="$id = $Loid | $id = $OID"> 
   <xsl:if                   test="PostalAddress/@Public">
   <xsl:text>(Public=No)</xsl:text><br />
   </xsl:if>                   
   <xsl:for-each            select="PostalAddress/Street">  
    <i>
    <xsl:value-of          select="."/>
    </i>
    <br />
    </xsl:for-each>
    <xsl:if                test="PostalAddress/Country/
                                 PostalCodePosition='before City'">
    <i>
    <xsl:value-of         select="PostalAddress/
                                  PostalCode_ZIP"/>
   </i>
   <xsl:text>&#xa0;</xsl:text>
    <xsl:if               test="PostalAddress/CitySuffix">
     <i>
    <xsl:value-of         select="concat (PostalAddress/City,'
                                          ',PostalAddress/CitySuffix)"/>
     </i>
    </xsl:if> 
    <xsl:if              test="not(PostalAddress/CitySuffix)"> 
    <i>  
    <xsl:value-of        select="PostalAddress/City"/>
     </i>
     <xsl:text>,</xsl:text>
    </xsl:if>
     <i>
    <xsl:value-of        select="PostalAddress/PoliticalSubUnit_State/
                                 PoliticalSubUnitShortName"/>
    </i>
    <br />
     <i>
    <xsl:value-of        select="PostalAddress/Country/
                                 CountryFullName"/>
     </i>
     <br />
    </xsl:if>
    <xsl:if              test="PostalAddress/Country/
                               PostalCodePosition='after City'">
    <xsl:if              test="PostalAddress/CitySuffix">
    <i>
    <xsl:value-of        select="concat(PostalAddress/City,'
                                        ',PostalAddress/CitySuffix)"/>
    </i>
    </xsl:if> 
    <xsl:if              test="not(PostalAddress/CitySuffix)"> 
    <i>  
    <xsl:value-of        select="PostalAddress/City"/>
    </i>
    <xsl:text>,</xsl:text>
    </xsl:if>
    <i>
    <xsl:value-of        select="PostalAddress/PostalCode_ZIP"/>
    </i>
     <xsl:text>&#xa0;</xsl:text>
    <i>
    <xsl:value-of        select="PostalAddress/PoliticalSubUnit_State/
                                 PoliticalSubUnitShortName"/>
     </i>
    <br />
    <i>
    <xsl:value-of        select="PostalAddress/Country/
                                 CountryFullName"/>
    </i>
    <br />
    </xsl:if>
 
   <xsl:if               test="PostalAddress/Country/
                               PostalCodePosition=
                               'after PoliticalSubUnit_State'">
  <xsl:if                test="PostalAddress/CitySuffix">
  <i>
  <xsl:value-of          select="concat(PostalAddress/City,'
                                        ',PostalAddress/CitySuffix)"/>
   </i>
   </xsl:if> 
   <xsl:if              test="not(PostalAddress/CitySuffix)">   
   <i>
   <xsl:value-of        select="PostalAddress/City"/>
   </i>
   <xsl:text>,</xsl:text>
   </xsl:if>
    <i>
   <xsl:value-of        select="PostalAddress/PoliticalSubUnit_State/
                               PoliticalSubUnitShortName"/>
   </i>
   <xsl:text>&#xa0;</xsl:text>
    
    <i>
   <xsl:value-of        select="PostalAddress/PostalCode_ZIP"/>
   </i>
   <br />
   <i>
   <xsl:value-of        select="PostalAddress/Country/
                                CountryFullName"/>
   </i>
  <br /><br />
   </xsl:if>
   <xsl:if              test="PostalAddress/Country/
                              PostalCodePosition='after Country'">
   <xsl:if              test="PostalAddress/CitySuffix">
   <i>
   <xsl:value-of        select="concat(PostalAddress/City,'
                                       ',PostalAddress/CitySuffix)"/>
    </i>
   </xsl:if> 
   <xsl:if              test="not(PostalAddress/CitySuffix)">  
    <i> 
   <xsl:value-of        select="PostalAddress/City"/>
    </i>
    <xsl:text>,</xsl:text>
   </xsl:if>
   <i>
   <xsl:value-of        select="PostalAddress/PoliticalSubUnit_State/
                                PoliticalSubUnitShortName"/>
   </i>
   <xsl:text>&#xa0;</xsl:text>
    
   <i>
   <xsl:value-of         select="PostalAddress/Country/
                                 CountryFullName"/>
   </i>
   <br />
   <i>
   <xsl:value-of         select="PostalAddress/PostalCode_ZIP"/>
   </i>
   <br />
   </xsl:if>
 
 <!-- adding end of for loop-->
  </xsl:if> <!--added this now -->
  </xsl:for-each>
   </xsl:if>

  <xsl:if                test="SpecificPostalAddress">
   <xsl:for-each         select="SpecificPostalAddress">
   <xsl:if               test="@Public">
   <xsl:text>(Public=No)</xsl:text><br />
   </xsl:if> 
        
   <xsl:for-each        select="Street">                     
    <xsl:value-of       select="."/><br />
    </xsl:for-each>
    <xsl:if            test="Country/PostalCodePosition='before City'">
    <xsl:value-of      select="PostalCode_ZIP"/>&#xa0;
    <xsl:if            test="CitySuffix">
    <xsl:value-of      select="concat(City,' ',CitySuffix)"/>
    </xsl:if> 
    <xsl:if            test="not(CitySuffix)">   
    <xsl:value-of      select="City"/>,
    </xsl:if>
    <xsl:value-of     select="PoliticalSubUnit_State/
                      PoliticalSubUnitShortName"/><br />
    <xsl:value-of     select="Country/CountryFullName"/><br />
    </xsl:if>
    <xsl:if           test="Country/PostalCodePosition='after City'">
    <xsl:if           test="CitySuffix">
    <xsl:value-of     select="concat(City,' ',CitySuffix)"/>
    </xsl:if> 
    <xsl:if           test="not(CitySuffix)">   
    <xsl:value-of     select="City"/>,
    </xsl:if>
    <xsl:value-of     select="PostalCode_ZIP"/>&#xa0;
    <xsl:value-of     select="PoliticalSubUnit_State/
                              PoliticalSubUnitShortName"/><br />
    <xsl:value-of     select="Country/CountryFullName"/><br />
    </xsl:if>
 
   <xsl:if           test="Country/PostalCodePosition=
                          'after PoliticalSubUnit_State'">
   <xsl:if           test="CitySuffix">
   <xsl:value-of     select="concat(City,' ',CitySuffix)"/>
   </xsl:if> 
   <xsl:if           test="not(CitySuffix)">   
   <xsl:value-of     select="City"/>,
   </xsl:if>
   <xsl:value-of     select="PoliticalSubUnit_State/
                             PoliticalSubUnitShortName"/>&#xa0;
   <xsl:value-of     select="PostalCode_ZIP"/><br />
   <xsl:value-of     select="Country/CountryFullName"/><br />
   </xsl:if>
   <xsl:if           test="Country/PostalCodePosition='after Country'">
   <xsl:if           test="CitySuffix">
   <xsl:value-of     select="concat(City,' ',CitySuffix)"/>
   </xsl:if> 
   <xsl:if           test="not(CitySuffix)">   
   <xsl:value-of     select="City"/>,
   </xsl:if>
   <xsl:value-of     select="PoliticalSubUnit_State/
                             PoliticalSubUnitShortName"/>&#xa0;
   <xsl:value-of     select="Country/CountryFullName"/><br />
   <xsl:value-of     select="PostalCode_ZIP"/><br />
   </xsl:if>
 
 <!-- adding end of for loop-->
  </xsl:for-each>
   </xsl:if>
    
   <xsl:text>Phone:&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;
             &#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;
  </xsl:text> 
  <xsl:if           test="SpecificPhone">
  <xsl:value-of     select="SpecificPhone"/>
  <xsl:if           test="SpecificPhone/@Public">
  <xsl:text>(Public=</xsl:text>
  <xsl:value-of      select="SpecificPhone/@Public"/>
  <xsl:text>)</xsl:text>
  </xsl:if>
  </xsl:if>

<xsl:if                        test="not(SpecificPhone)">
<xsl:if                        test="OrganizationLocation/
                                     Organization/OrganizationLocations/
                                     OrganizationLocation/Location/Phone">
<i>
<xsl:value-of                  select="OrganizationLocation/
                                       Organization/OrganizationLocations/
                                       OrganizationLocation/Location/Phone"/>
 </i>
 
 <xsl:if                       test="OrganizationLocation/Organization/
                                     OrganizationLocations/
                                     OrganizationLocation/Location/Phone/
                                     @Public">
<xsl:text>(Public=</xsl:text>
<xsl:value-of                 select="OrganizationLocation/
                                      Organization/
                                      OrganizationLocations/
                                      OrganizationLocation/Location/Phone/
                                      @Public"/>
 <xsl:text>)</xsl:text>
</xsl:if>
</xsl:if>
</xsl:if>
 <br />
 <xsl:text>TollFreePhone:&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;</xsl:text>
<xsl:if                     test="SpecificTollFreePhone">
<xsl:value-of               select="SpecificTollFreePhone"/>
<br />
</xsl:if>
<xsl:if                     test="not(SpecificTollFreePhone)">
 <xsl:if                    test="OrganizationLocation/Organization/
                                  OrganizationLocations/
                                  OrganizationLocation/Location/TollFreePhone">
 <i>
 <xsl:value-of               select="OrganizationLocation/
                                     Organization/OrganizationLocations/
                                     OrganizationLocation/
                                     Location/TollFreePhone"/>
  </i>
 </xsl:if>
 </xsl:if>
  <br />

  <xsl:text>Fax:</xsl:text>
  <xsl:text> &#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;
                 &#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;
                 &#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;
 </xsl:text>
  
  <xsl:if               test="SpecificFax">
  <xsl:value-of         select="SpecificFax"/>
   <br />
  </xsl:if>
<xsl:if                  test="not(SpecificFax)">
 <xsl:if                 test="OrganizationLocation/Organization/
                               OrganizationLocations/
                               OrganizationLocation/Location/Fax">
  <i>
 <xsl:value-of           select="OrganizationLocation/Organization/
                                 OrganizationLocations/
                                 OrganizationLocation/Location/Fax"/>
 </i>
 </xsl:if>
 <br />
 </xsl:if>
 
 <xsl:text>Email:&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;
          &#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;
 </xsl:text>
 <xsl:if              test="SpecificEmail">
 <u><xsl:value-of     select="SpecificEmail"/></u>
<xsl:text>&#xa0;</xsl:text>
<xsl:if               test="SpecificEmail/@Public">
<xsl:text>(Public=</xsl:text>
<xsl:value-of         select="SpecificEmail/@Public"/>
<xsl:text>)</xsl:text>
</xsl:if>
</xsl:if>

<!-- <xsl:if              test="not(SpecificEmail)">
 <xsl:if              test="OrganizationLocation/Organization/
                            OrganizationLocations/
                            OrganizationLocation/Location/Email">
  
 <i>
 <xsl:value-of        select="OrganizationLocation/
                               Organization/
                               OrganizationLocations/
                               OrganizationLocation/Location/Email"/>
  </i>
  </xsl:if>
  </xsl:if>-->
   <br />
 
 

  <xsl:text>Website:&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;
             &#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;
  </xsl:text>
             <xsl:if              test="SpecificWebSite">
   <xsl:value-of                  select="SpecificWebSite/@cdr:xref"/>
                                  
    </xsl:if>
 
 <xsl:if                          test="not(SpecificWebSite)">
 <xsl:if                          test="OrganizationLocation/Organization/
                                        OrganizationLocations/
                                        OrganizationLocation/Location
                                       /WebSite/@cdr:xref">
 <i>
<xsl:value-of                  select="
                               OrganizationLocation/Organization/
                               OrganizationLocations/
                               OrganizationLocation/Location/WebSite/
                               @cdr:xref"/></i>
 
                              
  </xsl:if>
  </xsl:if>
   <br />

    <br />
<xsl:if                    test="ComplexAffiliation">
 <b><font size='3'>Complex Affiliation</font></b><br /><br />
 <xsl:for-each            select="ComplexAffiliation">
<xsl:for-each             select="Organization/Organization">
<b><xsl:text>Organization:&#xa0;</xsl:text></b>
<xsl:value-of             select="OrganizationName"/>
                                   <br />
<b><xsl:text>Role:&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;
&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;</xsl:text></b>
<xsl:value-of            select="../../RoleAtAffiliatedOrganization"/>
 <br /><br />
</xsl:for-each>
</xsl:for-each>
</xsl:if>
</xsl:for-each>
  <br /><br />



<!--- =================================================================
       Display links to other documents, Dated Actions, Date Last Modified
      ===================================================================== -->
<b><font size='4'>Links to Other Documents</font></b><br /><br />

<!--Variable names should be replaced with a Yes or a No depending on the    
    query results for the links -->

<b><font size='3'>Active,Approved,Temporarily Closed Protocols</font></b>
<xsl:text>&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;

</xsl:text>@@ACTIVE_APPR0VED_TEMPORARILY_CLOSED_PROTOCOLS@@<br />

<b><font size='3'>Closed,Completed Protocols</font></b> 
<xsl:text>&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;
&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;
&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;
&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;
</xsl:text>
@@CLOSED_COMPLETED_PROTOCOLS@@<br />

<b><font size='3'>Health Professional Summaries</font></b>
<xsl:text>&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;
&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;
&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;
&#xa0;</xsl:text>
@@HEALTH_PROFESSIONAL_SUMMARIES@@<br />

<b><font size='3'>Patient Summaries</font></b><br />
    @@PATIENT_SUMMARIES@@<br /><br />

<b><font size='4'>Dated Action(s)</font></b><br /><br />
<xsl:for-each               select="DatedAction">
<xsl:value-of               select="ActionDescription"/><br />
<xsl:value-of               select="ActionDate"/><br />
<br />
</xsl:for-each>
<br />
<b><font size='4'>Date Last Modified</font>
</b>
<br /><br />
<xsl:apply-templates        select="DateLastModified"/><br /><br />

  <!-- =====================================================================
             Display Record Information ( Date created, Modified, and User
     =====================================================================  -->
              <b><font size='4'>Record</font></b><br /><br />
              <table cellpadding='0' width='90%'>
              <xsl:for-each               select="CdrDocCtl">
              <tr>
              <th align='left' width='40%'>   
              <b>
              <font size='3'>Created By
              </font>
              </b>
              </th>
               <td width='60%'>
              <xsl:value-of               select="Create/User"/>
              </td>
              </tr>
              <tr>
              <th align='left' width='40%'>   
              <b>
              <font size='3'>Date
              </font>
              </b>
              </th>
              <td width='60%'>
              <xsl:value-of               select="substring-before 
                                                 (Create/Date,'T')"/>
             </td>
             </tr>
              <tr>
              <th align='left' width='40%'>   
               <b>
              <font size='3'>Updated By
              </font>
              </b>
              </th>
              <td width='60%'>
              <xsl:value-of               select="Modify/User"/><br />
              </td>
              </tr>
               <tr>
              <th align='left' width='40%'>   
              <b>
              <font size='3'>Date
              </font>
              </b>
              </th>
              <td width='60%'>
              <xsl:value-of               select="substring-before
                                                  (Modify/Date,'T')"/>
              </td>
              </tr>
              </xsl:for-each>
              </table>
              <br /><br />



<!-- =================================================================
        Display most recent Mailer Information
     ================================================================= -->

<b><font size='4'>Most Recent Mailer</font></b><br /><br />

 <table cellpadding='0' width='90%'>
 <tr>
 <th align='left' width='40%'>   
  <b>
 <font size='3'>Date Sent
 </font>
 </b>
 </th>
 <td  width='60%'>
   @@MAILER_DATE_SENT@@
  </td>
  </tr>
  <tr>
  <th align='left' width='40%'>   
  <b>
  <font size='3'>Date Received
  </font>
  </b>
  </th>
 <td width='35%'> 
  @@MAILER_RESPONSE_RECEIVED@@
  </td>
  </tr>
  <tr>
 <th align='left' width='40%'>   
 <b>
 <font size='3'>Type of Change
 </font>
 </b>
 </th>
 <td width='60%'>
   @@MAILER_TYPE_OF_CHANGE@@
  </td>
  </tr>
  </table>
   <br />
   <br />
   </BODY>
   </xsl:template>
  </xsl:transform>
]]>
</CdrDocXml>
</CdrDoc>