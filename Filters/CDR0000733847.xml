<?xml version='1.0' encoding='utf-8'?>
<!-- $Id$ -->
<!-- Filter title: Add PermaTargId -->
<xsl:transform  version = '1.0'
                xmlns:xsl = 'http://www.w3.org/1999/XSL/Transform'
                xmlns:cdr = 'cips.nci.nih.gov/cdr'>
 <xsl:output    method = 'xml'
                encoding = 'utf-8'/>

 <xsl:param     name = "addTargValue"/>


<!-- 
==================================================================
 Replace PermaTargId='0' attribute with passed value.
 Only do the first one of them.  
 Call again passing another value if there are more.
==================================================================
-->
 <xsl:template        match = "*[@PermaTargId = 0
                               and not((preceding::* | 
                               ancestor::*)[@PermaTargId = 0])]/@PermaTargId">
  <xsl:attribute name = "{name()}">
   <xsl:value-of select = "$addTargValue"/>
  </xsl:attribute>

 </xsl:template>


 <!-- 
 ==================================================================
  Copy almost everything straight through.
 ==================================================================
 -->
<xsl:template match="@*|node()">
  <xsl:copy>
    <xsl:apply-templates select="@*|node()"/>
  </xsl:copy>
</xsl:template>

</xsl:transform>
