Instructions for building the CDR server using Visual Studio 2010
=================================================================

What you'll need:
-----------------

 * Visual Studio 2010
 * bison.simple (in the /etc directory, from version control)
 * ./bison.exe (also in version control)
 * Subversion client (available from cygwin)
 * A connection to the internet
 * An account on the CBIIT subversion server

Build steps (substitute local drive letter for X: below):
---------------------------------------------------------

 1. Install expat
  - go to http://sourceforge.net/projects/expat
  - download the latest expat_win32bin package (an .exe file)
  - run the executable package, installing to X:\usr\expat

 2. Build Sablotron
  - Go to X:\usr
  - svn export https://ncisvn.nci.nih.gov/svn/oce_cdr/trunk/ExternalPackages/Sablot
  - cd Sablot
  - nmake -f makefile.msvc > errs
  - examine errs file for problems

 3. Install xerces.
  - go to http://xml.apache.org/xerces-c/download.cgi
  - download xerces-c-x.x.x-x86-windows-vc-10.0.zip (where x.x.x is the
    latest release version of the package; e.g. 3.1.1)
  - unpack the zipfile
  - move the unpacked files to X:\usr\xerces

 4. Ensure that there is a path to each of the dlls. Add to the path:
  - X:\usr\expat\Bin
  - X:\usr\Sablot\bin
  - X:\usr\xerces\bin

 5. Export and build the server source code
  - svn export https://ncisvn.nci.nih.gov/svn/oce_cdr/trunk/Server
  - cd Server
  - nmake DRV=X:

In addition to the DLLs installed by the steps above, the following
two DLLs must be copied to the search path, if they are not already
installed (available from
http://www.microsoft.com/en-us/download/details.aspx?id=5555):

    msvcp100.dll
    msvcr100.dll

If you are testing the server on your own workstation, you will need
to set up an ODBC connection with the name 'cdr' and connection
parameters which connect with the CDR databases.  It is important
to make sure that you set up a 32-bit ODBC connection object.  The
easiest way to do that if you're running a 64-bit build of Windows
is to invoke the ODBC connection manager directly:

       %windir%\SysWOW64\odbcad32.exe

Note that the version of bison which is invoked by the Makefile must
be the version in D:\bin on the CDR server (version 1.24). Later versions
of bison introduce incompatibilities which need to be addressed in a
separate branch.

Additional requirements for running the CDR Server:

 * writeable X:/cdr/log
 * readable X:/etc/cdrdbpw
 * readable X:/etc/cdrapphosts.rc
 * readable X:/etc/cdrtier.rc (containing, e.g., "QA" or "DEV")
 * readable X:/etc/cdrenv.rc (containing "CBIIT")
 * readable X:/cdr/etc/hostname (use "localhost" for running on workstation)
 * X:/cdr/bin/CdrServer.exe (doesn't have to be real, just has to exist)
 * statable X:/cdr/bin/CdrService.exe (doesn't have to do anything, just exist)
